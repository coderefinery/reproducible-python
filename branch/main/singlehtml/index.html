<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reproducible research software development using Python documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_lesson.css" />
      <link rel="stylesheet" type="text/css" href="_static/term_role_formatting.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_rtd_theme_ext_color_contrast.css" />
      <link rel="stylesheet" type="text/css" href="_static/style.css" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css" />

  
    <link rel="shortcut icon" href="_static/coderefinery.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/minipres.js"></script>
        <script src="_static/tabs.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script data-domain="coderefinery.github.io" defer="defer" src="https://plausible.cs.aalto.fi/js/script.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Reproducible research software development using Python
          </a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Software environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-installation/conda">Conda environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-installation/virtual-environment">Virtual environment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Episodes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-example">Example project: Simulating the motion of planets</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-version-control">Introduction to version control with Git and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-documentation">Code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-collaboration">Collaborative version control and code review</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-testing">Automated testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-reusable">How to make the project more reusable</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-refactoring-concepts">Concepts in refactoring and modular code design</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-refactoring-demo">Demo: From a script towards a workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-software-licensing">Choosing a software license</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-publishing">How to publish your code</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-packaging">Creating a Python package and deploying it to PyPI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.github.io/reproducible-python/lesson.pdf">PDF version</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-credit">Credit</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/">All lessons</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/">CodeRefinery</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/reusing/">Reusing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Reproducible research software development using Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Reproducible research software development using Python  documentation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/coderefinery/reproducible-python/blob/main/content/index" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reproducible-research-software-development-using-python">
<h1>Reproducible research software development using Python<a class="headerlink" href="#reproducible-research-software-development-using-python" title="Link to this heading"></a></h1>
<section id="big-picture-goal">
<h2>Big-picture goal<a class="headerlink" href="#big-picture-goal" title="Link to this heading"></a></h2>
<p>This is a <strong>hands-on course on research software engineering</strong>. In this
workshop we assume that most workshop participants use Python in their work or
a leading a group which uses Python.  Therefore, some of the examples will use
Python as the example language.</p>
<p>We will work with an example project and go through all important steps of a typical
software project.  Once we have seen the building blocks, we will try to <strong>apply
them to own projects</strong>.</p>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"></a></h2>
<div class="admonition-preparation prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Preparation</p>
<ol class="arabic simple">
<li><p>Get a <strong>GitHub account</strong> following <a class="reference external" href="https://coderefinery.github.io/installation/github/">these instructions</a>.</p></li>
<li><p>You will need a <strong>text editor</strong>. If you don’t have a favorite one, we recommend
<a class="reference external" href="https://coderefinery.github.io/installation/vscode/">VS Code</a>.</p></li>
<li><p><strong>If you prefer to work in the terminal</strong> and not in VS Code, set up these two (skip this if you use VS Code):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://coderefinery.github.io/installation/git-in-terminal/">Git in the terminal</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/installation/ssh/">SSH or HTTPS connection to GitHub from terminal</a></p></li>
</ul>
</li>
<li><p><strong>One of these two software environments</strong> (if you are not sure which one to
choose or have no preference, choose Conda):</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#conda"><span class="std std-ref">Conda environment</span></a></p></li>
<li><p><a class="reference internal" href="index.html#venv"><span class="std std-ref">Virtual environment</span></a> (Snakemake is not available in this environment)</p></li>
</ul>
</li>
<li><p><strong>Optional</strong> and only on Linux: <a class="reference external" href="https://apptainer.org/">Apptainer</a> following
<a class="reference external" href="https://apptainer.org/docs/admin/1.3/installation.html#install-from-pre-built-packages">these instructions</a>.</p></li>
</ol>
</div>
</section>
<section id="schedule">
<h2>Schedule<a class="headerlink" href="#schedule" title="Link to this heading"></a></h2>
<section id="day-1">
<h3>Day 1<a class="headerlink" href="#day-1" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>13:00-13:30 - <strong>Welcome and introduction</strong></p>
<ul>
<li><p>Practical information (tools, communication, breaks, etc.)</p></li>
<li><p>Motivation (reproducibility, robustness, distribution, improvement, trust, etc.)</p></li>
<li><p><a class="reference internal" href="index.html#example-project"><span class="std std-ref">Example project: Simulating the motion of planets</span></a></p></li>
</ul>
</li>
<li><p>13:30-14:45 - <a class="reference internal" href="index.html#version-control"><span class="std std-ref">Introduction to version control with Git and GitHub</span></a> (1/2)</p>
<ul>
<li><p><a class="reference internal" href="index.html#version-control-motivation"><span class="std std-ref">Motivation</span></a> (15 min)</p></li>
<li><p><a class="reference internal" href="index.html#browsing"><span class="std std-ref">Forking, cloning, and browsing</span></a> (30 min)</p></li>
<li><p><a class="reference internal" href="index.html#branching-and-committing"><span class="std std-ref">Creating branches and commits</span></a> (30 min)</p></li>
</ul>
</li>
<li><p>15:00-16:30 - <a class="reference internal" href="index.html#version-control"><span class="std std-ref">Introduction to version control with Git and GitHub</span></a> (2/2)</p>
<ul>
<li><p><a class="reference internal" href="index.html#merging"><span class="std std-ref">Merging changes and contributing to the project</span></a> (40 min)</p></li>
<li><p><a class="reference internal" href="index.html#conflict-resolution"><span class="std std-ref">Conflict resolution</span></a> (30 min)</p></li>
<li><p><a class="reference internal" href="index.html#practical-advice"><span class="std std-ref">Practical advice: How much Git is necessary?</span></a> (20 min)</p></li>
<li><p><a class="reference internal" href="index.html#sharing-repositories"><span class="std std-ref">Optional: How to turn your project to a Git repo and share it</span></a> (30 min)</p></li>
</ul>
</li>
<li><p>16:45-18:00 - <a class="reference internal" href="index.html#documentation"><span class="std std-ref">Code documentation</span></a></p></li>
</ul>
</section>
<section id="day-2">
<h3>Day 2<a class="headerlink" href="#day-2" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>09:00-10:30 - <a class="reference internal" href="index.html#collaboration"><span class="std std-ref">Collaborative version control and code review</span></a> (1/2)</p>
<ul>
<li><p><a class="reference internal" href="index.html#concepts"><span class="std std-ref">Concepts around collaboration</span></a> (10 min)</p></li>
<li><p><a class="reference internal" href="index.html#same-repository"><span class="std std-ref">Collaborating within the same repository</span></a> (40 min)</p></li>
<li><p><a class="reference internal" href="index.html#code-review"><span class="std std-ref">Practicing code review</span></a> (40 min)</p></li>
</ul>
</li>
<li><p>10:45-12:15 - <a class="reference internal" href="index.html#collaboration"><span class="std std-ref">Collaborative version control and code review</span></a> (2/2)</p>
<ul>
<li><p><a class="reference internal" href="index.html#forking-workflow"><span class="std std-ref">How to contribute changes to repositories that belong to others</span></a> (50 min)</p></li>
<li><p><a class="reference internal" href="index.html#collaboration-demo-discussion"><span class="std std-ref">Conflict resolution, rebasing, and organizational strategies</span></a> (40 min)</p></li>
</ul>
</li>
<li><p>16:45-18:00 - <strong>Debriefing and Q&amp;A</strong></p>
<ul>
<li><p>Participants work on their projects</p></li>
<li><p>Together we study actual codes that participants wrote or work on</p></li>
<li><p>Constructively we discuss possible improvements</p></li>
<li><p>Give individual feedback on code projects</p></li>
</ul>
</li>
</ul>
</section>
<section id="day-3">
<h3>Day 3<a class="headerlink" href="#day-3" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>09:00-10:30 - <a class="reference internal" href="index.html#testing"><span class="std std-ref">Automated testing</span></a></p></li>
<li><p>10:45-12:15 - <a class="reference internal" href="index.html#reusable"><span class="std std-ref">How to make the project more reusable</span></a></p></li>
<li><p>13:00-14:45 - Code quality and good practices</p>
<ul>
<li><p><a class="reference internal" href="index.html#refactoring-concepts"><span class="std std-ref">Concepts in refactoring and modular code design</span></a> (15 min)</p></li>
<li><p><a class="reference internal" href="index.html#refactoring-demo"><span class="std std-ref">Demo: From a script towards a workflow</span></a> (90 min)</p></li>
</ul>
</li>
<li><p>15:00-16:30 - How to release and publish your code</p>
<ul>
<li><p><a class="reference internal" href="index.html#software-licensing"><span class="std std-ref">Choosing a software license</span></a> (30 min)</p></li>
<li><p><a class="reference internal" href="index.html#publishing"><span class="std std-ref">How to publish your code</span></a> (15 min)</p></li>
<li><p><a class="reference internal" href="index.html#packaging"><span class="std std-ref">Creating a Python package and deploying it to PyPI</span></a> (45 min)</p></li>
</ul>
</li>
<li><p>16:45-18:00 - <strong>Debriefing and Q&amp;A</strong></p>
<ul>
<li><p>Participants work on their projects</p></li>
<li><p>Together we study actual codes that participants wrote or work on</p></li>
<li><p>Constructively we discuss possible improvements</p></li>
<li><p>Give individual feedback on code projects</p></li>
</ul>
</li>
</ul>
<div class="toctree-wrapper compound">
<span id="document-installation/conda"></span><section id="conda-environment">
<span id="conda"></span><h4>Conda environment<a class="headerlink" href="#conda-environment" title="Link to this heading"></a></h4>
<p>A Conda environment is an isolated software environment that is used to manage dependencies for a project
and you decide where it is located.</p>
<p>You will need a <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file that documents the dependencies:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">coderefinery</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bioconda</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python &gt;= 3.10</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">click</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flit</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ipywidgets</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">isort</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jupyterlab</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jupyterlab_code_formatter</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jupyterlab-git</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">matplotlib</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myst-parser</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nbdime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest-cov</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scalene</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">seaborn</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snakemake-minimal</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-autoapi</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-autobuild</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx_rtd_theme &gt;= 2.0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vulture</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scikit-image</span>
</pre></div>
</div>
<section id="before-you-create-a-virtual-environment">
<h5>Before you create a virtual environment<a class="headerlink" href="#before-you-create-a-virtual-environment" title="Link to this heading"></a></h5>
<ol class="arabic simple">
<li><p>Create a new directory for this course.</p></li>
<li><p>In this directory, create an <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file and copy-paste the dependencies above into it.</p></li>
</ol>
</section>
<section id="choose-the-tool-to-manage-the-environment">
<h5>Choose the tool to manage the environment<a class="headerlink" href="#choose-the-tool-to-manage-the-environment" title="Link to this heading"></a></h5>
<p>If you are already using one of these tools, please continue using the tool that you like and know.
If you are new to this, <strong>we recommend using Miniconda or Miniforge</strong>.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Anaconda</a></p>
<ul>
<li><p>Advantages: easy to install, easy to use, good for beginners</p></li>
<li><p>Disadvantages: large download, installs more than we will need, license restrictions</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://docs.anaconda.com/miniconda/">Miniconda</a></p>
<ul>
<li><p>Advantages: small size, installs only what you need</p></li>
<li><p>Disadvantages: no graphical interface, license restrictions</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/conda-forge/miniforge">Miniforge</a></p>
<ul>
<li><p>Advantages: small size, no license restrictions</p></li>
<li><p>Disadvantages: no graphical interface</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://mamba.readthedocs.io/en/latest/user_guide/micromamba.html">Micromamba</a></p>
<ul>
<li><p>Advantages: fast, small size</p></li>
<li><p>Disadvantages: no graphical interface</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://pixi.sh/latest/">Pixi</a></p>
<ul>
<li><p>Advantages: fast and new</p></li>
<li><p>Disadvantages: new and less tested and not documented here</p></li>
</ul>
</li>
</ul>
</section>
<section id="creating-the-virtual-environment">
<h5>Creating the virtual environment<a class="headerlink" href="#creating-the-virtual-environment" title="Link to this heading"></a></h5>
<ol class="arabic">
<li><p>Open your terminal shell (e.g. Bash or Zsh).</p></li>
<li><p>Activate <code class="docutils literal notranslate"><span class="pre">conda</span></code> using <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span></code> or <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">~/miniconda3/bin/activate</span></code>.</p></li>
<li><p>Run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>--file<span class="w"> </span>environment.yml
</pre></div>
</div>
</li>
<li><p>Make sure that you see “coderefinery” in the output when you ask for a list of all available environments:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>list
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<span id="document-installation/virtual-environment"></span><section id="virtual-environment">
<span id="venv"></span><h4>Virtual environment<a class="headerlink" href="#virtual-environment" title="Link to this heading"></a></h4>
<p>A virtual environment is an isolated software environment that is used to manage dependencies for a project
and you decide where it is located.</p>
<p>You will need a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file that documents the dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">black</span>
<span class="n">click</span>
<span class="n">flit</span>
<span class="n">ipywidgets</span>
<span class="n">isort</span>
<span class="n">jupyterlab</span>
<span class="n">jupyterlab</span><span class="o">-</span><span class="n">code</span><span class="o">-</span><span class="n">formatter</span>
<span class="n">jupyterlab</span><span class="o">-</span><span class="n">git</span>
<span class="n">matplotlib</span>
<span class="n">myst</span><span class="o">-</span><span class="n">parser</span>
<span class="n">nbdime</span>
<span class="n">numpy</span>
<span class="n">pandas</span>
<span class="n">pytest</span>
<span class="n">pytest</span><span class="o">-</span><span class="n">cov</span>
<span class="n">scalene</span>
<span class="n">seaborn</span>
<span class="n">sphinx</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autoapi</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autobuild</span>
<span class="n">sphinx_rtd_theme</span> <span class="o">&gt;=</span> <span class="mf">2.0</span>
<span class="n">vulture</span>
<span class="n">scikit</span><span class="o">-</span><span class="n">image</span>
</pre></div>
</div>
<section id="before-you-create-a-virtual-environment">
<h5>Before you create a virtual environment<a class="headerlink" href="#before-you-create-a-virtual-environment" title="Link to this heading"></a></h5>
<ol class="arabic simple">
<li><p>Create a new directory for this course.</p></li>
<li><p>In this directory, create a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file and copy-paste the dependencies above into it.</p></li>
</ol>
</section>
<section id="creating-the-virtual-environment">
<h5>Creating the virtual environment<a class="headerlink" href="#creating-the-virtual-environment" title="Link to this heading"></a></h5>
<p>Now create a virtual environment in this directory either using <a class="reference external" href="https://packaging.python.org/en/latest/guides/installing-using-pip-and-virtual-environments/">pip and
venv</a>
(more traditional and safer) or using <a class="reference external" href="https://docs.astral.sh/uv/">uv</a> (more modern but also less tested):</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-cGlwIGFuZCB2ZW52" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-cGlwIGFuZCB2ZW52" name="cGlwIGFuZCB2ZW52" role="tab" tabindex="0">pip and venv</button><button aria-controls="panel-0-dXY=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-dXY=" name="dXY=" role="tab" tabindex="-1">uv</button></div><div aria-labelledby="tab-0-cGlwIGFuZCB2ZW52" class="sphinx-tabs-panel group-tab" id="panel-0-cGlwIGFuZCB2ZW52" name="cGlwIGFuZCB2ZW52" role="tabpanel" tabindex="0"><p>Create a new virtual environment and activate it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>coderefinery-environment
<span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>coderefinery-environment/bin/activate
</pre></div>
</div>
<p>Install the dependencies into the environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</div><div aria-labelledby="tab-0-dXY=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-dXY=" name="dXY=" role="tabpanel" tabindex="0"><p>Create a new virtual environment and activate it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>uv<span class="w"> </span>venv<span class="w"> </span>coderefinery-environment
<span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>coderefinery-environment/bin/activate
</pre></div>
</div>
<p>Install the dependencies into the environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>uv<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</div></div>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-example"></span><section id="example-project-simulating-the-motion-of-planets">
<span id="example-project"></span><h4>Example project: Simulating the motion of planets<a class="headerlink" href="#example-project-simulating-the-motion-of-planets" title="Link to this heading"></a></h4>
<p>The <a class="reference external" href="https://github.com/workshop-material/planets">example code</a> that we will study
is a hopefully simple N-body simulation written in Python. It is not important
or expected that we understand the code in any detail.</p>
<video controls="True" preload="auto" width="600"><source src="_images/animation.mp4" type="video/mp4"></video><p>The <strong>big picture</strong> is that the code simulates the motion of a number of
planets:</p>
<ul class="simple">
<li><p>We can choose the number of planets.</p></li>
<li><p>Each planet starts with a random position, velocity, and mass.</p></li>
<li><p>At each time step, the code calculates the gravitational force between each
pair of planets.</p></li>
<li><p>The forces accelerate each planet, the acceleration modifies the velocity,
the velocity modifies the position of each planet.</p></li>
<li><p>We can choose the number of time steps.</p></li>
<li><p>The units were chosen to make numbers easy to read.</p></li>
</ul>
<section id="example-run">
<h5>Example run<a class="headerlink" href="#example-run" title="Link to this heading"></a></h5>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<p>The instructor demonstrates running the code on their computer.</p>
</div>
<p>The code is written to accept <strong>command-line arguments</strong> to specify the number
of planets and the number of time steps.</p>
<p>We first generate starting data:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>generate-data.py<span class="w"> </span>--num-planets<span class="w"> </span><span class="m">10</span><span class="w"> </span>--output-file<span class="w"> </span>initial.csv
</pre></div>
</div>
<p>The generated file (initial.csv) could look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="p">,</span><span class="n">py</span><span class="p">,</span><span class="n">pz</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">vz</span><span class="p">,</span><span class="n">mass</span>
<span class="o">-</span><span class="mf">46.88</span><span class="p">,</span><span class="o">-</span><span class="mf">42.51</span><span class="p">,</span><span class="mf">88.33</span><span class="p">,</span><span class="o">-</span><span class="mf">0.86</span><span class="p">,</span><span class="o">-</span><span class="mf">0.18</span><span class="p">,</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">6.70</span>
<span class="o">-</span><span class="mf">5.29</span><span class="p">,</span><span class="mf">17.09</span><span class="p">,</span><span class="o">-</span><span class="mf">96.13</span><span class="p">,</span><span class="mf">0.66</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="o">-</span><span class="mf">0.17</span><span class="p">,</span><span class="mf">3.51</span>
<span class="mf">83.53</span><span class="p">,</span><span class="o">-</span><span class="mf">92.83</span><span class="p">,</span><span class="o">-</span><span class="mf">68.77</span><span class="p">,</span><span class="o">-</span><span class="mf">0.26</span><span class="p">,</span><span class="o">-</span><span class="mf">0.48</span><span class="p">,</span><span class="mf">0.24</span><span class="p">,</span><span class="mf">6.84</span>
<span class="o">-</span><span class="mf">36.31</span><span class="p">,</span><span class="mf">25.48</span><span class="p">,</span><span class="mf">64.16</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="o">-</span><span class="mf">0.56</span><span class="p">,</span><span class="mf">1.53</span>
<span class="o">-</span><span class="mf">68.38</span><span class="p">,</span><span class="o">-</span><span class="mf">17.21</span><span class="p">,</span><span class="o">-</span><span class="mf">97.07</span><span class="p">,</span><span class="mf">0.60</span><span class="p">,</span><span class="mf">0.26</span><span class="p">,</span><span class="mf">0.69</span><span class="p">,</span><span class="mf">6.63</span>
<span class="o">-</span><span class="mf">48.37</span><span class="p">,</span><span class="o">-</span><span class="mf">48.74</span><span class="p">,</span><span class="mf">3.92</span><span class="p">,</span><span class="o">-</span><span class="mf">0.92</span><span class="p">,</span><span class="o">-</span><span class="mf">0.33</span><span class="p">,</span><span class="o">-</span><span class="mf">0.93</span><span class="p">,</span><span class="mf">8.60</span>
<span class="mf">40.53</span><span class="p">,</span><span class="o">-</span><span class="mf">75.50</span><span class="p">,</span><span class="mf">44.18</span><span class="p">,</span><span class="o">-</span><span class="mf">0.62</span><span class="p">,</span><span class="o">-</span><span class="mf">0.31</span><span class="p">,</span><span class="o">-</span><span class="mf">0.53</span><span class="p">,</span><span class="mf">8.04</span>
<span class="o">-</span><span class="mf">27.21</span><span class="p">,</span><span class="mf">10.78</span><span class="p">,</span><span class="o">-</span><span class="mf">78.82</span><span class="p">,</span><span class="o">-</span><span class="mf">0.09</span><span class="p">,</span><span class="o">-</span><span class="mf">0.55</span><span class="p">,</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">5.35</span>
<span class="mf">88.42</span><span class="p">,</span><span class="o">-</span><span class="mf">74.95</span><span class="p">,</span><span class="o">-</span><span class="mf">45.85</span><span class="p">,</span><span class="mf">0.81</span><span class="p">,</span><span class="mf">0.68</span><span class="p">,</span><span class="mf">0.56</span><span class="p">,</span><span class="mf">5.36</span>
<span class="mf">39.09</span><span class="p">,</span><span class="mf">53.12</span><span class="p">,</span><span class="o">-</span><span class="mf">59.54</span><span class="p">,</span><span class="o">-</span><span class="mf">0.54</span><span class="p">,</span><span class="mf">0.56</span><span class="p">,</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">8.98</span>
</pre></div>
</div>
<p>Then we can simulate their motion (in this case for 20 steps):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>simulate.py<span class="w"> </span>--num-steps<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="se">\</span>
<span class="w">                     </span>--input-file<span class="w"> </span>initial.csv<span class="w"> </span><span class="se">\</span>
<span class="w">                     </span>--output-file<span class="w"> </span>final.csv
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--output-file</span></code> (final.csv) is again a CSV file (comma-separated values)
and contains the final positions of all planets.</p>
<p>It is possible to run on <strong>multiple cores</strong> and to <strong>animate</strong> the result.
Here is an example with 100 planets:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>generate-data.py<span class="w"> </span>--num-planets<span class="w"> </span><span class="m">100</span><span class="w"> </span>--output-file<span class="w"> </span>initial.csv

<span class="gp">$ </span>python<span class="w"> </span>simulate.py<span class="w"> </span>--num-steps<span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="se">\</span>
<span class="w">                     </span>--input-file<span class="w"> </span>initial.csv<span class="w"> </span><span class="se">\</span>
<span class="w">                     </span>--output-file<span class="w"> </span>final.csv<span class="w"> </span><span class="se">\</span>
<span class="w">                     </span>--trajectories-file<span class="w"> </span>trajectories.npz<span class="w"> </span><span class="se">\</span>
<span class="hll"><span class="w">                     </span>--num-cores<span class="w"> </span><span class="m">8</span>
</span>
<span class="gp">$ </span>python<span class="w"> </span>animate.py<span class="w"> </span>--initial-file<span class="w"> </span>initial.csv<span class="w"> </span><span class="se">\</span>
<span class="w">                    </span>--trajectories-file<span class="w"> </span>trajectories.npz<span class="w"> </span><span class="se">\</span>
<span class="hll"><span class="w">                    </span>--output-file<span class="w"> </span>animation.mp4
</span></pre></div>
</div>
<div class="admonition-learning-goals admonition">
<p class="admonition-title">Learning goals</p>
<ul class="simple">
<li><p>What are the most important steps to make this code <strong>reusable by others</strong>
and <strong>our future selves</strong>?</p></li>
<li><p>Be able to apply these techniques to your own code/script.</p></li>
</ul>
</div>
<div class="admonition-we-will-not-focus-on admonition">
<p class="admonition-title">We will not focus on …</p>
<ul class="simple">
<li><p>… how the code works internally in detail.</p></li>
<li><p>… whether this is the most efficient algorithm.</p></li>
<li><p>… whether the code is numerically stable.</p></li>
<li><p>… how to code scales with the number of cores.</p></li>
<li><p>… whether it is portable to other operating systems (we will discuss this later).</p></li>
</ul>
</div>
</section>
</section>
<span id="document-version-control"></span><section id="introduction-to-version-control-with-git-and-github">
<span id="version-control"></span><h4>Introduction to version control with Git and GitHub<a class="headerlink" href="#introduction-to-version-control-with-git-and-github" title="Link to this heading"></a></h4>
<div class="toctree-wrapper compound">
<span id="document-version-control/motivation"></span><section id="motivation">
<span id="version-control-motivation"></span><h5>Motivation<a class="headerlink" href="#motivation" title="Link to this heading"></a></h5>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Browse <strong>commits</strong> and <strong>branches</strong> of a Git repository.</p></li>
<li><p>Remember that commits are like <strong>snapshots</strong> of the repository at a certain
point in time.</p></li>
<li><p>Know the difference between <strong>Git</strong> (something that tracks changes) and
<strong>GitHub/GitLab</strong> (a web platform to host Git repositories).</p></li>
</ul>
</div>
<section id="why-do-we-need-to-keep-track-of-versions">
<h6>Why do we need to keep track of versions?<a class="headerlink" href="#why-do-we-need-to-keep-track-of-versions" title="Link to this heading"></a></h6>
<p>Version control is an answer to the following questions (do you recognize some
of them?):</p>
<ul class="simple">
<li><p>“It broke … hopefully I have a working version somewhere?”</p></li>
<li><p>“Can you please send me the latest version?”</p></li>
<li><p>“Where is the latest version?”</p></li>
<li><p>“Which version are you using?”</p></li>
<li><p>“Which version have the authors used in the paper I am trying to reproduce?”</p></li>
<li><p>“Found a bug! Since when was it there?”</p></li>
<li><p>“I am sure it used to work. When did it change?”</p></li>
<li><p>“My laptop is gone. Is my thesis now gone?”</p></li>
</ul>
</section>
<section id="demonstration">
<h6>Demonstration<a class="headerlink" href="#demonstration" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Example repository: <a class="reference external" href="https://github.com/workshop-material/planets">https://github.com/workshop-material/planets</a></p></li>
<li><p>Commits are like <strong>snapshots</strong> and if we break something we can go back to a
previous snapshot.</p></li>
<li><p>Commits carry <strong>metadata</strong> about changes: author, date, commit message, and
a checksum.</p></li>
<li><p><strong>Branches</strong> are like parallel universes where you can experiment with
changes without affecting the default branch:
<a class="reference external" href="https://github.com/workshop-material/planets/network">https://github.com/workshop-material/planets/network</a>
(“Insights” -&gt; “Network”)</p></li>
<li><p>With version control we can <strong>annotate code</strong>
(<a class="reference external" href="https://github.com/workshop-material/planets/blame/main/animate.py">example</a>).</p></li>
<li><p><strong>Collaboration</strong>: We can fork (make a copy on GitHub), clone (make a copy
to our computer), review, compare, share, and discuss.</p></li>
<li><p><strong>Code review</strong>: Others can suggest changes using pull requests or merge
requests. These can be reviewed and discussed before they are merged.
Conceptually, they are similar to “suggesting changes” in Google Docs.</p></li>
</ul>
</section>
<section id="features-roll-back-branching-merging-collaboration">
<h6>Features: roll-back, branching, merging, collaboration<a class="headerlink" href="#features-roll-back-branching-merging-collaboration" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p><strong>Roll-back</strong>: you can always go back to a previous version and compare</p></li>
<li><p><strong>Branching and merging</strong>:</p>
<ul>
<li><p>Work on different ideas at the same time</p></li>
<li><p>You can experiment with an idea and discard it if it turns out to be a bad idea</p></li>
<li><p>Different people can work on the same code/project without interfering</p></li>
</ul>
</li>
</ul>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/gophers.png"><img alt="Branching explained with a gopher" src="_images/gophers.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Image created using <a class="reference external" href="https://gopherize.me/">https://gopherize.me/</a>
(<a class="reference external" href="https://twitter.com/jay_gee/status/703360688618536960">inspiration</a>).</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Collaboration</strong>: review, compare, share, discuss</p></li>
<li><p><a class="reference external" href="https://github.com/workshop-material/planets/network">Example network graph</a></p></li>
</ul>
</section>
<section id="talking-about-code">
<h6>Talking about code<a class="headerlink" href="#talking-about-code" title="Link to this heading"></a></h6>
<p>Which of these two is more practical?</p>
<ol class="arabic simple">
<li><p>“Clone the code, go to the file ‘simulate.py’, and search for ‘force_between_planets’.
Oh! But make sure you use the version from September 2024.”</p></li>
<li><p>Or I can send you a permalink: <a class="reference external" href="https://github.com/workshop-material/planets/blob/1343ac0/simulate.py#L31C5-L39">https://github.com/workshop-material/planets/blob/1343ac0/simulate.py#L31C5-L39</a></p></li>
</ol>
</section>
<section id="what-we-typically-like-to-snapshot">
<h6>What we typically like to snapshot<a class="headerlink" href="#what-we-typically-like-to-snapshot" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Software (this is how it started but Git/GitHub can track a lot more)</p></li>
<li><p>Scripts</p></li>
<li><p>Documents (plain text files much better suitable than Word documents)</p></li>
<li><p>Manuscripts (Git is great for collaborating/sharing LaTeX or <a class="reference external" href="https://quarto.org/">Quarto</a> manuscripts)</p></li>
<li><p>Configuration files</p></li>
<li><p>Website sources</p></li>
<li><p>Data</p></li>
</ul>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>In this example somebody tried to keep track of versions without a version
control system tool like Git.  Discuss the following directory listing. What
possible problems do you anticipate with this kind of “version control”:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>myproject-2019.zip
myproject-2020-february.zip
myproject-2021-august.zip
myproject-2023-09-19-working.zip
myproject-2023-09-21.zip
myproject-2023-09-21-test.zip
myproject-2023-09-21-myversion.zip
myproject-2023-09-21-newfeature.zip
...
(100 more files like these)
</pre></div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ul class="simple">
<li><p>Giving a version to a collaborator and merging changes later with own
changes sounds like lots of work.</p></li>
<li><p>What if you discover a bug and want to know since when the bug existed?</p></li>
</ul>
</div>
</div>
</section>
</section>
<span id="document-version-control/browsing"></span><section id="forking-cloning-and-browsing">
<span id="browsing"></span><h5>Forking, cloning, and browsing<a class="headerlink" href="#forking-cloning-and-browsing" title="Link to this heading"></a></h5>
<p>In this episode, we will look at an <strong>existing repository</strong> to understand how
all the pieces work together. Along the way, we will make a copy (by
<strong>forking</strong> and/or <strong>cloning</strong>) of the repository for us, which will be used
for our own changes.</p>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>See a real Git repository and understand what is inside of it.</p></li>
<li><p>Understand how version control allows advanced inspection of a
repository.</p></li>
<li><p>See how Git allows multiple people to work on the same project at the same time.</p></li>
<li><p><strong>See the big picture</strong> instead of remembering a bunch of commands.</p></li>
</ul>
</div>
<section id="github-vs-code-or-command-line">
<h6>GitHub, VS Code, or command line<a class="headerlink" href="#github-vs-code-or-command-line" title="Link to this heading"></a></h6>
<p>We offer <strong>three different paths</strong> for this exercise:</p>
<ul class="simple">
<li><p><strong>GitHub</strong> (this is the one we will demonstrate)</p></li>
<li><p><strong>VS Code</strong> (if you prefer to follow along using an editor)</p></li>
<li><p><strong>Command line</strong> (for people comfortable with the command line)</p></li>
</ul>
</section>
<section id="creating-a-copy-of-the-repository-by-forking-or-cloning">
<h6>Creating a copy of the repository by “forking” or “cloning”<a class="headerlink" href="#creating-a-copy-of-the-repository-by-forking-or-cloning" title="Link to this heading"></a></h6>
<p>A <strong>repository</strong> is a collection of files in one directory tracked by Git.  A
GitHub repository is GitHub’s copy, which adds things like access control,
issue tracking, and discussions.  Each GitHub repository is owned by a user or
organization, who controls access.</p>
<p>First, we need to make <strong>our own copy</strong> of the exercise repository. This will
become important later, when we make our own changes.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/fork.png"><img alt="Illustration of forking a repository on GitHub" src="_images/fork.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-text">Illustration of forking a repository on GitHub.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/clone.png"><img alt="Illustration of cloning a repository to your computer" src="_images/clone.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-text">Illustration of cloning a repository to your computer.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/clone-of-fork.png"><img alt="Illustration of cloning a forked repository to your computer" src="_images/clone-of-fork.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-text">It is also possible to do this: to clone a forked repository to your computer.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>At all times you should be aware of if you are looking at <strong>your repository</strong>
or the <strong>upstream repository</strong> (original repository):</p>
<ul class="simple">
<li><p>Your repository: https://github.com/<strong>USER</strong>/planets</p></li>
<li><p>Upstream repository: https://github.com/<strong>workshop-material</strong>/planets</p></li>
</ul>
<div class="admonition-how-to-create-a-fork admonition">
<p class="admonition-title">How to create a fork</p>
<ol class="arabic simple">
<li><p>Go to the repository view on GitHub: <a class="reference external" href="https://github.com/workshop-material/planets">https://github.com/workshop-material/planets</a></p></li>
<li><p>First, on GitHub, click the button that says “Fork”. It is towards
the top-right of the screen.</p></li>
<li><p>You should shortly be redirected to your copy of the repository
<strong>USER/planets</strong>.</p></li>
</ol>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<p>Before starting the exercise session show
how to fork the repository to own account
(above).</p>
</div>
</section>
<section id="exercise-copy-and-browse-an-existing-project">
<h6>Exercise: Copy and browse an existing project<a class="headerlink" href="#exercise-copy-and-browse-an-existing-project" title="Link to this heading"></a></h6>
<p>Work on this by yourself or in pairs.</p>
<div class="admonition-exercise-preparation prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Exercise preparation</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-0-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-0-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-0-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-0-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>In this case you will work on a fork.</p>
<p>You only need to open your own view, as described above.  The browser
URL should look like https://github.com/<strong>USER</strong>/planets, where
USER is your GitHub username.</p>
</div><div aria-labelledby="tab-0-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>You need to have forked the repository as described above.</p>
<p>We need to start by making a clone of this repository so that you can work
locally.</p>
<ol class="arabic simple">
<li><p>Start VS Code.</p></li>
<li><p>If you don’t have the default view (you already have a project
open), go to File → New Window.</p></li>
<li><p>Under “Start” on the screen, select “Clone Git Repository…”. Alternatively
navigate to the “Source Control” tab on the left sidebar and click on the “Clone Repository” button.</p></li>
<li><p>Paste in this URL: <code class="docutils literal notranslate"><span class="pre">https://github.com/USER/planets</span></code>, where
<code class="docutils literal notranslate"><span class="pre">USER</span></code> is your username.  You can copy this from the browser.</p></li>
<li><p>Browse and select the folder in which you want to clone the
repository.</p></li>
<li><p>Say yes, you want to open this repository.</p></li>
<li><p>Select “Yes, I trust the authors” (the other option works too).</p></li>
</ol>
</div><div aria-labelledby="tab-0-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p><strong>This path is advanced and we do not include all command line
information: you need to be somewhat
comfortable with the command line already.</strong></p>
<p>You need to have forked the repository as described above.</p>
<p>We need to start by making a clone of this repository so that you can work
locally.</p>
<ol class="arabic simple">
<li><p>Start the terminal in which you use Git (terminal application, or
Git Bash).</p></li>
<li><p>Change to the directory where you would want the repository to be
(<code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">~/code</span></code> for example, if the <code class="docutils literal notranslate"><span class="pre">~/code</span></code> directory is where you
store your files).</p></li>
<li><p>Run the following command: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/USER/planets</span></code>, where <code class="docutils literal notranslate"><span class="pre">USER</span></code> is your
username.  You might need to use a SSH clone command instead of
HTTPS, depending on your setup.</p></li>
<li><p>Change to that directory: <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">planets</span></code></p></li>
</ol>
</div></div>
</div>
<div class="admonition-exercise-browsing-an-existing-project-20-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Browsing an existing project (20 min)</p>
<p>Browse the <a class="reference external" href="https://github.com/workshop-material/planets">example project</a> and
explore commits and branches, either on a fork or on a clone.  Take notes and
prepare questions.  The hints are for the GitHub path in the browser.</p>
<ol class="arabic simple">
<li><p>Browse the <strong>commit history</strong>: Are commit messages understandable?
(Hint: “Commit history”, the timeline symbol, above the file list)</p></li>
<li><p>Compare the commit history with the <strong>network graph</strong> (“Insights” -&gt; “Network”). Can you find the branches?</p></li>
<li><p>Try to find the <strong>history of commits for a single file</strong>, e.g. <code class="docutils literal notranslate"><span class="pre">simulate.py</span></code>.
(Hint: “History” button in the file view)</p></li>
<li><p><strong>Which files include the word “position”</strong>?
(Hint: the GitHub search on top of the repository view)</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">simulate.py</span></code> file,
find out who modified the “gravitational constant”
last and <strong>in which commit</strong>.
(Hint: “Blame” view in the file view)</p></li>
<li><p>Can you use this code yourself? <strong>Are you allowed to share
modifications</strong>?
(Hint: look for a license file)</p></li>
</ol>
</div>
<p>The solution below goes over most of the answers, and you are
encouraged to use it when the hints aren’t enough - this is by
design.</p>
</section>
<section id="solution-and-walk-through">
<h6>Solution and walk-through<a class="headerlink" href="#solution-and-walk-through" title="Link to this heading"></a></h6>
<section id="basic-browsing">
<h6 aria-level="7">(1) Basic browsing<a class="headerlink" href="#basic-browsing" title="Link to this heading"></a></h6>
<p>The most basic thing to look at is the history of commits.</p>
<ul class="simple">
<li><p>This is visible from a button in the repository view.  We see every
change, when, and who has committed.</p></li>
<li><p>Every change has a unique identifier, such as <code class="docutils literal notranslate"><span class="pre">244c993</span></code>.  This can
be used to identify both this change, and the whole project’s
version as of that change.</p></li>
<li><p>Clicking on a change in the view shows more.</p></li>
</ul>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-1-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-1-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-1-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-1-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>Click on the timeline symbol in the repository view:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/history.png"><img alt="Screenshot on GitHub of where to find the commit history" class="with-border" src="_images/history.png" style="width: 100%;" /></a>
</figure>
</div><div aria-labelledby="tab-1-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>This can be done from “Timeline”, in the bottom of explorer, but only
for a single file.</p>
</div><div aria-labelledby="tab-1-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>Run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log
</pre></div>
</div>
<p>Try also:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--oneline
</pre></div>
</div>
</div></div>
</section>
<section id="compare-commit-history-with-network-graph">
<h6 aria-level="7">(2) Compare commit history with network graph<a class="headerlink" href="#compare-commit-history-with-network-graph" title="Link to this heading"></a></h6>
<p>The commit history we saw above looks linear: one commit after
another.  But if we look at the network view, we see some branching and merging points.
We’ll see how to do these later.  This is another one of the
basic Git views.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-2-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-2-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-2-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-2-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>In a new browser tab, open the “Insights” tab, and click on “Network”.
You can hover over the commit dots to see the person who committed and
how they correspond with the commits in the other view:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/network.png"><img alt="Screenshot on GitHub of the network graph" class="with-border" src="_images/network.png" style="width: 100%;" /></a>
</figure>
</div><div aria-labelledby="tab-2-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>We don’t know how to do this without an extension. Try starting a terminal and using the
“Command line” option.</p>
</div><div aria-labelledby="tab-2-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>This is a useful command to browse the network of commits locally:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--graph<span class="w"> </span>--oneline<span class="w"> </span>--decorate<span class="w"> </span>--all
</pre></div>
</div>
<p>To avoid having to type this long command every time, you can define an alias (shortcut):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.graph<span class="w"> </span><span class="s2">&quot;log --graph --oneline --decorate --all&quot;</span>
</pre></div>
</div>
<p>From then on, you can use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> to see the network graph.</p>
</div></div>
</section>
<section id="how-can-you-browse-the-history-of-a-single-file">
<h6 aria-level="7">(3) How can you browse the history of a single file?<a class="headerlink" href="#how-can-you-browse-the-history-of-a-single-file" title="Link to this heading"></a></h6>
<p>We see the history for the whole repository, but we can also see it
for a single file.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-3-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-3-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-3-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-3-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>Navigate to the file view: Main page → simulate.py.
Click the “History” button near the top right.</p>
</div><div aria-labelledby="tab-3-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>Open simulate.py file in the editor.  Under the file browser,
we see a “Timeline” view there.</p>
</div><div aria-labelledby="tab-3-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>The <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code> command can take a filename and provide the log of only
a single file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git log simulate.py
</pre></div>
</div>
</div></div>
</section>
<section id="which-files-include-the-word-position">
<h6 aria-level="7">(4) Which files include the word “position”?<a class="headerlink" href="#which-files-include-the-word-position" title="Link to this heading"></a></h6>
<p>Version control makes it very easy to find all occurrences of a
word or pattern. This is useful for things like finding where functions or
variables are defined or used.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-4-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-4-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-4-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-4-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>We go to the main file view.  We click the Search magnifying
class at the very top, type “position”, and click enter. We see every
instance, including the context.</p>
<div class="admonition-searching-in-a-forked-repository-will-not-work-instantaneously admonition">
<p class="admonition-title">Searching in a forked repository will not work instantaneously!</p>
<p>It usually takes a few minutes before one can search for keywords in a forked repository
since it first needs to build the search index the very first time we search.
Start it, continue with other steps, then come back to this.</p>
</div>
</div><div aria-labelledby="tab-4-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>If you use the “Search” magnifying class on the left sidebar, and
search for “position” it shows the occurrences in every file. You can
click to see the usage in context.</p>
</div><div aria-labelledby="tab-4-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p><code class="docutils literal notranslate"><span class="pre">grep</span></code> is the command line tool that searches for lines matching a term</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>grep<span class="w"> </span>position<span class="w">          </span><span class="c1"># only the lines</span>
<span class="gp">$ </span>git<span class="w"> </span>grep<span class="w"> </span>-C<span class="w"> </span><span class="m">3</span><span class="w"> </span>position<span class="w">     </span><span class="c1"># three lines of context</span>
<span class="gp">$ </span>git<span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>position<span class="w">       </span><span class="c1"># case insensitive</span>
</pre></div>
</div>
</div></div>
</section>
<section id="who-modified-a-particular-line-last-and-when">
<h6 aria-level="7">(5) Who modified a particular line last and when?<a class="headerlink" href="#who-modified-a-particular-line-last-and-when" title="Link to this heading"></a></h6>
<p>This is called the “annotate” or “blame” view. The name “blame”
is very unfortunate, but it is the standard term for historical reasons
for this functionality and it is not meant to blame anyone.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-5-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-5-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-5-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-5-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>From a file view, change preview to “Blame” towards the top-left.
To get the actual commit, click on the commit message next
to the code line that you are interested in.</p>
</div><div aria-labelledby="tab-5-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>This requires an extension.  We recommend for now you use the command
line version, after opening a terminal.</p>
</div><div aria-labelledby="tab-5-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>These two commands are similar but have slightly different output.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>annotate<span class="w"> </span>simulate.py
<span class="gp">$ </span>git<span class="w"> </span>blame<span class="w"> </span>simulate.py
</pre></div>
</div>
</div></div>
</section>
<section id="can-you-use-this-code-yourself-are-you-allowed-to-share-modifications">
<h6 aria-level="7">(6) Can you use this code yourself? Are you allowed to share modifications?<a class="headerlink" href="#can-you-use-this-code-yourself-are-you-allowed-to-share-modifications" title="Link to this heading"></a></h6>
<ul>
<li><p>Look at the file <code class="docutils literal notranslate"><span class="pre">LICENSE</span></code>.</p></li>
<li><p>On GitHub, click on the file to see a nice summary of what we can do with this:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/license.png"><img alt="Screenshot on GitHub summarizing license terms" class="with-border" src="_images/license.png" style="width: 100%;" /></a>
</figure>
</li>
</ul>
</section>
<section id="summary">
<h6 aria-level="7">Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Git allowed us to understand this simple project much better than we
could, if it was just a few files on our own computer.</p></li>
<li><p>It was easy to share the project with the course.</p></li>
<li><p>By forking the repository, we created our own copy. This is
important for the following, where we will make changes to
our copy.</p></li>
</ul>
</section>
</section>
</section>
<span id="document-version-control/branching-and-committing"></span><section id="creating-branches-and-commits">
<span id="branching-and-committing"></span><h5>Creating branches and commits<a class="headerlink" href="#creating-branches-and-commits" title="Link to this heading"></a></h5>
<p>The first and most basic task to do in Git is <strong>record changes</strong> using
commits. In this part, we will record changes in two
ways: on a <strong>new branch</strong> (which supports multiple lines of work at once), and directly
on the “main” branch (which happens to be the default branch here).</p>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Record new changes to our own copy of the project.</p></li>
<li><p>Understand adding changes in two separate branches.</p></li>
<li><p>See how to compare different versions or branches.</p></li>
</ul>
</div>
<section id="background">
<h6>Background<a class="headerlink" href="#background" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>In the previous episode we have browsed an existing <strong>repository</strong> and saw <strong>commits</strong>
and <strong>branches</strong>.</p></li>
<li><p>Each <strong>commit</strong> is a snapshot of the entire project at a certain
point in time and has a unique identifier (<strong>hash</strong>) .</p></li>
<li><p>A <strong>branch</strong> is a line of development, and the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch or <code class="docutils literal notranslate"><span class="pre">master</span></code> branch
are often the default branch in Git.</p></li>
<li><p>A branch in Git is like a <strong>sticky note that is attached to a commit</strong>. When we add
new commits to a branch, the sticky note moves to the new commit.</p></li>
<li><p><strong>Tags</strong> are a way to mark a specific commit as important, for example a release
version. They are also like a sticky note, but they don’t move when new
commits are added.</p></li>
</ul>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/gophers.png"><img alt="Branching explained with a gopher" src="_images/gophers.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">What if two people, at the same time, make two different changes?  Git
can merge them together easily.  Image created using <a class="reference external" href="https://gopherize.me/">https://gopherize.me/</a>
(<a class="reference external" href="https://twitter.com/jay_gee/status/703360688618536960">inspiration</a>).</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="exercise-creating-branches-and-commits">
<h6>Exercise: Creating branches and commits<a class="headerlink" href="#exercise-creating-branches-and-commits" title="Link to this heading"></a></h6>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/branches.png"><img alt="Illustration of what we want to achieve in this exercise" src="_images/branches.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-text">Illustration of what we want to achieve in this exercise.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-exercise-practice-creating-commits-and-branches-20-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Practice creating commits and branches (20 min)</p>
<ol class="arabic simple">
<li><p>First create a new branch and then either add a new file or modify an
existing file and commit the change.  Make sure that you now work <strong>on your
copy</strong> of the example repository. In your new commit you can share a Git or
programming trick you like.</p></li>
<li><p>In a new commit, modify the file again.</p></li>
<li><p>Switch to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch and create a commit there.</p></li>
<li><p>Browse the network and locate the commits that you just created (“Insights” -&gt; “Network”).</p></li>
<li><p>Compare the branch that you created with the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch. Can you find an easy way to see the differences?</p></li>
<li><p>Can you find a way to compare versions between two arbitrary commits in the repository?</p></li>
<li><p>Try to rename the branch that you created and then browse the network again.</p></li>
<li><p>Try to create a tag for one of the commits that you created (on GitHub,
create a “release”).</p></li>
</ol>
</div>
<p>The solution below goes over most of the answers, and you are
encouraged to use it when the hints aren’t enough - this is by
design.</p>
</section>
<section id="solution-and-walk-through">
<h6>Solution and walk-through<a class="headerlink" href="#solution-and-walk-through" title="Link to this heading"></a></h6>
<section id="create-a-new-branch-and-a-new-commit">
<h6 aria-level="7">(1) Create a new branch and a new commit<a class="headerlink" href="#create-a-new-branch-and-a-new-commit" title="Link to this heading"></a></h6>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-0-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-0-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-0-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-0-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><ol class="arabic simple">
<li><p>Where it says “main” at the top left, click, enter a new branch
name (e.g. <code class="docutils literal notranslate"><span class="pre">new-tutorial</span></code>), then click on
“Create branch … from main”.</p></li>
<li><p>Make sure you are still on the <code class="docutils literal notranslate"><span class="pre">new-tutorial</span></code> branch (it should say
it at the top), and click “Add file” → “Create new file” from the
upper right.</p></li>
<li><p>Enter a filename where it says “Name your file…”.</p></li>
<li><p>Share some Git or programming trick you like.</p></li>
<li><p>Click “Commit changes”</p></li>
<li><p>Enter a commit message. Then click “Commit
changes”.</p></li>
</ol>
<p>You should appear back at the file browser view, and see your
modification there.</p>
</div><div aria-labelledby="tab-0-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><ol class="arabic simple">
<li><p>Make sure that you are on the main branch.</p></li>
<li><p>Version control button on left sidebar → Three dots in upper right of source control → Branch → Create branch.</p></li>
<li><p>VS Code automatically switches to the new branch.</p></li>
<li><p>Create a new file.</p></li>
<li><p>In the version control sidebar, click the <code class="docutils literal notranslate"><span class="pre">+</span></code> sign to add the file for the next commit.</p></li>
<li><p>Enter a brief message and click “Commit”.</p></li>
</ol>
</div><div aria-labelledby="tab-0-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>Create a new branch called <code class="docutils literal notranslate"><span class="pre">new-tutorial</span></code> from <code class="docutils literal notranslate"><span class="pre">main</span></code> and switch to it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>new-tutorial<span class="w"> </span>main
</pre></div>
</div>
<p>Then create the new file. Finally add and commit the file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>tutorial.md<span class="w">  </span><span class="c1"># or a different file name</span>
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;sharing a programming trick&quot;</span>
</pre></div>
</div>
</div></div>
</section>
<section id="modify-the-file-again-with-a-new-commit">
<h6 aria-level="7">(2) Modify the file again with a new commit<a class="headerlink" href="#modify-the-file-again-with-a-new-commit" title="Link to this heading"></a></h6>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-1-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-1-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-1-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-1-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>This is similar to before, but we click on the existing file to
modify.</p>
<ol class="arabic simple">
<li><p>Click on the file you added or modified previously.</p></li>
<li><p>Click the edit button, the pencil icon at top-right.</p></li>
<li><p>Follow the “Commit changes” instructions as in the previous step.</p></li>
</ol>
</div><div aria-labelledby="tab-1-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>Repeat as in the previous step.</p>
</div><div aria-labelledby="tab-1-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>Modify the file. Then commit the new change:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>tutorial.md
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;short summary of the change&quot;</span>
</pre></div>
</div>
<p>Make sure to replace “short summary of the change” with a meaningful commit
message.</p>
</div></div>
</section>
<section id="switch-to-the-main-branch-and-create-a-commit-there">
<h6 aria-level="7">(3) Switch to the main branch and create a commit there<a class="headerlink" href="#switch-to-the-main-branch-and-create-a-commit-there" title="Link to this heading"></a></h6>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-2-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-2-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-2-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-2-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><ol class="arabic simple">
<li><p>Go back to the main repository page (your user’s page).</p></li>
<li><p>In the branch switch view (top left above the file view), switch to
<code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>Modify another file that already exists, following the pattern
from above.</p></li>
</ol>
</div><div aria-labelledby="tab-2-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>Use the branch selector at the bottom to switch back to the main branch.  Repeat the same steps as above,
but this time modify a different file.</p>
</div><div aria-labelledby="tab-2-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>First switch to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>main
</pre></div>
</div>
<p>Then modify a file. Finally <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> and then commit the change:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;short summary of the change&quot;</span>
</pre></div>
</div>
</div></div>
</section>
<section id="browse-the-commits-you-just-made">
<h6 aria-level="7">(4) Browse the commits you just made<a class="headerlink" href="#browse-the-commits-you-just-made" title="Link to this heading"></a></h6>
<p>Let’s look at what we did.  Now, the <code class="docutils literal notranslate"><span class="pre">main</span></code> and the new branches
have diverged: both have some modifications. Try to find the commits
you created.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-3-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-3-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-3-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-3-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>Insights tab → Network view (just like we have done before).</p>
</div><div aria-labelledby="tab-3-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>This requires an extension.  Opening the VS Code terminal lets you use the
command line method (View → Terminal will open a terminal at bottom).  This is
a normal command line interface and very useful for work.</p>
</div><div aria-labelledby="tab-3-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>graph
<span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--graph<span class="w"> </span>--oneline<span class="w"> </span>--decorate<span class="w"> </span>--all<span class="w">  </span><span class="c1"># if you didn&#39;t define git graph yet.</span>
</pre></div>
</div>
</div></div>
</section>
<section id="compare-the-branches">
<h6 aria-level="7">(5) Compare the branches<a class="headerlink" href="#compare-the-branches" title="Link to this heading"></a></h6>
<p>Comparing changes is an important thing we need to do.  When using the
GitHub view only, this may not be so common, but we’ll show it so that
it makes sense later on.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-4-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-4-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-4-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-4-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>A nice way to compare branches is to add <code class="docutils literal notranslate"><span class="pre">/compare</span></code> to the URL of the repository,
for example (replace USER):
https://github.com/<strong>USER</strong>/planets/compare</p>
</div><div aria-labelledby="tab-4-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>This seems to require an extension.  We recommend you use the command line method.</p>
</div><div aria-labelledby="tab-4-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>diff<span class="w"> </span>main<span class="w"> </span>new-tutorial
</pre></div>
</div>
<p>Try also the other way around:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>diff<span class="w"> </span>new-tutorial<span class="w"> </span>main
</pre></div>
</div>
<p>Try also this if you only want to see the file names that are different:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>diff<span class="w"> </span>--name-only<span class="w"> </span>main<span class="w"> </span>new-tutorial
</pre></div>
</div>
</div></div>
</section>
<section id="compare-two-arbitrary-commits">
<h6 aria-level="7">(6) Compare two arbitrary commits<a class="headerlink" href="#compare-two-arbitrary-commits" title="Link to this heading"></a></h6>
<p>This is similar to above, but not only between branches.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-5-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-5-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-5-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-5-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>Following the <code class="docutils literal notranslate"><span class="pre">/compare</span></code>-trick above, one can compare commits on GitHub by
adjusting the following URL:
https://github.com/<strong>USER</strong>/planets/compare/<strong>VERSION1</strong>..<strong>VERSION2</strong></p>
<p>Replace <code class="docutils literal notranslate"><span class="pre">USER</span></code> with your username and <code class="docutils literal notranslate"><span class="pre">VERSION1</span></code> and <code class="docutils literal notranslate"><span class="pre">VERSION2</span></code> with a commit hash or branch name.
Please try it out.</p>
</div><div aria-labelledby="tab-5-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>Again, we recommend using the Command Line method.</p>
</div><div aria-labelledby="tab-5-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>First try this to get a short overview of the commits:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--oneline
</pre></div>
</div>
<p>Then try to compare any two commit identifiers with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>.</p>
</div></div>
</section>
<section id="renaming-a-branch">
<h6 aria-level="7">(7) Renaming a branch<a class="headerlink" href="#renaming-a-branch" title="Link to this heading"></a></h6>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-6-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-6-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-6-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-6-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-6-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>Branch button → View all branches → three dots at right side → Rename branch.</p>
</div><div aria-labelledby="tab-6-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>Version control sidebar → Three dots (same as in step 2) → Branch → Rename branch.  Make sure you are on the right branch before you start.</p>
</div><div aria-labelledby="tab-6-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>Renaming the current branch:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-m<span class="w"> </span>new-branch-name
</pre></div>
</div>
<p>Renaming a different branch:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-m<span class="w"> </span>different-branch<span class="w"> </span>new-branch-name
</pre></div>
</div>
</div></div>
</section>
<section id="creating-a-tag">
<h6 aria-level="7">(8) Creating a tag<a class="headerlink" href="#creating-a-tag" title="Link to this heading"></a></h6>
<p>Tags are a way to mark a specific commit as important, for example a release
version. They are also like a sticky note, but they don’t move when new
commits are added.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-7-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-7-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-7-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-7-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-7-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>On the right side, below “Releases”, click on “Create a new release”.</p>
<p>What GitHub calls releases are actually tags in Git with additional metadata.
For the purpose of this exercise we can use them interchangeably.</p>
</div><div aria-labelledby="tab-7-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-7-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>Version control sidebar → Three dots (same as in step 2) → Tags → Create tag.  Make sure you are on the expected commit before you do this.</p>
</div><div aria-labelledby="tab-7-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-7-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>Creating a tag:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>tag<span class="w"> </span>-a<span class="w"> </span>v1.0<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;New manuscript version for the pre-print&quot;</span>
</pre></div>
</div>
</div></div>
</section>
</section>
<section id="summary">
<h6>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h6>
<p>In this part, we saw how we can make changes to our files.  With branches, we
can track several lines of work at once, and can compare their differences.</p>
<ul class="simple">
<li><p>You could commit directly to <code class="docutils literal notranslate"><span class="pre">main</span></code> if there is only one single line
of work and it’s only you.</p></li>
<li><p>You could commit to branches if there are multiple lines of work at
once, and you don’t want them to interfere with each other.</p></li>
<li><p>Tags are useful to mark a specific commit as important, for example a
release version.</p></li>
<li><p>In Git, commits form a so-called “graph”. Branches are tags in Git function
like sticky notes that stick to specific commits. What this means for us is
that it does not cost any significant disk space to create new branches.</p></li>
<li><p>Not all files should be added to Git. For example, temporary files or
files with sensitive information or files which are generated as part of
the build process should not be added to Git. For this we use
<code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> (more about this later: <a class="reference internal" href="index.html#practical-advice"><span class="std std-ref">Practical advice: How much Git is necessary?</span></a>).</p></li>
<li><p>Unsure on which branch you are or what state the repository is in?
On the command line, use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> frequently to get a quick overview.</p></li>
</ul>
</section>
</section>
<span id="document-version-control/merging"></span><section id="merging-changes-and-contributing-to-the-project">
<span id="merging"></span><h5>Merging changes and contributing to the project<a class="headerlink" href="#merging-changes-and-contributing-to-the-project" title="Link to this heading"></a></h5>
<p>Git allows us to have different development lines where we can try things out.
It also allows different people to work on the same project at the same.  This
means that we have to somehow combine the changes later. In this part we will
practice this: <strong>merging</strong>.</p>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Understand that on GitHub merging is done through a <strong>pull request</strong> (on GitLab: “merge request”). Think
of it as a <strong>change proposal</strong>.</p></li>
<li><p>Create and merge a pull request within your own repository.</p></li>
<li><p>Understand (and optionally) do the same across repositories, to contribute to
the upstream public repository.</p></li>
</ul>
</div>
<section id="exercise">
<h6>Exercise<a class="headerlink" href="#exercise" title="Link to this heading"></a></h6>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/merging.png"><img alt="Illustration of what we want to achieve in this exercise" src="_images/merging.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-text">Illustration of what we want to achieve in this exercise.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-exercise-merging-branches exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Merging branches</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-0-TG9jYWwgKFZTIENvZGUsIENvbW1hbmQgbGluZSk=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-TG9jYWwgKFZTIENvZGUsIENvbW1hbmQgbGluZSk=" name="TG9jYWwgKFZTIENvZGUsIENvbW1hbmQgbGluZSk=" role="tab" tabindex="-1">Local (VS Code, Command line)</button></div><div aria-labelledby="tab-0-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-0-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>First, we make something called a pull request, which allows
review and commenting before the actual merge.</p>
<p>We assume that in the previous exercise you have created a new branch with one
or few new commits.  We provide basic hints. You should refer to the solution
as needed.</p>
<ol class="arabic simple">
<li><p>Navigate to your branch from the previous episode
(hint: the same branch view we used last time).</p></li>
<li><p>Begin the pull request process
(hint: There is a “Contribute” button in the branch view).</p></li>
<li><p>Add or modify the pull request title and description, and verify the other data.
In the pull request verify the target repository and the target
branch. Make sure that you are merging within your own repository.
<strong>GitHub: By default, it will offer to make the change to the
upstream repository, <code class="docutils literal notranslate"><span class="pre">workshop-material</span></code>.  You should change this</strong>, you
shouldn’t contribute your commit(s) upstream yet.  Where it says
<code class="docutils literal notranslate"><span class="pre">base</span> <span class="pre">repository</span></code>, select your own repository.</p></li>
<li><p>Create the pull request by clicking “Create pull request”. Browse
the network view to see if anything has changed yet.</p></li>
<li><p>Merge the pull request, or if you are not on GitHub you can merge
the branch locally. Browse the network again. What has changed?</p></li>
<li><p>Find out which branches are merged and thus safe to delete. Then remove them
and verify that the commits are still there, only the branch labels are
gone (hint: you can delete branches that have been merged into <code class="docutils literal notranslate"><span class="pre">main</span></code>).</p></li>
<li><p>Optional: Try to create a new branch with a new change, then open a pull
request but towards the original (upstream) repository. We will later merge few of
those.</p></li>
</ol>
</div><div aria-labelledby="tab-0-TG9jYWwgKFZTIENvZGUsIENvbW1hbmQgbGluZSk=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-TG9jYWwgKFZTIENvZGUsIENvbW1hbmQgbGluZSk=" name="TG9jYWwgKFZTIENvZGUsIENvbW1hbmQgbGluZSk=" role="tabpanel" tabindex="0"><p>When working locally, it’s easier to merge branches: we can just do
the merge, without making a pull request.  But we don’t have that step
of review and commenting and possibly adjusting.</p>
<ol class="arabic simple">
<li><p>Switch to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch that you want to merge the <em>other</em>
branch into. (Note that this is the other way around from the
GitHub path).</p></li>
</ol>
<p>Then:</p>
<ol class="arabic simple" start="5">
<li><p>Merge the other branch into <code class="docutils literal notranslate"><span class="pre">main</span></code> (which is then your current branch).</p></li>
<li><p>Find out which branches are merged and thus safe to delete. Then remove them
and verify that the commits are still there, only the branch labels are
gone. (Hint: you can delete branches that have been merged into <code class="docutils literal notranslate"><span class="pre">main</span></code>).</p></li>
<li><p>Optional: Try to create a new branch, and make a
GitHub pull request with your change, and contribute it to our
upstream repository.</p></li>
</ol>
</div></div>
</div>
<p>The solution below goes over most of the answers, and you are
encouraged to use it when the hints aren’t enough - this is by design.</p>
</section>
<section id="solution-and-walk-through">
<h6>Solution and walk-through<a class="headerlink" href="#solution-and-walk-through" title="Link to this heading"></a></h6>
<section id="navigate-to-your-branch">
<h6 aria-level="7">(1) Navigate to your branch<a class="headerlink" href="#navigate-to-your-branch" title="Link to this heading"></a></h6>
<p>Before making the pull request, or doing a merge, it’s important to
make sure that you are on the right branch.  Many people have been
frustrated because they forgot this!</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-1-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-1-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-1-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-1-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>GitHub will notice a recently changed branch and offer to make a pull request (clicking there will bring you to step 3):</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/github-compare-and-pr.png"><img alt="Screenshot on GitHub suggesting to compare and make a pull request." class="with-border" src="_images/github-compare-and-pr.png" style="width: 80%;" /></a>
</figure>
<p>If the yellow box is not there, make sure you are on the branch you want to
merge <strong>from</strong>:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/github-navigate-to-branch.png"><img alt="Screenshot on GitHub where we navigate to the branch we wish to merge." class="with-border" src="_images/github-navigate-to-branch.png" style="width: 80%;" /></a>
</figure>
</div><div aria-labelledby="tab-1-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>Remember, you need to switch to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch, the branch we want to merge <strong>to</strong>.
This is different from the GitHub path.</p>
</div><div aria-labelledby="tab-1-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>Remember, you need to switch to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch, the branch we want to merge <strong>to</strong>.
This is different from the GitHub path:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>main
</pre></div>
</div>
</div></div>
</section>
<section id="begin-the-pull-request-process">
<span id="create-pull-request"></span><h6 aria-level="7">(2) Begin the pull request process<a class="headerlink" href="#begin-the-pull-request-process" title="Link to this heading"></a></h6>
<p>In GitHub, the pull request is the way we propose to merge two
branches together.  We start the process of making one.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-2-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-2-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-2-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-2-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/github-contribute.png"><img alt="Screenshot on GitHub where we get to the pull request process." class="with-border" src="_images/github-contribute.png" style="width: 80%;" /></a>
</figure>
</div><div aria-labelledby="tab-2-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>It is possible to open pull requests from the editor, but
we don’t cover that here.</p>
<p>If you are working locally, continue to step 5.</p>
</div><div aria-labelledby="tab-2-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>It is possible to open pull requests from the command line, but
we don’t cover that here.</p>
<p>If you are working locally, continue to step 5.</p>
</div></div>
</section>
<section id="fill-out-and-verify-the-pull-request">
<h6 aria-level="7">(3) Fill out and verify the pull request<a class="headerlink" href="#fill-out-and-verify-the-pull-request" title="Link to this heading"></a></h6>
<p>Check that the pull request is directed to the right repository and branch
and that it contains the changes that you meant to merge.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-3-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-3-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-3-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-3-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>Things to check:</p>
<ul>
<li><p>Base repository: this should be your own</p></li>
<li><p>Title: make it descriptive</p></li>
<li><p>Description: make it informative</p></li>
<li><p>Scroll down to see commits: are these the ones you want to merge?</p></li>
<li><p>Scroll down to see the changes: are these the ones you want to merge?</p>
<figure class="align-default" id="id2">
<a class="with-border reference internal image-reference" href="_images/github-comparing-changes.png"><img alt="Screenshot on GitHub where we verify the changes we want to merge." class="with-border" src="_images/github-comparing-changes.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-text">This screenshot only shows the top part. If you scroll down, you
can see the commits and the changes. We recommend to do this before
clicking on “Create pull request”.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
</li>
</ul>
</div><div aria-labelledby="tab-3-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>If you are working locally, continue to step 5.</p>
</div><div aria-labelledby="tab-3-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>If you are working locally, continue to step 5.</p>
</div></div>
</section>
<section id="create-the-pull-request">
<h6 aria-level="7">(4) Create the pull request<a class="headerlink" href="#create-the-pull-request" title="Link to this heading"></a></h6>
<p>We actually create the pull request.  Don’t forget to navigate to the Network
view after opening the pull request.  Note that the changes proposed in the
pull request are not yet merged.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-4-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-4-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-4-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-4-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>Click on the green button “Create pull request”.</p>
<p>If you click on the little arrow next to “Create pull request”, you can also
see the option to “Create draft pull request”. This will be interesting later
when collaborating with others. It allows you to open a pull request that is
not ready to be merged yet, but you want to show it to others and get feedback.</p>
</div><div aria-labelledby="tab-4-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>It is possible to create pull requests from the editor, but
we don’t cover that here.</p>
<p>If you are working locally, continue to step 5.</p>
</div><div aria-labelledby="tab-4-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>It is possible to create pull requests from the command line, but
we don’t cover that here.</p>
<p>If you are working locally, continue to step 5.</p>
</div></div>
</section>
<section id="merge-the-pull-request">
<h6 aria-level="7">(5) Merge the pull request<a class="headerlink" href="#merge-the-pull-request" title="Link to this heading"></a></h6>
<p>Now, we do the actual merging. We see some effects now.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-5-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-5-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-5-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-5-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>Review it again (commits and changes), and then click “Merge pull request”.</p>
<p>After merging, verify the network view. Also navigate then to your “main”
branch and check that your change is there.</p>
</div><div aria-labelledby="tab-5-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>Just like with the command line, when we merge we modify our <em>current</em> branch.  Verify you are on the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p>
<ol class="arabic simple">
<li><p>Verify current branch at the bottom.</p></li>
<li><p>From the version control sidebar → Three dots → Branch → Merge.</p></li>
<li><p>In the selector that comes up, choose the branch you want to merge <em>from</em>.
The commits on that branch will be added to the current branch.</p></li>
</ol>
</div><div aria-labelledby="tab-5-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>On the command line, when we merge, we always modify our <em>current</em> branch.</p>
<p>If you are not sure anymore what your current branch is, type:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch
</pre></div>
</div>
<p>… or equally useful to see where we are right now:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>status
</pre></div>
</div>
<p>In this case we merge the <code class="docutils literal notranslate"><span class="pre">new-tutorial</span></code> branch into our current branch:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>new-tutorial
</pre></div>
</div>
</div></div>
</section>
<section id="delete-merged-branches">
<h6 aria-level="7">(6) Delete merged branches<a class="headerlink" href="#delete-merged-branches" title="Link to this heading"></a></h6>
<p>Before deleting branches, first check whether they are merged.</p>
<p>If you delete an un-merged branch, it will be difficult to find the commits
that were on that branch. If you delete a merged branch, the commits are now
also part of the branch where we have merged to.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-6-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-6-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-6-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-6-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-6-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>One way to delete the branch is to click on the “Delete branch” button after the pull
request is merged:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/github-merged.png"><img alt="Screenshot on GitHub suggesting us to delete a branch after it has been merged." class="with-border" src="_images/github-merged.png" style="width: 80%;" /></a>
</figure>
<p>But what if we forgot? Then navigate to the branch view:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/github-branches.png"><img alt="Screenshot on GitHub where we navigate to the branches view." class="with-border" src="_images/github-branches.png" style="width: 80%;" /></a>
</figure>
<p>In the overview we can see that it has been merged and we can delete it.</p>
</div><div aria-labelledby="tab-6-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>From the Source Control sidebar → the three dots (as before) → Branch → Delete Branch.  Select the branch name to delete.</p>
</div><div aria-labelledby="tab-6-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>Verify which branches are merged to the current branch:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>--merged

<span class="go">* main</span>
<span class="go">  new-tutorial</span>
</pre></div>
</div>
<p>This means that it is safe to delete the <code class="docutils literal notranslate"><span class="pre">new-tutorial</span></code> branch:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-d<span class="w"> </span>new-tutorial
</pre></div>
</div>
<p>Verify then that the branch is gone but that the commits are still there:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch
<span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--oneline
</pre></div>
</div>
</div></div>
</section>
<section id="contribute-to-the-original-repository-with-a-pull-request">
<h6 aria-level="7">(7) Contribute to the original repository with a pull request<a class="headerlink" href="#contribute-to-the-original-repository-with-a-pull-request" title="Link to this heading"></a></h6>
<p>This is an advanced step. We will practice this tomorrow and
it is OK to skip this at this stage.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-R2l0SHVi" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-7-R2l0SHVi" name="R2l0SHVi" role="tab" tabindex="0">GitHub</button><button aria-controls="panel-7-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-7-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-7-R2l0SHVi" class="sphinx-tabs-panel group-tab" id="panel-7-R2l0SHVi" name="R2l0SHVi" role="tabpanel" tabindex="0"><p>Now that you know how to create branches and opening a pull request, try to
open a new pull request with a new change but this time the base repository
should be the upstream one.</p>
<p>In other words, you now send a pull request <strong>across repositories</strong>: from your fork
to the original repository.</p>
<p>Another thing that is different now is that you might not have permissions to
merge the pull request.  We can then together review and browse the pull
request.</p>
</div><div aria-labelledby="tab-7-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-7-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>Not described. We will return to this when we discuss collaboration using GitHub.</p>
<p>You would create a new branch locally like above, push it to GitHub to your own
user’s repository, and from there open a pull request towards the upstream
repository.</p>
</div><div aria-labelledby="tab-7-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-7-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>Not described. We will return to this when we discuss collaboration using GitHub.</p>
<p>You would create a new branch locally like above, push it to GitHub to your own
user’s repository, and from there open a pull request towards the upstream
repository.</p>
</div></div>
</section>
</section>
<section id="summary">
<h6>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>We learned how to merge two branches together.</p></li>
<li><p>When is this useful? This is not only useful to combine development lines in
your own work. Being able to merge branches also <strong>forms the basis for collaboration</strong>.</p></li>
<li><p>Branches which are merged to other branches are safe to delete, since we only
delete the “sticky note” next to a commit, not the commits themselves.</p></li>
</ul>
</section>
</section>
<span id="document-version-control/conflict-resolution"></span><section id="conflict-resolution">
<span id="id1"></span><h5>Conflict resolution<a class="headerlink" href="#conflict-resolution" title="Link to this heading"></a></h5>
<section id="resolving-a-conflict-demonstration">
<h6>Resolving a conflict (demonstration)<a class="headerlink" href="#resolving-a-conflict-demonstration" title="Link to this heading"></a></h6>
<p>A conflict is when Git asks humans to decide during a merge which of two
changes to keep <strong>if the same portion of a file has been changed in two
different ways on two different branches</strong>.</p>
<p>We will practice conflict resolution in the collaborative Git lesson (next
day).</p>
<p>Here we will only demonstrate how to create a conflict and how to resolve it,
<strong>all on GitHub</strong>. Once we understand how this works, we will be more confident
to resolve conflicts also in the <strong>command line</strong> (we can demonstrate this if
we have time).</p>
<p>How to create a conflict (please try this in your own time <em>and just watch now</em>):</p>
<ul class="simple">
<li><p>Create a new branch from <code class="docutils literal notranslate"><span class="pre">main</span></code> and on it make a change to a file.</p></li>
<li><p>On <code class="docutils literal notranslate"><span class="pre">main</span></code>, make a different change to the same part of the same file.</p></li>
<li><p>Now try to merge the new branch to <code class="docutils literal notranslate"><span class="pre">main</span></code>. You will get a conflict.</p></li>
</ul>
<p>How to resolve conflicts:</p>
<ul class="simple">
<li><p>On GitHub, you can resolve conflicts by clicking on the “Resolve conflicts”
button. This will open a text editor where you can choose which changes to
keep.
Make sure to remove the conflict markers.
After resolving the conflict, you can commit the changes and merge the
pull request.</p></li>
<li><p>Sometimes a conflict is between your change and somebody else’s change. In
that case, you might have to discuss with the other person which changes to
keep.</p></li>
</ul>
</section>
<section id="avoiding-conflicts">
<h6>Avoiding conflicts<a class="headerlink" href="#avoiding-conflicts" title="Link to this heading"></a></h6>
<div class="admonition-the-human-side-of-conflicts discussion important admonition" id="discussion-0">
<p class="admonition-title">The human side of conflicts</p>
<ul class="simple">
<li><p>What does it mean if two people do the same thing in two different ways?</p></li>
<li><p>What if you work on the same file but do two different things in the different sections?</p></li>
<li><p>What if you do something, don’t tell someone from 6 months, and then try to combine it with other people’s work?</p></li>
<li><p>How are conflicts avoided in other work? (Only one person working at once?
Declaring what you are doing before you start, if there is any chance someone
else might do the same thing, helps.)</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Human measures</p>
<ul>
<li><p>Think and plan to which branch you will commit to.</p></li>
<li><p>Do not put unrelated changes on the same branch.</p></li>
</ul>
</li>
<li><p>Collaboration measures</p>
<ul>
<li><p>Open an issue and discuss with collaborators before starting a long-living
branch.</p></li>
</ul>
</li>
<li><p>Project layout measures</p>
<ul>
<li><p>Modifying global data often causes conflicts.</p></li>
<li><p>Modular programming reduces this risk.</p></li>
</ul>
</li>
<li><p>Technical measures</p>
<ul>
<li><p><strong>Share your changes early and often</strong>: This is one of the happy,
rare circumstances when everyone doing the selfish thing (publishing your
changes as early as practical) results in best case for everyone!</p></li>
<li><p>Pull/rebase often to keep up to date with upstream.</p></li>
<li><p>Resolve conflicts early.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<span id="document-version-control/practical-advice"></span><section id="practical-advice-how-much-git-is-necessary">
<span id="practical-advice"></span><h5>Practical advice: How much Git is necessary?<a class="headerlink" href="#practical-advice-how-much-git-is-necessary" title="Link to this heading"></a></h5>
<section id="writing-useful-commit-messages">
<h6>Writing useful commit messages<a class="headerlink" href="#writing-useful-commit-messages" title="Link to this heading"></a></h6>
<p>Useful commit messages <strong>summarize the change and provide context</strong>.</p>
<p>If you need a commit message that is longer than one line,
then the convention is: one line summarizing the commit, then one empty line,
then paragraph(s) with more details in free form, if necessary.</p>
<p>Good example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="hll">increase alpha to 2.0 for faster convergence
</span>
the motivation for this change is
to enable ...
...
(more context)
...
this is based on a discussion in #123
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Why something was changed is more important than what has changed.</strong></p></li>
<li><p>Cross-reference to issues and discussions if possible/relevant.</p></li>
<li><p>Bad commit messages: “fix”, “oops”, “save work”</p></li>
<li><p>Bad examples: <a class="reference external" href="http://whatthecommit.com">http://whatthecommit.com</a></p></li>
<li><p>Write commit messages that will be understood
15 years from now by someone else than you. Or by your future you.</p></li>
<li><p>Many projects start out as projects “just for me” and end up to be successful projects
that are developed by 50 people over decades.</p></li>
<li><p><a class="reference external" href="https://help.github.com/articles/creating-a-commit-with-multiple-authors/">Commits with multiple authors</a> are possible.</p></li>
</ul>
<p>Good references:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://fatbusinessman.com/2019/my-favourite-git-commit">“My favourite Git commit”</a></p></li>
<li><p><a class="reference external" href="https://who-t.blogspot.com/2009/12/on-commit-messages.html">“On commit messages”</a></p></li>
<li><p><a class="reference external" href="https://chris.beams.io/posts/git-commit/">“How to Write a Git Commit Message”</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A great way to learn how to write commit messages and to get inspired by their
style choices: <strong>browse repositories of codes that you use/like</strong>:</p>
<p>Some examples (but there are so many good examples):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/scipy/scipy/commits/main">SciPy</a></p></li>
<li><p><a class="reference external" href="https://github.com/numpy/numpy/commits/main">NumPy</a></p></li>
<li><p><a class="reference external" href="https://github.com/pandas-dev/pandas/commits/main">Pandas</a></p></li>
<li><p><a class="reference external" href="https://github.com/JuliaLang/julia/commits/master">Julia</a></p></li>
<li><p><a class="reference external" href="https://github.com/tidyverse/ggplot2/commits/main">ggplot2</a>,
compare with their <a class="reference external" href="https://github.com/tidyverse/ggplot2/releases">release
notes</a></p></li>
<li><p><a class="reference external" href="https://github.com/pallets/flask/commits/main">Flask</a>,
compare with their <a class="reference external" href="https://github.com/pallets/flask/blob/main/CHANGES.rst">release
notes</a></p></li>
</ul>
<p>When designing commit message styles consider also these:</p>
<ul class="simple">
<li><p>How will you easily generate a changelog or release notes?</p></li>
<li><p>During code review, you can help each other improving commit messages.</p></li>
</ul>
</div>
<p>But remember: it is better to make any commit, than no commit. Especially in small projects.
<strong>Let not the perfect be the enemy of the good enough</strong>.</p>
</section>
<section id="what-level-of-branching-complexity-is-necessary-for-each-project">
<h6>What level of branching complexity is necessary for each project?<a class="headerlink" href="#what-level-of-branching-complexity-is-necessary-for-each-project" title="Link to this heading"></a></h6>
<p><strong>Simple personal projects</strong>:</p>
<ul class="simple">
<li><p>Typically start with just the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p></li>
<li><p>Use branches for unfinished/untested ideas.</p></li>
<li><p>Use branches when you are not sure about a change.</p></li>
<li><p>Use tags to mark important milestones.</p></li>
<li><p>If you are unsure what to do with unfinished and not working code, commit it
to a branch.</p></li>
</ul>
<p><strong>Projects with few persons: you accept things breaking sometimes</strong></p>
<ul class="simple">
<li><p>It might be reasonable to commit to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch and feature branches.</p></li>
</ul>
<p><strong>Projects with few persons: changes are reviewed by others</strong></p>
<ul class="simple">
<li><p>You create new feature branches for changes.</p></li>
<li><p>Changes are reviewed before they are merged to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p></li>
<li><p>Consider to write-protect the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch so that it can only be changed
with pull requests or merge requests.</p></li>
</ul>
</section>
<section id="how-large-should-a-commit-be">
<h6>How large should a commit be?<a class="headerlink" href="#how-large-should-a-commit-be" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Better too small than too large (easier to combine than to split).</p></li>
<li><p>Often I make a commit at the end of the day (this is a unit I would not like to lose).</p></li>
<li><p>Smaller sized commits may be easier to review for others than huge commits.</p></li>
<li><p>A commit should not contain unrelated changes to simplify review and possible
repair/adjustments/undo later (but again: imperfect commits are better than no commits).</p></li>
<li><p>Imperfect commits are better than no commits.</p></li>
</ul>
</section>
<section id="working-on-the-command-line-use-git-status-all-the-time">
<h6>Working on the command line? Use “git status” all the time<a class="headerlink" href="#working-on-the-command-line-use-git-status-all-the-time" title="Link to this heading"></a></h6>
<p>The <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> command is one of the most useful commands in Git
to inform about which branch we are on, what we are about to commit,
which files might not be tracked, etc.</p>
</section>
<section id="how-about-staging-and-committing">
<h6>How about staging and committing?<a class="headerlink" href="#how-about-staging-and-committing" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Commit early and often: rather create too many commits than too few.
You can always combine commits later.</p></li>
<li><p>Once you commit, it is very, very hard to really lose your code.</p></li>
<li><p>Always fully commit (or stash) before you do dangerous things, so that you know you are safe.
Otherwise it can be hard to recover.</p></li>
<li><p>Later you can start using the staging area (where you first stage and then commit in a second step).</p></li>
<li><p>Later start using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">-p</span></code> and/or <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-p</span></code>.</p></li>
</ul>
</section>
<section id="what-to-avoid">
<h6>What to avoid<a class="headerlink" href="#what-to-avoid" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Committing <strong>generated files/directories</strong> (example: <code class="docutils literal notranslate"><span class="pre">__pycache__</span></code>, <code class="docutils literal notranslate"><span class="pre">*.pyc</span></code>) -&gt;
use <a class="reference external" href="https://docs.github.com/en/get-started/getting-started-with-git/ignoring-files">.gitignore
files</a>
(<a class="reference external" href="https://github.com/github/gitignore">collection of .gitignore templates</a>).</p></li>
<li><p>Committing <strong>huge files</strong> -&gt; use code review to detect this.</p></li>
<li><p>Committing <strong>unrelated changes</strong> together.</p></li>
<li><p>Postponing commits because the changes are “unfinished”/”ugly” -&gt; better ugly
commits than no commits.</p></li>
<li><p>When working with branches:</p>
<ul>
<li><p>Working on unrelated things on the same branch.</p></li>
<li><p>Not updating your branch before starting new work.</p></li>
<li><p>Too ambitious branch which risks to never get completed.</p></li>
<li><p>Over-engineering the branch layout and safeguards in small projects -&gt; can turn people away from your project.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<span id="document-version-control/sharing"></span><section id="optional-how-to-turn-your-project-to-a-git-repo-and-share-it">
<span id="sharing-repositories"></span><h5>Optional: How to turn your project to a Git repo and share it<a class="headerlink" href="#optional-how-to-turn-your-project-to-a-git-repo-and-share-it" title="Link to this heading"></a></h5>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Turn our own coding project (small or large, finished or unfinished) into a
Git repository.</p></li>
<li><p>Be able to share a repository on the web to have a backup or so that others
can reuse and collaborate or even just find it.</p></li>
</ul>
</div>
<section id="exercise">
<h6>Exercise<a class="headerlink" href="#exercise" title="Link to this heading"></a></h6>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="_images/sharing.png"><img alt="Illustration of how we turn a project into a Git repository and share it" src="_images/sharing.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">From a bunch of files to a local repository which we then share on GitHub.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-exercise-turn-your-project-to-a-git-repo-and-share-it-20-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Turn your project to a Git repo and share it (20 min)</p>
<ol class="arabic simple">
<li><p>Create a new directory called <strong>myproject</strong> (or a different name) with one or few files in it.
This represents our own project. It is not yet a Git repository. You can try
that with your own project or use a simple placeholder example.</p></li>
<li><p>Turn this new directory into a Git repository.</p></li>
<li><p>Share this repository on GitHub (or GitLab, since it really works the same).</p></li>
</ol>
<p>We offer <strong>three different paths</strong> of how to do this exercise.</p>
<ul class="simple">
<li><p>Via <strong>GitHub web interface</strong>: easy and can be a good starting point if you are completely
new to Git.</p></li>
<li><p><strong>VS Code</strong> is quite easy, since VS Code can offer to create the
GitHub repositories for you.</p></li>
<li><p><strong>Command line</strong>: you need to create the
repository on GitHub and link it yourself.</p></li>
</ul>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-T25seSB1c2luZyBHaXRIdWI=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-T25seSB1c2luZyBHaXRIdWI=" name="T25seSB1c2luZyBHaXRIdWI=" role="tab" tabindex="0">Only using GitHub</button><button aria-controls="panel-0-VlMgQ29kZQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="-1">VS Code</button><button aria-controls="panel-0-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button><button aria-controls="panel-0-UlN0dWRpbw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-UlN0dWRpbw==" name="UlN0dWRpbw==" role="tab" tabindex="-1">RStudio</button></div><div aria-labelledby="tab-0-T25seSB1c2luZyBHaXRIdWI=" class="sphinx-tabs-panel group-tab" id="panel-0-T25seSB1c2luZyBHaXRIdWI=" name="T25seSB1c2luZyBHaXRIdWI=" role="tabpanel" tabindex="0"><p class="rubric" id="create-an-repository-on-github">Create an repository on GitHub</p>
<p>First log into GitHub, then follow the screenshots and descriptions below.</p>
<figure class="align-default" id="id6">
<a class="with-border reference internal image-reference" href="_images/new-repository.png"><img alt="Screenshot on GitHub before a new repository form is opened" class="with-border" src="_images/new-repository.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-text">Click on the “plus” symbol on top right, then on “New repository”.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Then:</p>
<figure class="align-default" id="id7">
<a class="with-border reference internal image-reference" href="_images/create-repository-with-readme.png"><img alt="Screenshot on GitHub just before a new repository is created" class="with-border" src="_images/create-repository-with-readme.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Choose a repository name, add a short description, and in this case <strong>make sure to check</strong> “Add a
README file”. Finally “Create repository”.</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<p class="rubric" id="upload-your-files">Upload your files</p>
<p>Now that the repository is created, you can upload your files:</p>
<figure class="align-default" id="id8">
<a class="with-border reference internal image-reference" href="_images/upload-files.png"><img alt="Screenshot on GitHub just before uploading files" class="with-border" src="_images/upload-files.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Click on the “+” symbol and then on “Upload files”.</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
</div><div aria-labelledby="tab-0-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>In VS Code it only takes few clicks.</p>
<p>First, open the folder in VS Code. My example project here contains two files.
Then click on the source control icon:</p>
<figure class="align-default" id="id9">
<a class="with-border reference internal image-reference" href="_images/vscode-start.png"><img alt="Screenshot of VS Code before clicking on the source control icon" class="with-border" src="_images/vscode-start.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Open the folder in VS Code. Then click on the source control icon.</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id10">
<a class="with-border reference internal image-reference" href="_images/vscode-publish-to-github1.png"><img alt="Screenshot of VS Code before publishing to GitHub" class="with-border" src="_images/vscode-publish-to-github1.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Choose “Publish to GitHub”. In this case I never even clicked on “Initialize Repository”.</span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id11">
<a class="with-border reference internal image-reference" href="_images/vscode-publish-to-github2.png"><img alt="Screenshot of VS Code before publishing to GitHub" class="with-border" src="_images/vscode-publish-to-github2.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">In my case I chose to “Publish to GitHub public repository”. Here you can also rename
the repository if needed.</span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id12">
<a class="with-border reference internal image-reference" href="_images/vscode-authorize.png"><img alt="Screenshot of VS Code asking for authorization" class="with-border" src="_images/vscode-authorize.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-text">First time you do this you might need to authorize VS Code to access your
GitHub account by redirecting you to https://github.com/login/oauth/authorize.</span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id13">
<a class="with-border reference internal image-reference" href="_images/vscode-publish-to-github3.png"><img alt="Screenshot of VS Code after publishing to GitHub" class="with-border" src="_images/vscode-publish-to-github3.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">After it is published, click on “Open on GitHub”.</span><a class="headerlink" href="#id13" title="Link to this image"></a></p>
</figcaption>
</figure>
</div><div aria-labelledby="tab-0-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p class="rubric" id="put-your-project-under-version-control">Put your project under version control</p>
<p>My example project here consists of two files. Replace this with your own
example files:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls<span class="w"> </span>-l

<span class="go">.rw------- 19k user  7 Mar 17:36 LICENSE</span>
<span class="go">.rw-------  21 user  7 Mar 17:36 myscript.py</span>
</pre></div>
</div>
<p>I will first initialize a Git repository in this directory.
If you get an error, try without the <code class="docutils literal notranslate"><span class="pre">-b</span> <span class="pre">main</span></code> (and your default branch will
then be called <code class="docutils literal notranslate"><span class="pre">master</span></code>, this will happen for Git versions older than
2.28):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>init<span class="w"> </span>-b<span class="w"> </span>main
</pre></div>
</div>
<p>Now add and commit the two files to the Git repository:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>LICENSE<span class="w"> </span>myscript.py
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;putting my project under version control&quot;</span>
</pre></div>
</div>
<p>If you want to add all files in one go, you can use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">.</span></code> instead of <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">LICENSE</span> <span class="pre">myscript.py</span></code>.</p>
<p>Now you have a Git repository with one commit. Verify this with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code>.
But it’s still only on your computer. Let’s put it on GitHub next.</p>
<p class="rubric" id="create-an-empty-repository-on-github">Create an <u>empty</u> repository on GitHub</p>
<p>First log into GitHub, then follow the screenshots and descriptions below.</p>
<figure class="align-default" id="id14">
<a class="with-border reference internal image-reference" href="_images/new-repository.png"><img alt="Screenshot on GitHub before a new repository form is opened" class="with-border" src="_images/new-repository.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-text">Click on the “plus” symbol on top right, then on “New repository”.</span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Then create an empty repository without any files and without any commits:</p>
<figure class="align-default" id="id15">
<a class="with-border reference internal image-reference" href="_images/create-repository.png"><img alt="Screenshot on GitHub just before a new repository is created" class="with-border" src="_images/create-repository.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Choose a repository name, add a short description, but please <strong>do not check</strong> “Add a
README file”. For “Add .gitignore” and “Choose a license” also leave as “None”. Finally “Create repository”.</span><a class="headerlink" href="#id15" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Once you click the green “Create repository”, you will see a page similar to:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/bare-repository.png"><img alt="Screenshot on GitHub after a bare repository was created" class="with-border" src="_images/bare-repository.png" style="width: 100%;" /></a>
</figure>
<p>What this means is that we have now an empty project with either an HTTPS or an
SSH address: click on the HTTPS and SSH buttons to see what happens.</p>
<p class="rubric" id="push-an-existing-repository-from-your-computer-to-github">Push an existing repository from your computer to GitHub</p>
<p>We now want to follow the “<strong>… or push an existing repository from the command line</strong>”:</p>
<ol class="arabic simple">
<li><p>In your terminal make sure you are still in your myproject directory.</p></li>
<li><p>Copy paste the three lines below the red arrow to the terminal and execute
those, in my case (<strong>you need to replace the “USER” part and possibly also
the repository name</strong>):</p></li>
</ol>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-U1NI" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-U1NI" name="U1NI" role="tab" tabindex="0">SSH</button><button aria-controls="panel-1-SFRUUFM=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-SFRUUFM=" name="SFRUUFM=" role="tab" tabindex="-1">HTTPS</button></div><div aria-labelledby="tab-1-U1NI" class="sphinx-tabs-panel group-tab" id="panel-1-U1NI" name="U1NI" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span>git@github.com:USER/myproject.git
</pre></div>
</div>
</div><div aria-labelledby="tab-1-SFRUUFM=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-SFRUUFM=" name="SFRUUFM=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span>https://github.com/USER/myproject.git
</pre></div>
</div>
</div></div>
<p>Then:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-M<span class="w"> </span>main
<span class="gp">$ </span>git<span class="w"> </span>push<span class="w"> </span>-u<span class="w"> </span>origin<span class="w"> </span>main
</pre></div>
</div>
<p>The meaning of the above lines:</p>
<ul class="simple">
<li><p>Add a remote reference with the name “origin”</p></li>
<li><p>Rename current branch to “main”</p></li>
<li><p>Push branch “main” to “origin”</p></li>
</ul>
<p>You should now see:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Enumerating objects: 4, done.
Counting objects: 100% (4/4), done.
Delta compression using up to 12 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (4/4), 6.08 KiB | 6.08 MiB/s, done.
Total 4 (delta 0), reused 0 (delta 0), pack-reused 0
To github.com:USER/myproject.git
 * [new branch]      main -&gt; main
branch &#39;main&#39; set up to track &#39;origin/main&#39;.
</pre></div>
</div>
<p>Reload your GitHub project website and your commits should now be
online!</p>
<p class="rubric" id="troubleshooting">Troubleshooting</p>
<p><strong>error: remote origin already exists</strong></p>
<ul class="simple">
<li><p>Explanation: You probably ran a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span> <span class="pre">origin</span> <span class="pre">...</span></code> command, then changed your
mind about HTTPS or SSH and then tried to run the other <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span> <span class="pre">origin</span> <span class="pre">...</span></code> command but “origin” then already exists.</p></li>
<li><p>Recovery:</p>
<ul>
<li><p>First remove “origin” with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">remove</span> <span class="pre">origin</span></code></p></li>
<li><p>Then run the correct <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span> <span class="pre">origin</span> <span class="pre">...</span></code> command</p></li>
</ul>
</li>
</ul>
<p><strong>remote contains work that you do not have</strong></p>
<ul class="simple">
<li><p>Explanation: You probably clicked on “Add a README file” and now the
repository on GitHub is not empty but contains one commit and locally you
have a different history. Git now prevents you from accidentally overwriting
the history on GitHub.</p></li>
<li><p>Recovery:</p>
<ul>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">--force</span></code> instead of <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code>, which will force Git to overwrite the history on GitHub</p></li>
<li><p>Note that this is a powerful but also possibly dangerous option but here it
helps us. If it’s a brand new repo, it probably is fine to do this. For real
repositories, don’t do this unless you are very sure what is happening.</p></li>
</ul>
</li>
</ul>
</div><div aria-labelledby="tab-0-UlN0dWRpbw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-UlN0dWRpbw==" name="UlN0dWRpbw==" role="tabpanel" tabindex="0"><p>This is not fully explained, because a lot of it is similar to the “Command
line” method (and an RStudio expert could help us some).  The main differences
are:</p>
<p class="rubric" id="id1">Put your project under version control</p>
<ol class="arabic simple">
<li><p>Tools → Version control → Project setup → Version control system = Git.</p></li>
<li><p>Select “Yes” for “do you want to initialize a new git repository for this project.</p></li>
<li><p>Select yes to restart the project with RStudio.</p></li>
<li><p>Switch to branch <code class="docutils literal notranslate"><span class="pre">main</span></code> to have you branch named that.</p></li>
</ol>
<p class="rubric" id="id2">Create an <u>empty</u> repository on GitHub</p>
<p>Same as command line</p>
<p class="rubric" id="id3">Push an existing repository from your computer to GitHub</p>
<ol class="arabic simple">
<li><p>Under the “Create new branch” button → “Add Remote”</p></li>
<li><p>Remote name: <code class="docutils literal notranslate"><span class="pre">origin</span></code></p></li>
<li><p>Remote URL: as in command line (remember to select SSH or HTTPS as you have configured your RStudio)</p></li>
<li><p>The “Push” (up arrow) button will send changes on your current branch to the remote.  The “Pull” (down arrow) will get changes from the remote.</p></li>
</ol>
<p class="rubric" id="id4">Troubleshooting</p>
<p>Same as command line</p>
</div></div>
</div>
</section>
<section id="is-putting-software-on-github-gitlab-publishing">
<h6>Is putting software on GitHub/GitLab/… publishing?<a class="headerlink" href="#is-putting-software-on-github-gitlab-publishing" title="Link to this heading"></a></h6>
<p>It is a good first step but to make your code truly <strong>findable and
accessible</strong>, consider making your code <strong>citable and persistent</strong>: Get a
persistent identifier (PID) such as DOI in addition to sharing the code
publicly, by using services like <a class="reference external" href="https://zenodo.org">Zenodo</a> or similar
services.</p>
</section>
</section>
</div>
</section>
<span id="document-documentation"></span><section id="code-documentation">
<span id="documentation"></span><h4>Code documentation<a class="headerlink" href="#code-documentation" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Discuss what makes good documentation.</p></li>
<li><p>Improve the README of your project or our example project.</p></li>
<li><p>Explore Sphinx which is a popular tool to build documentation websites.</p></li>
<li><p>Learn how to leverage GitHub Actions and GitHub Pages to build and deploy documentation.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>(30 min) Discussion</p></li>
<li><p>(30 min) Exercise: Set up a Sphinx documentation and add API documentation</p></li>
<li><p>(15 min) Demo: Building documentation with GitHub Actions</p></li>
</ul>
</div>
<section id="why-to-your-future-self">
<h5>Why? 💗✉️ to your future self<a class="headerlink" href="#why-to-your-future-self" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>You will probably use your code in the future and may forget details.</p></li>
<li><p>You may want others to use your code or contribute
(almost impossible without documentation).</p></li>
</ul>
</section>
<section id="in-code-documentation">
<h5>In-code documentation<a class="headerlink" href="#in-code-documentation" title="Link to this heading"></a></h5>
<p>Not very useful (more commentary than comment):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># now we check if temperature is below -50</span>
<span class="k">if</span> <span class="n">temperature</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">50</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: temperature is too low&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>More useful (explaining <strong>why</strong>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we regard temperatures below -50 degrees as measurement errors</span>
<span class="k">if</span> <span class="n">temperature</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">50</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: temperature is too low&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Keeping zombie code “just in case” (rather use version control):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># do not run this code!</span>
<span class="c1"># if temperature &gt; 0:</span>
<span class="c1">#     print(&quot;It is warm&quot;)</span>
</pre></div>
</div>
<p>Emulating version control:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># John Doe: threshold changed from 0 to 15 on August 5, 2013</span>
<span class="k">if</span> <span class="n">temperature</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It is warm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="many-languages-allow-docstrings">
<h5>Many languages allow “docstrings”<a class="headerlink" href="#many-languages-allow-docstrings" title="Link to this heading"></a></h5>
<p>Example (Python):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kelvin_to_celsius</span><span class="p">(</span><span class="n">temp_k</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts temperature in Kelvin to Celsius.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    temp_k : float</span>
<span class="sd">        temperature in Kelvin</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    temp_c : float</span>
<span class="sd">        temperature in Celsius</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">temp_k</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ERROR: negative T_K&quot;</span>

    <span class="n">temp_c</span> <span class="o">=</span> <span class="n">temp_k</span> <span class="o">-</span> <span class="mf">273.15</span>

    <span class="k">return</span> <span class="n">temp_c</span>
</pre></div>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Documentation which is only in the source code is not enough.</p></li>
<li><p>Often a README is enough.</p></li>
<li><p>Documentation needs to be kept
<strong>in the same Git repository</strong> as the code since we want it to evolve with
the code.</p></li>
</ul>
</div>
</section>
<section id="often-a-readme-is-enough-checklist">
<h5>Often a README is enough - checklist<a class="headerlink" href="#often-a-readme-is-enough-checklist" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p><strong>Purpose</strong></p></li>
<li><p>Requirements</p></li>
<li><p>Installation instructions</p></li>
<li><p><strong>Copy-paste-able example to get started</strong></p></li>
<li><p>Tutorials covering key functionality</p></li>
<li><p>Reference documentation (e.g. API) covering all functionality</p></li>
<li><p>Authors and <strong>recommended citation</strong></p></li>
<li><p>License</p></li>
<li><p>Contribution guide</p></li>
</ul>
<p>See also the
<a class="reference external" href="https://joss.readthedocs.io/en/latest/review_checklist.html">JOSS review checklist</a>.</p>
</section>
<section id="diataxis">
<h5>Diátaxis<a class="headerlink" href="#diataxis" title="Link to this heading"></a></h5>
<p>Diátaxis is a systematic approach to technical documentation authoring.</p>
<ul class="simple">
<li><p>Overview: <a class="reference external" href="https://diataxis.fr/">https://diataxis.fr/</a></p></li>
<li><p>How to use Diátaxis <strong>as a guide</strong> to work: <a class="reference external" href="https://diataxis.fr/how-to-use-diataxis/">https://diataxis.fr/how-to-use-diataxis/</a></p></li>
</ul>
</section>
<section id="what-if-you-need-more-than-a-readme">
<h5>What if you need more than a README?<a class="headerlink" href="#what-if-you-need-more-than-a-readme" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Write documentation in
<a class="reference external" href="https://en.wikipedia.org/wiki/Markdown">Markdown (.md)</a>
or
<a class="reference external" href="https://en.wikipedia.org/wiki/ReStructuredText">reStructuredText (.rst)</a>
or
<a class="reference external" href="https://rmarkdown.rstudio.com/">R Markdown (.Rmd)</a></p></li>
<li><p>In the <strong>same repository</strong> as the code -&gt; version control and <strong>reproducibility</strong></p></li>
<li><p>Use one of many tools to build HTML out of md/rst/Rmd:
<a class="reference external" href="https://sphinx-doc.org">Sphinx</a>,
<a class="reference external" href="https://www.mkdocs.org/">MkDocs</a>,
<a class="reference external" href="https://www.getzola.org/">Zola</a>, <a class="reference external" href="https://jekyllrb.com/">Jekyll</a>,
<a class="reference external" href="https://gohugo.io/">Hugo</a>, RStudio, <a class="reference external" href="https://yihui.org/knitr/">knitr</a>,
<a class="reference external" href="https://bookdown.org/">bookdown</a>,
<a class="reference external" href="https://bookdown.org/yihui/blogdown/">blogdown</a>, …</p></li>
<li><p>Deploy the generated HTML to <a class="reference external" href="https://pages.github.com/">GitHub Pages</a> or
<a class="reference external" href="https://docs.gitlab.com/ee/user/project/pages/">GitLab Pages</a></p></li>
</ul>
</section>
<section id="exercise-set-up-a-sphinx-documentation">
<h5>Exercise: Set up a Sphinx documentation<a class="headerlink" href="#exercise-set-up-a-sphinx-documentation" title="Link to this heading"></a></h5>
<div class="admonition-preparation prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Preparation</p>
<p>In this episode we will use the following 5 packages which we installed
previously as part of the <a class="reference internal" href="index.html#conda"><span class="std std-ref">Conda environment</span></a> or <a class="reference internal" href="index.html#venv"><span class="std std-ref">Virtual environment</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myst</span><span class="o">-</span><span class="n">parser</span>
<span class="n">sphinx</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">rtd</span><span class="o">-</span><span class="n">theme</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autoapi</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autobuild</span>
</pre></div>
</div>
<p>Which repository to use? You have 3 options:</p>
<ul class="simple">
<li><p>Clone <strong>your fork</strong> of the planets example repository.</p></li>
<li><p>If you don’t have that, you can clone the original repository itself:
<a class="reference external" href="https://github.com/workshop-material/planets">https://github.com/workshop-material/planets</a></p></li>
<li><p>You can try this with <strong>your own project</strong> and the project does not have to
be a Python project.</p></li>
</ul>
</div>
<p>There are at least two ways to get started with Sphinx:</p>
<ol class="arabic simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">sphinx-quickstart</span></code> to create a new Sphinx project.</p></li>
<li><p><strong>This is what we will do instead</strong>: Create three files (<code class="docutils literal notranslate"><span class="pre">doc/conf.py</span></code>, <code class="docutils literal notranslate"><span class="pre">doc/index.md</span></code>, and <code class="docutils literal notranslate"><span class="pre">doc/about.md</span></code>)
as starting point and improve from there.</p></li>
</ol>
<div class="admonition-exercise-set-up-a-sphinx-documentation exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Set up a Sphinx documentation</p>
<ol class="arabic">
<li><p>Create the following three files in your project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>planets/      &lt;- or your own project
├── doc/
│   ├── conf.py
│   ├── index.md
│   └── about.md
└── ...
</pre></div>
</div>
<p>This is <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">project</span> <span class="o">=</span> <span class="s2">&quot;planets&quot;</span>
<span class="n">copyright</span> <span class="o">=</span> <span class="s2">&quot;2024, Authors&quot;</span>
<span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;Authors&quot;</span>
<span class="n">release</span> <span class="o">=</span> <span class="s2">&quot;0.1&quot;</span>

<span class="n">exclude_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_build&quot;</span><span class="p">,</span> <span class="s2">&quot;Thumbs.db&quot;</span><span class="p">,</span> <span class="s2">&quot;.DS_Store&quot;</span><span class="p">]</span>

<span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;myst_parser&quot;</span><span class="p">,</span>  <span class="c1"># in order to use markdown</span>
<span class="p">]</span>

<span class="n">myst_enable_extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;colon_fence&quot;</span><span class="p">,</span>  <span class="c1"># ::: can be used instead of ``` for better rendering</span>
<span class="p">]</span>

<span class="n">html_theme</span> <span class="o">=</span> <span class="s2">&quot;sphinx_rtd_theme&quot;</span>
</pre></div>
</div>
<p>This is <code class="docutils literal notranslate"><span class="pre">index.md</span></code> (feel free to change the example text):</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># Our code documentation</span>

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
culpa qui officia deserunt mollit anim id est laborum.

:::{toctree}
:maxdepth: 2
:caption: Some caption

about.md
:::
</pre></div>
</div>
<p>This is <code class="docutils literal notranslate"><span class="pre">about.md</span></code> (feel free to adjust):</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># About this code</span>

Work in progress ...
</pre></div>
</div>
</li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> to build the HTML documentation:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sphinx-build<span class="w"> </span>doc<span class="w"> </span>_build

<span class="go">... lots of output ...</span>
<span class="go">The HTML pages are in _build.</span>
</pre></div>
</div>
</li>
<li><p>Try to open <code class="docutils literal notranslate"><span class="pre">_build/index.html</span></code> in your browser.</p></li>
<li><p>Experiment with adding more content, images, equations, code blocks, …</p>
<ul class="simple">
<li><p><a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/typography.html">typography</a></p></li>
<li><p><a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/images_and_figures.html">images</a></p></li>
<li><p><a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/math.html">math and equations</a></p></li>
<li><p><a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/code_and_apis.html">code blocks</a></p></li>
</ul>
</li>
</ol>
</div>
<p>There is a lot more you can do:</p>
<ul>
<li><p>This is useful if you want to check the integrity of all internal and external links:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sphinx-build<span class="w"> </span>doc<span class="w"> </span>-W<span class="w"> </span>-b<span class="w"> </span>linkcheck<span class="w"> </span>_build
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://pypi.org/project/sphinx-autobuild/">sphinx-autobuild</a>
provides a local web server that will automatically refresh your view
every time you save a file - which makes writing with live-preview much easier.</p></li>
</ul>
</section>
<section id="demo-building-documentation-with-github-actions">
<h5>Demo: Building documentation with GitHub Actions<a class="headerlink" href="#demo-building-documentation-with-github-actions" title="Link to this heading"></a></h5>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>Instructor presents.</p></li>
<li><p>Learners are encouraged to try this later on their own.</p></li>
</ul>
</div>
<p>First we need to extend the <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file to include the necessary packages:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">planets</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python=3.12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">click</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">matplotlib</span>
<span class="hll"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myst-parser</span>
</span><span class="hll"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx</span>
</span><span class="hll"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-rtd-theme</span>
</span><span class="hll"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-autoapi</span>
</span></pre></div>
</div>
<p>Then we add a GitHub Actions workflow <code class="docutils literal notranslate"><span class="pre">.github/workflow/sphinx.yml</span></code> to build the documentation:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build documentation</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">main</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">main</span><span class="w"> </span><span class="p p-Indicator">]</span>

<span class="nt">permissions</span><span class="p">:</span>
<span class="w">  </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">docs</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Checkout</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mamba-org/setup-micromamba@v1</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">micromamba-version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1.5.8-0&#39;</span><span class="w"> </span><span class="c1"># any version from https://github.com/mamba-org/micromamba-releases</span>
<span class="w">        </span><span class="nt">environment-file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">environment.yml</span>
<span class="w">        </span><span class="nt">init-shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<span class="w">        </span><span class="nt">cache-environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">post-cleanup</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;all&#39;</span>
<span class="w">        </span><span class="nt">generate-run-shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Sphinx build</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="hll"><span class="w">        </span><span class="no">sphinx-build doc _build</span>
</span><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash -el {0}</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deploy to GitHub Pages</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">peaceiris/actions-gh-pages@v4</span>
<span class="w">      </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.event_name == &#39;push&#39; &amp;&amp; github.ref == &#39;refs/heads/main&#39; }}</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">publish_branch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gh-pages</span>
<span class="w">        </span><span class="nt">github_token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span>
<span class="w">        </span><span class="nt">publish_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_build/</span>
<span class="w">        </span><span class="nt">force_orphan</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>Now:</p>
<ul class="simple">
<li><p>Add these two changes to the GitHub repository.</p></li>
<li><p>Go to “Settings” -&gt; “Pages” -&gt; “Branch” -&gt; <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> -&gt; “Save”.</p></li>
<li><p>Look at “Actions” tab and observe the workflow running and hopefully
deploying the website.</p></li>
<li><p>Finally visit the generated site. You can find it by clicking the About wheel
icon on top right of your repository. There, select “Use your GitHub Pages
website”.</p></li>
<li><p><strong>This is how we build almost all of our lesson websites</strong>,
including this one!</p></li>
<li><p>Another popular place to deploy Sphinx documentation is <a class="reference external" href="https://readthedocs.org/">ReadTheDocs</a>.</p></li>
</ul>
</section>
<section id="optional-how-to-auto-generate-api-documentation-in-python">
<h5>Optional: How to auto-generate API documentation in Python<a class="headerlink" href="#optional-how-to-auto-generate-api-documentation-in-python" title="Link to this heading"></a></h5>
<p>Add three tiny modifications (highlighted) to <code class="docutils literal notranslate"><span class="pre">doc/conf.py</span></code> to auto-generate API documentation
(this requires the <code class="docutils literal notranslate"><span class="pre">sphinx-autoapi</span></code> package):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">project</span> <span class="o">=</span> <span class="s2">&quot;planets&quot;</span>
<span class="n">copyright</span> <span class="o">=</span> <span class="s2">&quot;2024, Authors&quot;</span>
<span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;Authors&quot;</span>
<span class="n">release</span> <span class="o">=</span> <span class="s2">&quot;0.1&quot;</span>

<span class="n">exclude_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_build&quot;</span><span class="p">,</span> <span class="s2">&quot;Thumbs.db&quot;</span><span class="p">,</span> <span class="s2">&quot;.DS_Store&quot;</span><span class="p">]</span>

<span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;myst_parser&quot;</span><span class="p">,</span>  <span class="c1"># in order to use markdown</span>
<span class="hll">    <span class="s2">&quot;autoapi.extension&quot;</span><span class="p">,</span>  <span class="c1"># in order to use markdown</span>
</span><span class="p">]</span>

<span class="c1"># search this directory for Python files</span>
<span class="hll"><span class="n">autoapi_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;..&quot;</span><span class="p">]</span>
</span>
<span class="c1"># ignore this file when generating API documentation</span>
<span class="hll"><span class="n">autoapi_ignore</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*/conf.py&quot;</span><span class="p">]</span>
</span>
<span class="n">myst_enable_extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;colon_fence&quot;</span><span class="p">,</span>  <span class="c1"># ::: can be used instead of ``` for better rendering</span>
<span class="p">]</span>

<span class="n">html_theme</span> <span class="o">=</span> <span class="s2">&quot;sphinx_rtd_theme&quot;</span>
</pre></div>
</div>
<p>Then rebuild the documentation (or push the changes and let GitHub rebuild it)
and you should see a new section “API Reference”.</p>
</section>
<section id="confused-about-restructuredtext-vs-markdown-vs-myst">
<h5>Confused about reStructuredText vs. Markdown vs. MyST?<a class="headerlink" href="#confused-about-restructuredtext-vs-markdown-vs-myst" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>At the beginning there was reStructuredText and Sphinx was built for reStructuredText.</p></li>
<li><p>Independently, Markdown was invented and evolved into a couple of flavors.</p></li>
<li><p>Markdown became more and more popular but was limited compared to reStructuredText.</p></li>
<li><p>Later, <a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/typography.html">MyST</a>
was invented to be able to write
something that looks like Markdown but in addition can do everything that
reStructuredText can do with extra directives.</p></li>
</ul>
</section>
<section id="where-to-read-more">
<h5>Where to read more<a class="headerlink" href="#where-to-read-more" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p><a class="reference external" href="https://coderefinery.github.io/documentation/">CodeRefinery documentation lesson</a></p></li>
<li><p><a class="reference external" href="https://www.sphinx-doc.org/">Sphinx documentation</a></p></li>
<li><p><a class="reference external" href="https://sphinx-rtd-tutorial.readthedocs.io/en/latest/index.html">Sphinx + ReadTheDocs guide</a></p></li>
<li><p>For more Markdown functionality, see the <a class="reference external" href="https://www.markdownguide.org/basic-syntax/">Markdown guide</a>.</p></li>
<li><p>For Sphinx additions, see <a class="reference external" href="https://www.sphinx-doc.org/en/master/markup/index.html">Sphinx Markup Constructs</a>.</p></li>
<li><p><a class="reference external" href="https://docs.python-guide.org/writing/documentation/">An opinionated guide on documentation in Python</a></p></li>
</ul>
</section>
</section>
<span id="document-collaboration"></span><section id="collaborative-version-control-and-code-review">
<span id="collaboration"></span><h4>Collaborative version control and code review<a class="headerlink" href="#collaborative-version-control-and-code-review" title="Link to this heading"></a></h4>
<div class="toctree-wrapper compound">
<span id="document-collaboration/concepts"></span><section id="concepts-around-collaboration">
<span id="concepts"></span><h5>Concepts around collaboration<a class="headerlink" href="#concepts-around-collaboration" title="Link to this heading"></a></h5>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Be able to decide whether to divide work at the branch level or at the repository level.</p></li>
</ul>
</div>
<section id="commits-branches-repositories-forks-clones">
<h6>Commits, branches, repositories, forks, clones<a class="headerlink" href="#commits-branches-repositories-forks-clones" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p><strong>repository</strong>: The project, contains all data and history (commits, branches, tags).</p></li>
<li><p><strong>commit</strong>: Snapshot of the project, gets a unique identifier (e.g. <code class="docutils literal notranslate"><span class="pre">c7f0e8bfc718be04525847fc7ac237f470add76e</span></code>).</p></li>
<li><p><strong>branch</strong>: Independent development line. The main development line is often called <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p><strong>tag</strong>: A pointer to one commit, to be able to refer to it later. Like a <a class="reference external" href="https://en.wikipedia.org/wiki/Commemorative_plaque">commemorative plaque</a>
that you attach to a particular commit (e.g. <code class="docutils literal notranslate"><span class="pre">phd-printed</span></code> or <code class="docutils literal notranslate"><span class="pre">paper-submitted</span></code>).</p></li>
<li><p><strong>cloning</strong>: Copying the whole repository to your laptop - the first time. It is not necessary to download each file one by one.</p></li>
<li><p><strong>forking</strong>: Taking a copy of a repository (which is typically not yours) - your
copy (fork) stays on GitHub/GitLab and you can make changes to your copy.</p></li>
</ul>
</section>
<section id="cloning-a-repository">
<h6>Cloning a repository<a class="headerlink" href="#cloning-a-repository" title="Link to this heading"></a></h6>
<p>In order to make a complete copy a whole repository, the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code> command
can be used. When cloning, all the files, of all or selected branches, of a
repository are copied in one operation. Cloning of a repository is of relevance
in a few different situations:</p>
<ul class="simple">
<li><p>Working on your own, cloning is the operation that you can use to create
multiple instances of a repository on, for instance, a personal computer, a
server, and a supercomputer.</p></li>
<li><p>The parent repository could be a repository that you or your colleague own. A
common use case for cloning is when working together within a smaller team
where everyone has read and write access to the same git repository.</p></li>
<li><p>Alternatively, cloning can be made from a public repository of a code that
you would like to use. Perhaps you have no intention to work on the code, but
would like to stay in tune with the latest developments, also in-between
releases of new versions of the code.</p></li>
</ul>
<figure class="align-default" id="id1">
<a class="with-border reference internal image-reference" href="_images/forkandclone.png"><img alt="Forking and cloning" class="with-border" src="_images/forkandclone.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Forking and cloning</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="forking-a-repository">
<h6>Forking a repository<a class="headerlink" href="#forking-a-repository" title="Link to this heading"></a></h6>
<p>When a fork is made on GitHub/GitLab a complete copy, of all or selected
branches, of the repository is made. The copy will reside under a different
account on GitHub/GitLab. Forking of a repository is of high relevance when
working with a git repository to which you do not have write access.</p>
<ul class="simple">
<li><p>In the fork repository commits can be made to the base branch (<code class="docutils literal notranslate"><span class="pre">main</span></code> or
<code class="docutils literal notranslate"><span class="pre">master</span></code>), and to other branches.</p></li>
<li><p>The commits that are made within the branches of the fork repository can be
contributed back to the parent repository by means of pull or merge requests.</p></li>
</ul>
</section>
<section id="synchronizing-changes-between-repositories">
<h6>Synchronizing changes between repositories<a class="headerlink" href="#synchronizing-changes-between-repositories" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>We need a mechanism to communicate changes between the repositories.</p></li>
<li><p>We will <strong>pull</strong> or <strong>fetch</strong> updates <strong>from</strong> remote repositories (we will soon discuss the difference between pull and fetch).</p></li>
<li><p>We will <strong>push</strong> updates <strong>to</strong> remote repositories.</p></li>
<li><p>We will learn how to suggest changes within repositories on GitHub and across repositories (<strong>pull request</strong>).</p></li>
<li><p>Repositories that are forked or cloned do not automatically synchronize themselves:
We will learn how to update forks (by pulling from the “central” repository).</p></li>
<li><p>A main difference between cloning a repository and forking a repository is that the former is a general operation for generating copies of a repository to different computers, whereas forking is a particular operation implemented on GitHub/GitLab.</p></li>
</ul>
</section>
</section>
<span id="document-collaboration/same-repository"></span><section id="collaborating-within-the-same-repository">
<span id="same-repository"></span><h5>Collaborating within the same repository<a class="headerlink" href="#collaborating-within-the-same-repository" title="Link to this heading"></a></h5>
<p>In this episode, we will learn how to collaborate within the same repository.
We will learn how to cross-reference issues and pull requests, how to review
pull requests, and how to use draft pull requests.</p>
<p>This exercise will form a good basis for collaboration that is suitable for
most research groups.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you read or hear <strong>pull request</strong>, please think of a <strong>change proposal</strong>.</p>
</div>
<section id="exercise">
<h6>Exercise<a class="headerlink" href="#exercise" title="Link to this heading"></a></h6>
<p>In this exercise, we will contribute to a repository via a <strong>pull request</strong>.
This means that you propose some change, and then it is accepted (or not).</p>
<div class="admonition-exercise-preparation prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Exercise preparation</p>
<ul>
<li><p><strong>First we need to get access</strong> to the <a class="reference external" href="https://github.com/workshop-material/recipe-book">exercise repository</a> to which we will
contribute.</p>
<ul class="simple">
<li><p>Instructor collects GitHub usernames from learners and adds them as collaborators to the exercise repository
(Settings -&gt; Collaborators and teams -&gt; Manage access -&gt; Add people).</p></li>
</ul>
</li>
<li><p><strong>Don’t forget to accept the invitation</strong></p>
<ul class="simple">
<li><p>Check <a class="reference external" href="https://github.com/settings/organizations/">https://github.com/settings/organizations/</a></p></li>
<li><p>Alternatively check the inbox for the email account you registered with
GitHub. GitHub emails you an invitation link, but if you don’t receive it
you can go to your GitHub notifications in the top right corner. The
maintainer can also “copy invite link” and share it within the group.</p></li>
</ul>
</li>
<li><p><strong>Watching and unwatching repositories</strong></p>
<ul class="simple">
<li><p>Now that you are a collaborator, you get notified about new issues and pull
requests via email.</p></li>
<li><p>If you do not wish this, you can “unwatch” a repository (top of
the project page).</p></li>
<li><p>However, we recommend watching repositories you are interested
in. You can learn things from experts just by watching the
activity that come through a popular project.</p></li>
</ul>
<figure class="align-default" id="id1">
<img alt="Unwatching a repository" src="_images/unwatch.png" />
<figcaption>
<p><span class="caption-text">Unwatch a repository by clicking “Unwatch” in the repository view,
then “Participating and &#64;mentions” - this way, you will get
notifications about your own interactions.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</li>
</ul>
</div>
<div class="admonition-exercise-collaborating-within-the-same-repository-25-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Collaborating within the same repository (25 min)</p>
<p><strong>Technical requirements</strong> (from installation instructions):</p>
<ul class="simple">
<li><p>If you create the commits locally: <a class="reference external" href="https://coderefinery.github.io/installation/ssh/">Being able to authenticate to GitHub</a></p></li>
</ul>
<p><strong>What is familiar</strong> from the previous workshop day (not repeated here):</p>
<ul class="simple">
<li><p>Cloning a repository.</p></li>
<li><p>Creating a branch.</p></li>
<li><p>Committing a change on the new branch.</p></li>
<li><p>Submit a pull request towards the main branch.</p></li>
</ul>
<p><strong>What will be new</strong> in this exercise:</p>
<ul class="simple">
<li><p>If you create the changes locally, you will need to <strong>push</strong> them to the remote repository.</p></li>
<li><p>Learning what a protected branch is and how to modify a protected branch: using a pull request.</p></li>
<li><p>Cross-referencing issues and pull requests.</p></li>
<li><p>Practice to review a pull request.</p></li>
<li><p>Learn about the value of draft pull requests.</p></li>
</ul>
<p><strong>Exercise tasks</strong>:</p>
<ol class="arabic simple">
<li><p>Start in the <a class="reference external" href="https://github.com/workshop-material/recipe-book">exercise
repository</a> and open an
issue where you describe the change you want to make. Note down the issue
number since you will need it later.</p></li>
<li><p>Create a new branch.</p></li>
<li><p>Make a change to the recipe book on the new branch and in the commit
cross-reference the issue you opened (see the walk-through below
for how to do that).</p></li>
<li><p>Push your new branch (with the new commit) to the repository you
are working on.</p></li>
<li><p>Open a pull request towards the main branch.</p></li>
<li><p>Review somebody else’s pull request and give constructive feedback. Merge their pull request.</p></li>
<li><p>Try to create a new branch with some half-finished work and open a draft
pull request. Verify that the draft pull request cannot be merged since it
is not meant to be merged yet.</p></li>
</ol>
</div>
</section>
<section id="solution-and-hints">
<h6>Solution and hints<a class="headerlink" href="#solution-and-hints" title="Link to this heading"></a></h6>
<section id="opening-an-issue">
<h6 aria-level="7">(1) Opening an issue<a class="headerlink" href="#opening-an-issue" title="Link to this heading"></a></h6>
<p>This is done through the GitHub web interface.  For example, you could
give the name of the recipe you want to add (so that others don’t add
the same one).  It is the “Issues” tab.</p>
</section>
<section id="create-a-new-branch">
<h6 aria-level="7">(2) Create a new branch.<a class="headerlink" href="#create-a-new-branch" title="Link to this heading"></a></h6>
<p>If on GitHub, you can make the branch in the web interface.</p>
</section>
<section id="make-a-change-adding-the-recipe">
<h6 aria-level="7">(3) Make a change adding the recipe<a class="headerlink" href="#make-a-change-adding-the-recipe" title="Link to this heading"></a></h6>
<p>Add a new file with the recipe in it.  Commit the file. In the commit
message, include the note about the issue number, saying that this
will close that issue.</p>
<section id="cross-referencing-issues-and-pull-requests">
<h6 aria-level="8">Cross-referencing issues and pull requests<a class="headerlink" href="#cross-referencing-issues-and-pull-requests" title="Link to this heading"></a></h6>
<p>Each issue and each pull request gets a number and you can cross-reference them.</p>
<p>When you open an issue, note down the issue number (in this case it is <code class="docutils literal notranslate"><span class="pre">#2</span></code>):</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/issue-number.png"><img alt="Each issue gets a number" class="with-border" src="_images/issue-number.png" style="width: 60%;" /></a>
</figure>
<p>You can reference this issue number in a commit message or in a pull request, like in this
commit message:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>this is the new recipe; fixes #2
</pre></div>
</div>
<p>If you forget to do that in your commit message, you can also reference the issue
in the pull request description. And instead of <code class="docutils literal notranslate"><span class="pre">fixes</span></code> you can also use <code class="docutils literal notranslate"><span class="pre">closes</span></code> or <code class="docutils literal notranslate"><span class="pre">resolves</span></code>
or <code class="docutils literal notranslate"><span class="pre">fix</span></code> or <code class="docutils literal notranslate"><span class="pre">close</span></code> or <code class="docutils literal notranslate"><span class="pre">resolve</span></code> (case insensitive).</p>
<p>Here are all the keywords that GitHub recognizes:
<a class="reference external" href="https://help.github.com/en/articles/closing-issues-using-keywords">https://help.github.com/en/articles/closing-issues-using-keywords</a></p>
<p>Then observe what happens in the issue once your commit gets merged: it will
automatically close the issue and create a link between the issue and the
commit. This is very useful for tracking what changes were made in response to
which issue and to know from when <strong>until when precisely</strong> the issue was open.</p>
</section>
</section>
<section id="push-to-github-as-a-new-branch">
<h6 aria-level="7">(4) Push to GitHub as a new branch<a class="headerlink" href="#push-to-github-as-a-new-branch" title="Link to this heading"></a></h6>
<p>Push the branch to the repository. You should end up with a branch
visible in the GitHub web view.</p>
<p>This is only necessary if you created the changes locally. If you created the
changes directly on GitHub, you can skip this step.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-VlMgQ29kZQ==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tab" tabindex="0">VS Code</button><button aria-controls="panel-0-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-0-VlMgQ29kZQ==" class="sphinx-tabs-panel group-tab" id="panel-0-VlMgQ29kZQ==" name="VlMgQ29kZQ==" role="tabpanel" tabindex="0"><p>In VS Code, you can “publish the branch” to the remote repository by clicking
the cloud icon in the bottom left corner of the window:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/vscode-publish-branch.png"><img alt="Publishing a branch in VS Code" class="with-border" src="_images/vscode-publish-branch.png" style="width: 60%;" /></a>
</figure>
</div><div aria-labelledby="tab-0-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>If you have a local branch <code class="docutils literal notranslate"><span class="pre">my-branch</span></code> and you want to push it to the remote
and make it visible there, first verify what your remote is:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>--verbose

<span class="go">origin	git@github.com:USER/recipe-book.git (fetch)</span>
<span class="go">origin	git@github.com:USER/recipe-book.git (push)</span>
</pre></div>
</div>
<p>In this case the remote is called <code class="docutils literal notranslate"><span class="pre">origin</span></code> and refers to the address
git&#64;github.com:USER/recipe-book.git.  Both can be used
interchangeably. Make sure it points to the right repository, ideally a
repository that you can write to.</p>
<p>Now that you have a remote, you can push your branch to it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>my-branch
</pre></div>
</div>
<p>This will create a new branch on the remote repository with the same name as
your local branch.</p>
<p>You can also do this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>push<span class="w"> </span>--set-upstream<span class="w"> </span>origin<span class="w"> </span>my-branch
</pre></div>
</div>
<p>This will connect the local branch and the remote branch so that in the future
you can just type <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> without specifying the branch name
(but this depends on your Git configuration).</p>
<p><strong>Troubleshooting</strong></p>
<p>If you don’t have a remote yet, you can add it with (adjust <code class="docutils literal notranslate"><span class="pre">ADDRESS</span></code> to your repository address):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span>ADDRESS
</pre></div>
</div>
<p>ADDRESS is the part that you copy from here:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/clone-address.png"><img alt="Copying the clone address from GitHub" class="with-border" src="_images/clone-address.png" style="width: 60%;" /></a>
</figure>
<p>If the remote points to the wrong place, you can change it with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>set-url<span class="w"> </span>origin<span class="w"> </span>NEWADDRESS
</pre></div>
</div>
</div></div>
</section>
<section id="open-a-pull-request-towards-the-main-branch">
<h6 aria-level="7">(5) Open a pull request towards the main branch<a class="headerlink" href="#open-a-pull-request-towards-the-main-branch" title="Link to this heading"></a></h6>
<p>This is done through the GitHub web interface.</p>
</section>
<section id="reviewing-pull-requests">
<h6 aria-level="7">(6) Reviewing pull requests<a class="headerlink" href="#reviewing-pull-requests" title="Link to this heading"></a></h6>
<p>You review through the GitHub web interface.</p>
<p>Checklist for reviewing a pull request:</p>
<ul class="simple">
<li><p>Be kind, on the other side is a human who has put effort into this.</p></li>
<li><p>Be constructive: if you see a problem, suggest a solution.</p></li>
<li><p>Towards which branch is this directed?</p></li>
<li><p>Is the title descriptive?</p></li>
<li><p>Is the description informative?</p></li>
<li><p>Scroll down to see commits.</p></li>
<li><p>Scroll down to see the changes.</p></li>
<li><p>If you get incredibly many changes, also consider the license or copyright
and ask where all that code is coming from.</p></li>
<li><p>Again, be kind and constructive.</p></li>
<li><p>Later we will learn how to suggest changes directly in the pull request.</p></li>
</ul>
<p>If someone is new, it’s often nice to say something encouraging in the
comments before merging (even if it’s just “thanks”).  If all is good
and there’s not much else to say, you could merge directly.</p>
</section>
<section id="draft-pull-requests">
<h6 aria-level="7">(7) Draft pull requests<a class="headerlink" href="#draft-pull-requests" title="Link to this heading"></a></h6>
<p>Try to create a draft pull request:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/draft-pr.png"><img alt="Creating a draft pull request" class="with-border" src="_images/draft-pr.png" style="width: 60%;" /></a>
</figure>
<p>Verify that the draft pull request cannot be merged until it is marked as ready
for review:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/draft-pr-wip.png"><img alt="Draft pull request cannot be merged" class="with-border" src="_images/draft-pr-wip.png" style="width: 60%;" /></a>
</figure>
<p>Draft pull requests can be useful for:</p>
<ul class="simple">
<li><p><strong>Feedback</strong>: You can open a pull request early to get feedback on your work without
signaling that it is ready to merge.</p></li>
<li><p><strong>Information</strong>: They can help communicating to others that a change is coming up and in
progress.</p></li>
</ul>
</section>
<section id="what-is-a-protected-branch-and-how-to-modify-it">
<h6 aria-level="7">What is a protected branch? And how to modify it?<a class="headerlink" href="#what-is-a-protected-branch-and-how-to-modify-it" title="Link to this heading"></a></h6>
<p>A protected branch on GitHub or GitLab is a branch that cannot (accidentally)
deleted or force-pushed to. It is also possible to require that a branch cannot
be directly pushed to or modified, but that changes must be submitted via a
pull request.</p>
<p>To protect a branch in your own repository, go to “Settings” -&gt; “Branches”.</p>
</section>
<section id="summary">
<h6 aria-level="7">Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>We used all the same pieces that we’ve learned previously.</p></li>
<li><p>But we successfully contributed to a <strong>collaborative project</strong>!</p></li>
<li><p>The pull request allowed us to contribute without changing directly:
this is very good when it’s not mainly our project.</p></li>
</ul>
</section>
</section>
</section>
<span id="document-collaboration/code-review"></span><section id="practicing-code-review">
<span id="code-review"></span><h5>Practicing code review<a class="headerlink" href="#practicing-code-review" title="Link to this heading"></a></h5>
<p>In this episode we will practice the code review process. We will learn how to
ask for changes in a pull request, how to suggest a change in a pull request,
and how to modify a pull request.</p>
<p>This will enable research groups to work more collaboratively and to not only
improve the code quality but also to <strong>learn from each other</strong>.</p>
<section id="exercise">
<h6>Exercise<a class="headerlink" href="#exercise" title="Link to this heading"></a></h6>
<div class="admonition-exercise-preparation prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Exercise preparation</p>
<p>We can continue in the same exercise repository which we have used in the
previous episode.</p>
</div>
<div class="admonition-exercise-practicing-code-review-25-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Practicing code review (25 min)</p>
<p><strong>Technical requirements</strong>:</p>
<ul class="simple">
<li><p>If you create the commits locally: <a class="reference external" href="https://coderefinery.github.io/installation/ssh/">Being able to authenticate to GitHub</a></p></li>
</ul>
<p><strong>What is familiar</strong> from previous lessons:</p>
<ul class="simple">
<li><p>Creating a branch.</p></li>
<li><p>Committing a change on the new branch.</p></li>
<li><p>Opening and merging pull requests.</p></li>
</ul>
<p><strong>What will be new</strong> in this exercise:</p>
<ul class="simple">
<li><p>As a reviewer, we will learn how to ask for changes in a pull request.</p></li>
<li><p>As a reviewer, we will learn how to suggest a change in a pull request.</p></li>
<li><p>As a submitter, we will learn how to modify a pull request without closing
the incomplete one and opening a new one.</p></li>
</ul>
<p><strong>Exercise tasks</strong>:</p>
<ol class="arabic simple">
<li><p>Create a new branch and one or few commits: in these improve something but also
deliberately introduce a typo and also a larger mistake which we will want to fix during the code review.</p></li>
<li><p>Open a pull request towards the main branch.</p></li>
<li><p>As a reviewer to somebody else’s pull request, ask for an improvement and
also directly suggest a change for the small typo. (Hint:
suggestions are possible through the GitHub web interface, view of
a pull request, “Files changed” view, after selecting some lines.
Look for the “±” button.)</p></li>
<li><p>As the submitter, learn how to accept the suggested change.  (Hint:
GitHub web interface, “Files Changed” view.)</p></li>
<li><p>As the submitter, improve the pull request without having to close and open
a new one: by adding a new commit to the same branch. (Hint: push
to the branch again.)</p></li>
<li><p>Once the changes are addressed, merge the pull request.</p></li>
</ol>
</div>
</section>
<section id="help-and-discussion">
<h6>Help and discussion<a class="headerlink" href="#help-and-discussion" title="Link to this heading"></a></h6>
<p>From here on out, we don’t give detailed steps to the solution.  You
need to combine what you know, and the extra info below, in order to
solve the above.</p>
<section id="how-to-ask-for-changes-in-a-pull-request">
<h6 aria-level="7">How to ask for changes in a pull request<a class="headerlink" href="#how-to-ask-for-changes-in-a-pull-request" title="Link to this heading"></a></h6>
<p>Technically, there are at least two common ways to ask for changes in a pull
request.</p>
<p>Either in the comment field of the pull request:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/comment.png"><img alt="Screenshot of a pull request comment field" class="with-border" src="_images/comment.png" style="width: 60%;" /></a>
</figure>
<p>Or by using the “Review changes”:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/files-changed.png"><img alt="Screenshot of a pull request navigating to the &quot;Review changes&quot; tab" class="with-border" src="_images/files-changed.png" style="width: 100%;" /></a>
</figure>
<p>And always please be kind and constructive in your comments. Remember that the
goal is not gate-keeping but <strong>collaborative learning</strong>.</p>
</section>
<section id="how-to-suggest-a-change-in-a-pull-request-as-a-reviewer">
<h6 aria-level="7">How to suggest a change in a pull request as a reviewer<a class="headerlink" href="#how-to-suggest-a-change-in-a-pull-request-as-a-reviewer" title="Link to this heading"></a></h6>
<p>If you see a very small problem that is easy to fix, you can suggest a change
as a reviewer.</p>
<p>Instead of asking the submitter to tiny problem, you can suggest a change by
clicking on the plus sign next to the line number in the “Files changed” tab:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/leave-comment.png"><img alt="Screenshot of leaving a comment to a line in a pull request" class="with-border" src="_images/leave-comment.png" style="width: 100%;" /></a>
</figure>
<p>Here you can comment on specific lines or even line ranges.</p>
<p>But now the interesting part is to click on the “Add a suggestion” symbol (the
one that looks like plus and minus). Now you can fix the tiny problem (in this
case a typo) and then click on the “Add single comment” button:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/add-suggestion.png"><img alt="Sequence of clicks to add a suggestion to a line in a pull request" class="with-border" src="_images/add-suggestion.png" style="width: 60%;" /></a>
</figure>
<p>The result is this and the submitter can accept the change with a single click:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/commit-suggestion.png"><img alt="Screenshot of a pull request with a suggested change" class="with-border" src="_images/commit-suggestion.png" style="width: 60%;" /></a>
</figure>
<p>After accepting with “Commit suggestion”, the improvement gets added to the
pull request.</p>
</section>
<section id="how-to-modify-a-pull-request-to-address-the-review-comments">
<h6 aria-level="7">How to modify a pull request to address the review comments<a class="headerlink" href="#how-to-modify-a-pull-request-to-address-the-review-comments" title="Link to this heading"></a></h6>
<p>If the reviewer asks for changes, it is not necessary to close the pull request
and later open a new one. It can even be counter-productive to do so: This can
fragment the discussion and the history of the pull request and can make it
harder to understand the context of the changes.</p>
<p>A much better mechanism is to recognize that pull requests are not implemented
from a specific commit to a specific branch, but <strong>always from a branch to a
branch</strong>.</p>
<p>This means that you can make amendments to the pull request by adding new
commits to the same source branch. This way the pull request will be updated
automatically and the reviewer can see the new changes and comment on them.</p>
<p>The fact that pull requests are from branch to branch also strongly suggests
that it is a good practice to <strong>create a new branch for each pull request</strong>.
Otherwise you could accidentally modify an open pull request by adding new
commits to the source branch.</p>
</section>
</section>
<section id="summary">
<h6>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Our process isn’t just about code now.  It’s about discussion and
working together to make the whole process better.</p></li>
<li><p>GitHub (or GitLab) discussions and reviewing are quite powerful and can make
small changes easy.</p></li>
</ul>
</section>
</section>
<span id="document-collaboration/forking-workflow"></span><section id="how-to-contribute-changes-to-repositories-that-belong-to-others">
<span id="forking-workflow"></span><h5>How to contribute changes to repositories that belong to others<a class="headerlink" href="#how-to-contribute-changes-to-repositories-that-belong-to-others" title="Link to this heading"></a></h5>
<p>In this episode we prepare you to suggest and contribute changes to
repositories that belong to others. These might be open source projects that
you use in your work.</p>
<p>We will see how Git and services like GitHub or GitLab can be used to suggest
modification without having to ask for write access to the repository and
accept modifications without having to grant write access to others.</p>
<section id="exercise">
<h6>Exercise<a class="headerlink" href="#exercise" title="Link to this heading"></a></h6>
<div class="admonition-exercise-preparation prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Exercise preparation</p>
<ul class="simple">
<li><p>The exercise repository is now different:
<a class="reference external" href="https://github.com/workshop-material/recipe-book-forking-exercise">https://github.com/workshop-material/recipe-book-forking-exercise</a> (note the <strong>-forking-exercise</strong>).</p></li>
<li><p>First <strong>fork</strong> the exercise repository to your GitHub account.</p></li>
<li><p>Then <strong>clone your fork</strong> to your computer (if you wish to work locally).</p></li>
<li><p>Double-check that you have forked the correct repository.</p></li>
</ul>
</div>
<div class="admonition-exercise-collaborating-within-the-same-repository-25-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Collaborating within the same repository (25 min)</p>
<p><strong>Technical requirements</strong>:</p>
<ul class="simple">
<li><p>If you create the commits locally: <a class="reference external" href="https://coderefinery.github.io/installation/ssh/">Being able to authenticate to GitHub</a></p></li>
</ul>
<p><strong>What is familiar</strong> from previous lessons:</p>
<ul class="simple">
<li><p>Forking a repository.</p></li>
<li><p>Creating a branch.</p></li>
<li><p>Committing a change on the new branch.</p></li>
<li><p>Opening and merging pull requests.</p></li>
</ul>
<p><strong>What will be new</strong> in this exercise:</p>
<ul class="simple">
<li><p>Opening a pull request towards the upstream repository.</p></li>
<li><p>Pull requests can be coupled with automated testing.</p></li>
<li><p>Learning that your fork can get out of date.</p></li>
<li><p>After the pull requests are merged, updating your fork with the changes.</p></li>
<li><p>Learn how to approach other people’s repositories with ideas, changes, and requests.</p></li>
</ul>
<p><strong>Exercise tasks</strong>:</p>
<ol class="arabic simple">
<li><p>Open an issue in the upstream exercise repository where you describe the
change you want to make. Take note of the issue number.</p></li>
<li><p>Create a new branch in your fork of the repository.</p></li>
<li><p>Make a change to the recipe book on the new branch and in the commit cross-reference the issue you opened.
See the walk-through below for how to do this.</p></li>
<li><p>Open a pull request towards the upstream repository.</p></li>
<li><p>The instructor will review and merge the pull requests.
During the review, pay attention to the automated test step (here for
demonstration purposes, we test whether the recipe contains an ingredients
and an instructions sections).</p></li>
<li><p>After few pull requests are merged, update your fork with the changes.</p></li>
<li><p>Check that in your fork you can see changes from other people’s pull requests.</p></li>
</ol>
</div>
</section>
<section id="help-and-discussion">
<h6>Help and discussion<a class="headerlink" href="#help-and-discussion" title="Link to this heading"></a></h6>
<section id="help-i-don-t-have-permissions-to-push-my-local-changes">
<h6 aria-level="7">Help! I don’t have permissions to push my local changes<a class="headerlink" href="#help-i-don-t-have-permissions-to-push-my-local-changes" title="Link to this heading"></a></h6>
<p>Maybe you see an error like this one:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Please make sure you have the correct access rights
and the repository exists.
</pre></div>
</div>
<p>Or like this one:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>failed to push some refs to workshop-material/recipe-book-forking-exercise.git
</pre></div>
</div>
<p>In this case you probably try to push the changes not to your fork but to the original repository
and in this exercise you do not have write access to the original repository.</p>
<p>The simpler solution is to clone again but this time your fork.</p>
<div class="admonition-recovery solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Recovery</p>
<p>But if you want to keep your local changes, you can change the remote URL to point to your fork.
Check where your remote points to with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">--verbose</span></code>.</p>
<p>It should look like this (replace <code class="docutils literal notranslate"><span class="pre">USER</span></code> with your GitHub username):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>--verbose

<span class="go">origin	git@github.com:USER/recipe-book-forking-exercise.git (fetch)</span>
<span class="go">origin	git@github.com:USER/recipe-book-forking-exercise.git (push)</span>
</pre></div>
</div>
<p>It should <strong>not</strong> look like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>--verbose

<span class="go">origin	git@github.com:workshop-material/recipe-book-forking-exercise.git (fetch)</span>
<span class="go">origin	git@github.com:workshop-material/recipe-book-forking-exercise.git (push)</span>
</pre></div>
</div>
<p>In this case you can adjust “origin” to point to your fork with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>set-url<span class="w"> </span>origin<span class="w"> </span>git@github.com:USER/recipe-book-forking-exercise.git
</pre></div>
</div>
</div>
</section>
<section id="opening-a-pull-request-towards-the-upstream-repository">
<h6 aria-level="7">Opening a pull request towards the upstream repository<a class="headerlink" href="#opening-a-pull-request-towards-the-upstream-repository" title="Link to this heading"></a></h6>
<p>We have learned in the previous episode that pull requests are always from
branch to branch. But the branch can be in a different repository.</p>
<p>When you open a pull request in a fork, by default GitHub will suggest to
direct it towards the default branch of the upstream repository.</p>
<p>This can be changed and it should always be verified, but in this case this is
exactly what we want to do, from fork towards upstream:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/pull-request-form.png"><img alt="Screenshot of a pull request from fork towards upstream" class="with-border" src="_images/pull-request-form.png" style="width: 100%;" /></a>
</figure>
</section>
<section id="pull-requests-can-be-coupled-with-automated-testing">
<h6 aria-level="7">Pull requests can be coupled with automated testing<a class="headerlink" href="#pull-requests-can-be-coupled-with-automated-testing" title="Link to this heading"></a></h6>
<p>We added an automated test here just for fun and so that you see that this is
possible to do.</p>
<p>In this exercise, the test is silly. It will check whether the recipe contains
both an ingredients and an instructions section.</p>
<p>In this example the test failed:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/all-checks-failed.png"><img alt="Screenshot of a failed test in a pull request" class="with-border" src="_images/all-checks-failed.png" style="width: 60%;" /></a>
</figure>
<p>Click on the “Details” link to see the details of the failed test:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/check-details.png"><img alt="Screenshot of details why the test failed" class="with-border" src="_images/check-details.png" style="width: 60%;" /></a>
</figure>
<p><strong>How can this be useful?</strong></p>
<ul class="simple">
<li><p>The project can define what kind of tests are expected to pass before a pull
request can be merged.</p></li>
<li><p>The reviewer can see the results of the tests, without having to run them
locally.</p></li>
</ul>
<p><strong>How does it work?</strong></p>
<ul class="simple">
<li><p>We added a GitHub Actions workflow
to automatically run on each push or pull request towards the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p></li>
</ul>
<p>What tests or steps can you image for your project to run automatically with
each pull request?</p>
</section>
<section id="how-to-update-your-fork-with-changes-from-upstream">
<h6 aria-level="7">How to update your fork with changes from upstream<a class="headerlink" href="#how-to-update-your-fork-with-changes-from-upstream" title="Link to this heading"></a></h6>
<p>This used to be difficult but now it is two mouse clicks.</p>
<p>Navigate to your fork and notice how GitHub tells you that your fork is behind.
In my case, it is 9 commits behind upstream. To fix this, click on “Sync fork”
and then “Update branch”:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/sync-fork.png"><img alt="Screenshot on GitHub fork page showing that the fork is behind" class="with-border" src="_images/sync-fork.png" style="width: 80%;" /></a>
</figure>
<p>After the update my “branch is up to date” with the upstream repository:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/fork-after-update.png"><img alt="Screenshot on GitHub after fork has been updated" class="with-border" src="_images/fork-after-update.png" style="width: 80%;" /></a>
</figure>
</section>
<section id="how-to-approach-other-peoples-repositories-with-ideas-changes-and-requests">
<h6 aria-level="7">How to approach other people’s repositories with ideas, changes, and requests<a class="headerlink" href="#how-to-approach-other-peoples-repositories-with-ideas-changes-and-requests" title="Link to this heading"></a></h6>
<p><strong>Contributing very minor changes</strong></p>
<ul class="simple">
<li><p>Clone or fork+clone repository</p></li>
<li><p>Create a branch</p></li>
<li><p>Commit and push change</p></li>
<li><p>Open a pull request or merge request</p></li>
</ul>
<p><strong>If you observe an issue and have an idea how to fix it</strong></p>
<ul class="simple">
<li><p>Open an issue in the repository you wish to contribute to</p></li>
<li><p>Describe the problem</p></li>
<li><p>If you have a suggestion on how to fix it, describe your suggestion</p></li>
<li><p>Possibly <strong>discuss and get feedback</strong></p></li>
<li><p>If you are working on the fix, indicate it in the issue so that others know that somebody is working on it and who is working on it</p></li>
<li><p>Submit your fix as pull request or merge request which references/closes the issue</p></li>
</ul>
<div class="admonition-motivation admonition">
<p class="admonition-title">Motivation</p>
<ul class="simple">
<li><p><strong>Inform others about an observed problem</strong></p></li>
<li><p>Make it clear whether this issue is up for grabs or already being worked on</p></li>
</ul>
</div>
<p><strong>If you have an idea for a new feature</strong></p>
<ul class="simple">
<li><p>Open an issue in the repository you wish to contribute to</p></li>
<li><p>In the issue, write a short proposal for your suggested change or new feature</p></li>
<li><p>Motivate why and how you wish to do this</p></li>
<li><p>Also indicate where you are unsure and where you would like feedback</p></li>
<li><p><strong>Discuss and get feedback before you code</strong></p></li>
<li><p>Once you start coding, indicate that you are working on it</p></li>
<li><p>Once you are done, submit your new feature as pull request or merge request which references/closes the issue/proposal</p></li>
</ul>
<div class="admonition-motivation admonition">
<p class="admonition-title">Motivation</p>
<ul class="simple">
<li><p><strong>Get agreement and feedback before writing 5000 lines of code</strong> which might be rejected</p></li>
<li><p>If we later wonder why something was done, we have the issue/proposal as
reference and can read up on the reasoning behind a code change</p></li>
</ul>
</div>
</section>
</section>
<section id="summary">
<h6>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>This forking workflow lets you propose changes to repositories for
which <strong>you have no write access</strong>.</p></li>
<li><p>This is the way that much modern open-source software works.</p></li>
<li><p>You can now contribute to any project you can view.</p></li>
</ul>
</section>
</section>
<span id="document-collaboration/demo-discussion"></span><section id="conflict-resolution-rebasing-and-organizational-strategies">
<span id="collaboration-demo-discussion"></span><h5>Conflict resolution, rebasing, and organizational strategies<a class="headerlink" href="#conflict-resolution-rebasing-and-organizational-strategies" title="Link to this heading"></a></h5>
<p>(40 min demo and discussion)</p>
</section>
</div>
</section>
<span id="document-testing"></span><section id="automated-testing">
<span id="testing"></span><h4>Automated testing<a class="headerlink" href="#automated-testing" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Know <strong>where to start</strong> in your own project.</p></li>
<li><p>Have an example for how to make the <strong>testing part of code review</strong>.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>(15 min) Motivation</p></li>
<li><p>(15 min) End-to-end tests</p></li>
<li><p>(15 min) Pytest</p></li>
<li><p>(15 min) Adding the unit test to GitHub Actions</p></li>
<li><p>(10 min) What else is possible</p></li>
<li><p>(20 min) Exercise</p></li>
</ul>
</div>
<section id="motivation">
<h5>Motivation<a class="headerlink" href="#motivation" title="Link to this heading"></a></h5>
<p>Testing is a way to check that the code does what it is expected to.</p>
<ul class="simple">
<li><p><strong>Less scary to change code</strong>: tests will tell you whether something broke.</p></li>
<li><p><strong>Easier for new people</strong> to join.</p></li>
<li><p>Easier for somebody to <strong>revive an old code</strong>.</p></li>
<li><p><strong>End-to-end test</strong>: run the whole code and compare result to a reference.</p></li>
<li><p><strong>Unit tests</strong>: test one unit (function or module). Can guide towards better
structured code: complicated code is more difficult to test.</p></li>
</ul>
</section>
<section id="how-testing-is-often-taught">
<h5>How testing is often taught<a class="headerlink" href="#how-testing-is-often-taught" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">def</span> <span class="nf">test_add</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
<p>How this feels:</p>
<figure class="align-default" id="id1">
<a class="with-border reference internal image-reference" href="_images/owl.png"><img alt="Instruction on how to draw an owl" class="with-border" src="_images/owl.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-text">[Citation needed]</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Instead, we will look at and <strong>discuss a real example</strong> where we test components
from our example project.</p>
</section>
<section id="where-to-start">
<h5>Where to start<a class="headerlink" href="#where-to-start" title="Link to this heading"></a></h5>
<p>Short answer: <strong>Start with an end-to-end test</strong>.</p>
<div class="admonition-longer-answer solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Longer answer</p>
<ul class="simple">
<li><p>A simple script or notebook probably does not need an automated test.</p></li>
</ul>
<p><strong>If you have nothing yet</strong>:</p>
<ul class="simple">
<li><p>Start with an end-to-end test.</p></li>
<li><p>Describe in words how <em>you</em> check whether the code still works.</p></li>
<li><p>Translate the words into a script (any language).</p></li>
<li><p>Run the script automatically on every code change.</p></li>
</ul>
<p><strong>If you want to start with unit-testing</strong>:</p>
<ul class="simple">
<li><p>You want to rewrite a function? Start adding a unit test right there first.</p></li>
</ul>
</div>
</section>
<section id="end-to-end-tests">
<h5>End-to-end tests<a class="headerlink" href="#end-to-end-tests" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>This is our end-to-end test: <a class="reference external" href="https://github.com/workshop-material/planets/blob/main/test.sh">https://github.com/workshop-material/planets/blob/main/test.sh</a></p></li>
<li><p>Note how we can run it <a class="reference external" href="https://github.com/workshop-material/planets/blob/813d49a247f36e9c1e10cbe78ecf1ae4b6e971c3/.github/workflows/test.yml#L28">on GitHub automatically</a>.</p></li>
<li><p>Also browse <a class="reference external" href="https://github.com/workshop-material/planets/actions">https://github.com/workshop-material/planets/actions</a>.</p></li>
<li><p>If we have time, we can try to create a pull request which would break the
code and see how the test fails.</p></li>
</ul>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>Is the <a class="reference external" href="https://github.com/workshop-material/planets/blob/main/test.sh">end-to-end test</a>
perfect? No. But it’s a good starting point. Discuss its limitations.</p>
</div>
</section>
<section id="pytest">
<h5>Pytest<a class="headerlink" href="#pytest" title="Link to this heading"></a></h5>
<p>First we need to add a test function, for instance
for <a class="reference external" href="https://github.com/workshop-material/planets/blob/813d49a247f36e9c1e10cbe78ecf1ae4b6e971c3/simulate.py#L31-L39">this function</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">force_between_planets</span><span class="p">(</span><span class="n">position1</span><span class="p">,</span> <span class="n">mass1</span><span class="p">,</span> <span class="n">position2</span><span class="p">,</span> <span class="n">mass2</span><span class="p">):</span>
    <span class="n">G</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># gravitational constant</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">position2</span> <span class="o">-</span> <span class="n">position1</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="n">force_magnitude</span> <span class="o">=</span> <span class="n">G</span> <span class="o">*</span> <span class="n">mass1</span> <span class="o">*</span> <span class="n">mass2</span> <span class="o">/</span> <span class="n">distance</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">force</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">distance</span><span class="p">)</span> <span class="o">*</span> <span class="n">force_magnitude</span>

    <span class="k">return</span> <span class="n">force</span>


<span class="hll"><span class="k">def</span> <span class="nf">test_force_between_planets</span><span class="p">():</span>
</span><span class="hll">    <span class="n">position1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</span><span class="hll">    <span class="n">mass1</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span class="hll">    <span class="n">position2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</span><span class="hll">    <span class="n">mass2</span> <span class="o">=</span> <span class="mf">2.0</span>
</span><span class="hll">
</span><span class="hll">    <span class="n">force</span> <span class="o">=</span> <span class="n">force_between_planets</span><span class="p">(</span><span class="n">position1</span><span class="p">,</span> <span class="n">mass1</span><span class="p">,</span> <span class="n">position2</span><span class="p">,</span> <span class="n">mass2</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</span></pre></div>
</div>
<p>Let us run the test with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pytest<span class="w"> </span>simulate.py
</pre></div>
</div>
<p>Explanation: <code class="docutils literal notranslate"><span class="pre">pytest</span></code> will look for functions starting with <code class="docutils literal notranslate"><span class="pre">test_</span></code> in files
and directories given as arguments. It will run them and report the results.</p>
<p>Now let us try this:</p>
<ul class="simple">
<li><p>Commit the test.</p></li>
<li><p>Break the function on purpose and run the test.</p></li>
<li><p>Does the test fail as expected?</p></li>
</ul>
</section>
<section id="adding-the-unit-test-to-github-actions">
<h5>Adding the unit test to GitHub Actions<a class="headerlink" href="#adding-the-unit-test-to-github-actions" title="Link to this heading"></a></h5>
<p>Our next goal is that we want GitHub to run the unit test
automatically on every change.</p>
<p>First we need to extend our
<a class="reference external" href="https://github.com/workshop-material/planets/blob/main/environment.yml">environment.yml</a>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">planets</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python=3.12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">click</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">matplotlib</span>
<span class="hll"><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest</span>
</span></pre></div>
</div>
<p>We also need to extend <code class="docutils literal notranslate"><span class="pre">.github/workflows/test.yml</span></code> (highlighted line):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Test</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">main</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">main</span><span class="w"> </span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Checkout</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mamba-org/setup-micromamba@v1</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">micromamba-version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1.5.8-0&#39;</span><span class="w"> </span><span class="c1"># any version from https://github.com/mamba-org/micromamba-releases</span>
<span class="w">        </span><span class="nt">environment-file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">environment.yml</span>
<span class="w">        </span><span class="nt">init-shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<span class="w">        </span><span class="nt">cache-environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">post-cleanup</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;all&#39;</span>
<span class="w">        </span><span class="nt">generate-run-shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run tests</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">./test.sh</span>
<span class="hll"><span class="w">        </span><span class="no">pytest simulate.py</span>
</span><span class="w">      </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash -el {0}</span>
</pre></div>
</div>
<p>If we have time, we can try to create a pull request which would break the
code and see how the test fails.</p>
</section>
<section id="what-else-is-possible">
<h5>What else is possible<a class="headerlink" href="#what-else-is-possible" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>The testing above used <strong>example-based</strong> testing.</p></li>
<li><p><strong>Test coverage</strong>: how much of the code is traversed by tests?</p>
<ul>
<li><p>Python: <a class="reference external" href="https://pytest-cov.readthedocs.io/">pytest-cov</a></p></li>
<li><p>Result can be deployed to services like <a class="reference external" href="https://about.codecov.io/">Codecov</a> or <a class="reference external" href="https://coveralls.io/">Coveralls</a>.</p></li>
</ul>
</li>
<li><p><strong>Property-based</strong> testing: generates arbitrary data matching your specification and checks that your guarantee still holds in that case.</p>
<ul>
<li><p>Python: <a class="reference external" href="https://hypothesis.readthedocs.io/">hypothesis</a></p></li>
</ul>
</li>
<li><p><strong>Snapshot-based</strong> testing: makes it easier to generate snapshots for regression tests.</p>
<ul>
<li><p>Python: <a class="reference external" href="https://syrupy-project.github.io/syrupy/">syrupy</a></p></li>
</ul>
</li>
<li><p><strong>Mutation testing</strong>: tests pass -&gt; change a line of code (make a mutant) -&gt; test again and check whether all mutants get “killed”.</p>
<ul>
<li><p>Python: <a class="reference external" href="https://mutmut.readthedocs.io/">mutmut</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="exercises">
<h5>Exercises<a class="headerlink" href="#exercises" title="Link to this heading"></a></h5>
<p>Experiment with the example project and what we learned above or try it on your
own project:</p>
<ul class="simple">
<li><p>Add a unit test.</p></li>
<li><p>Try to run it locally.</p></li>
<li><p>Check whether it fails when you break the corresponding function.</p></li>
<li><p>Try to run it on GitHub Actions.</p></li>
<li><p>Create a pull request which would break the code and see whether the automatic test would catch it.</p></li>
<li><p>Try to design an end-to-end test for your project.</p></li>
</ul>
</section>
</section>
<span id="document-reusable"></span><section id="how-to-make-the-project-more-reusable">
<span id="reusable"></span><h4>How to make the project more reusable<a class="headerlink" href="#how-to-make-the-project-more-reusable" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<p>There are not many codes that have no dependencies.
How should we <strong>deal with dependencies</strong>?</p>
</div>
<section id="how-to-avoid-it-works-on-my-machine">
<h5>How to avoid: “It works on my machine 🤷”<a class="headerlink" href="#how-to-avoid-it-works-on-my-machine" title="Link to this heading"></a></h5>
<p>Use a <strong>standard way</strong> to list dependencies in your project:</p>
<ul class="simple">
<li><p>Python: <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code></p></li>
<li><p>R: <code class="docutils literal notranslate"><span class="pre">DESCRIPTION</span></code> or <code class="docutils literal notranslate"><span class="pre">renv.lock</span></code></p></li>
<li><p>Rust: <code class="docutils literal notranslate"><span class="pre">Cargo.lock</span></code></p></li>
<li><p>Julia: <code class="docutils literal notranslate"><span class="pre">Project.toml</span></code></p></li>
<li><p>C/C++/Fortran: <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> or <code class="docutils literal notranslate"><span class="pre">spack.yaml</span></code> or the module
system on clusters or containers</p></li>
<li><p>Other languages: …</p></li>
</ul>
</section>
<section id="tools-and-what-problems-they-try-to-solve">
<h5>Tools and what problems they try to solve<a class="headerlink" href="#tools-and-what-problems-they-try-to-solve" title="Link to this heading"></a></h5>
<p><strong>Conda, Anaconda, mamba, pip, virtualenv, Pipenv, pyenv, Poetry, requirements.txt,
environment.yml, renv</strong>, …, these tools try to solve the following problems:</p>
<ul class="simple">
<li><p><strong>Defining a specific set of dependencies</strong>, possibly with well defined versions</p></li>
<li><p><strong>Installing those dependencies</strong> mostly automatically</p></li>
<li><p><strong>Recording the versions</strong> for all dependencies</p></li>
<li><p><strong>Isolate environments</strong></p>
<ul>
<li><p>On your computer for projects so they can use different software</p></li>
<li><p>Isolate environments on computers with many users (and allow self-installations)</p></li>
</ul>
</li>
<li><p>Using <strong>different Python/R versions</strong> per project</p></li>
<li><p>Provide tools and services to <strong>share packages</strong></p></li>
</ul>
<p>Essential XKCD comics:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://xkcd.com/2347/">xkcd - dependency</a></p></li>
<li><p><a class="reference external" href="https://xkcd.com/1987/">xkcd - superfund</a></p></li>
</ul>
</section>
<section id="best-practices">
<h5>Best practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h5>
<p>Install dependencies into <strong>isolated environments</strong>:</p>
<ul class="simple">
<li><p>For each project, create a new environment.</p></li>
<li><p>Don’t install dependencies globally for all projects.</p></li>
<li><p>Install them <strong>from a file</strong> which documents them at the same time.</p></li>
</ul>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<p>If somebody asks you what dependencies you have in your project, you should be
able to answer this question <strong>with a file</strong>.</p>
<p>In Python, the two most common ways to do this are:</p>
<ul class="simple">
<li><p><strong>requirements.txt</strong> (for pip and virtual environments)</p></li>
<li><p><strong>environment.yml</strong> (for conda and similar)</p></li>
</ul>
<p>You can export the dependencies from your current environment into these files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># inside a conda environment</span>
$<span class="w"> </span>conda<span class="w"> </span>env<span class="w"> </span><span class="nb">export</span><span class="w"> </span>--from-history<span class="w"> </span>&gt;<span class="w"> </span>environment.yml

<span class="c1"># inside a virtual environment</span>
$<span class="w"> </span>pip<span class="w"> </span>freeze<span class="w"> </span>&gt;<span class="w"> </span>requirements.txt
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>The dependencies in our <a class="reference external" href="https://github.com/workshop-material/planets">example
project</a> are listed in a
<a class="reference external" href="https://github.com/workshop-material/planets/blob/main/environment.yml">environment.yml</a>
file.</p></li>
<li><p>Shouldn’t the dependencies be pinned to specific versions?</p></li>
<li><p>When is a good time to pin them?</p></li>
</ul>
</div>
</section>
<section id="exercise">
<h5>Exercise<a class="headerlink" href="#exercise" title="Link to this heading"></a></h5>
<div class="admonition-exercise-time-capsule-of-dependencies exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Time-capsule of dependencies</p>
<p>Situation: 5 students (A, B, C, D, E) wrote a code that depends on a couple of libraries.
They uploaded their projects to GitHub. We now travel 3 years into the future
and find their GitHub repositories and try to re-run their code before adapting
it.</p>
<ul>
<li><p>Which version do you expect to be easiest to re-run? Why?</p></li>
<li><p>What problems do you anticipate in each solution?</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-Q29uZGE=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-Q29uZGE=" name="Q29uZGE=" role="tab" tabindex="0">Conda</button><button aria-controls="panel-0-UHl0aG9uIHZpcnR1YWxlbnY=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-UHl0aG9uIHZpcnR1YWxlbnY=" name="UHl0aG9uIHZpcnR1YWxlbnY=" role="tab" tabindex="-1">Python virtualenv</button></div><div aria-labelledby="tab-0-Q29uZGE=" class="sphinx-tabs-panel group-tab" id="panel-0-Q29uZGE=" name="Q29uZGE=" role="tabpanel" tabindex="0"><p><strong>A</strong>:
You find a couple of library imports across the code but that’s it.</p>
<p><strong>B</strong>:
The README file lists which libraries were used but does not mention
any versions.</p>
<p><strong>C</strong>:
You find a <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">student</span><span class="o">-</span><span class="n">project</span>
<span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>
<span class="n">dependencies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">scipy</span>
  <span class="o">-</span> <span class="n">numpy</span>
  <span class="o">-</span> <span class="n">sympy</span>
  <span class="o">-</span> <span class="n">click</span>
  <span class="o">-</span> <span class="n">python</span>
  <span class="o">-</span> <span class="n">pip</span>
  <span class="o">-</span> <span class="n">pip</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">someuser</span><span class="o">/</span><span class="n">someproject</span><span class="o">.</span><span class="n">git</span><span class="nd">@master</span>
    <span class="o">-</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">anotheruser</span><span class="o">/</span><span class="n">anotherproject</span><span class="o">.</span><span class="n">git</span><span class="nd">@master</span>
</pre></div>
</div>
<p><strong>D</strong>:
You find a <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">student</span><span class="o">-</span><span class="n">project</span>
<span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>
<span class="n">dependencies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">scipy</span><span class="o">=</span><span class="mf">1.3.1</span>
  <span class="o">-</span> <span class="n">numpy</span><span class="o">=</span><span class="mf">1.16.4</span>
  <span class="o">-</span> <span class="n">sympy</span><span class="o">=</span><span class="mf">1.4</span>
  <span class="o">-</span> <span class="n">click</span><span class="o">=</span><span class="mf">7.0</span>
  <span class="o">-</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.8</span>
  <span class="o">-</span> <span class="n">pip</span>
  <span class="o">-</span> <span class="n">pip</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">someuser</span><span class="o">/</span><span class="n">someproject</span><span class="o">.</span><span class="n">git</span><span class="nd">@d7b2c7e</span>
    <span class="o">-</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">anotheruser</span><span class="o">/</span><span class="n">anotherproject</span><span class="o">.</span><span class="n">git</span><span class="nd">@sometag</span>
</pre></div>
</div>
<p><strong>E</strong>:
You find a <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">student</span><span class="o">-</span><span class="n">project</span>
<span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>
<span class="n">dependencies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">scipy</span><span class="o">=</span><span class="mf">1.3.1</span>
  <span class="o">-</span> <span class="n">numpy</span><span class="o">=</span><span class="mf">1.16.4</span>
  <span class="o">-</span> <span class="n">sympy</span><span class="o">=</span><span class="mf">1.4</span>
  <span class="o">-</span> <span class="n">click</span><span class="o">=</span><span class="mf">7.0</span>
  <span class="o">-</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.8</span>
  <span class="o">-</span> <span class="n">someproject</span><span class="o">=</span><span class="mf">1.2.3</span>
  <span class="o">-</span> <span class="n">anotherproject</span><span class="o">=</span><span class="mf">2.3.4</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-UHl0aG9uIHZpcnR1YWxlbnY=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-UHl0aG9uIHZpcnR1YWxlbnY=" name="UHl0aG9uIHZpcnR1YWxlbnY=" role="tabpanel" tabindex="0"><p><strong>A</strong>:
You find a couple of library imports across the code but that’s it.</p>
<p><strong>B</strong>:
The README file lists which libraries were used but does not mention
any versions.</p>
<p><strong>C</strong>:
You find a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span>
<span class="n">numpy</span>
<span class="n">sympy</span>
<span class="n">click</span>
<span class="n">python</span>
<span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">someuser</span><span class="o">/</span><span class="n">someproject</span><span class="o">.</span><span class="n">git</span><span class="nd">@master</span>
<span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">anotheruser</span><span class="o">/</span><span class="n">anotherproject</span><span class="o">.</span><span class="n">git</span><span class="nd">@master</span>
</pre></div>
</div>
<p><strong>D</strong>:
You find a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">==</span><span class="mf">1.3.1</span>
<span class="n">numpy</span><span class="o">==</span><span class="mf">1.16.4</span>
<span class="n">sympy</span><span class="o">==</span><span class="mf">1.4</span>
<span class="n">click</span><span class="o">==</span><span class="mf">7.0</span>
<span class="n">python</span><span class="o">==</span><span class="mf">3.8</span>
<span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">someuser</span><span class="o">/</span><span class="n">someproject</span><span class="o">.</span><span class="n">git</span><span class="nd">@d7b2c7e</span>
<span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">anotheruser</span><span class="o">/</span><span class="n">anotherproject</span><span class="o">.</span><span class="n">git</span><span class="nd">@sometag</span>
</pre></div>
</div>
<p><strong>E</strong>:
You find a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">==</span><span class="mf">1.3.1</span>
<span class="n">numpy</span><span class="o">==</span><span class="mf">1.16.4</span>
<span class="n">sympy</span><span class="o">==</span><span class="mf">1.4</span>
<span class="n">click</span><span class="o">==</span><span class="mf">7.0</span>
<span class="n">python</span><span class="o">==</span><span class="mf">3.8</span>
<span class="n">someproject</span><span class="o">==</span><span class="mf">1.2.3</span>
<span class="n">anotherproject</span><span class="o">==</span><span class="mf">2.3.4</span>
</pre></div>
</div>
</div></div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p><strong>A</strong>: It will be tedious to collect the dependencies one by one. And after
the tedious process you will still not know which versions they have used.</p>
<p><strong>B</strong>: If there is no standard file to look for and look at and it might
become very difficult for to create the software environment required to
run the software. But at least we know the list of libraries. But we don’t
know the versions.</p>
<p><strong>C</strong>: Having a standard file listing dependencies is definitely better
than nothing. However, if the versions are not specified, you or someone
else might run into problems with dependencies, deprecated features,
changes in package APIs, etc.</p>
<p><strong>D</strong> and <strong>E</strong>: In both these cases exact versions of all dependencies are
specified and one can recreate the software environment required for the
project. One problem with the dependencies that come from GitHub is that
they might have disappeared (what if their authors deleted these
repositories?).</p>
<p><strong>E</strong> is slightly preferable because version numbers are easier to understand than Git
commit hashes or Git tags.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="containers">
<h5>Containers<a class="headerlink" href="#containers" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>A container is like an <strong>operating system inside a file</strong>.</p></li>
<li><p>“Building a container”: Container definition file (recipe) -&gt; Container image</p></li>
<li><p>Let us explore and discuss the <a class="reference external" href="https://github.com/workshop-material/planets/blob/main/container.def">container definition
file</a>
in our example project.</p></li>
<li><p>This can be used with <a class="reference external" href="https://apptainer.org/">Apptainer</a>/
<a class="reference external" href="https://sylabs.io/singularity/">SingularityCE</a>.</p></li>
</ul>
<p>Containers offer the following advantages:</p>
<ul class="simple">
<li><p><strong>Reproducibility</strong>: The same software environment can be recreated on
different computers. They force you to know and <strong>document all your dependencies</strong>.</p></li>
<li><p><strong>Portability</strong>: The same software environment can be run on different computers.</p></li>
<li><p><strong>Isolation</strong>: The software environment is isolated from the host system.</p></li>
<li><p>“<strong>Time travel</strong>”:</p>
<ul>
<li><p>You can run old/unmaintained software on new systems.</p></li>
<li><p>Code that needs new dependencies which are not available on old systems can
still be run on old systems.</p></li>
</ul>
</li>
</ul>
</section>
<section id="demonstration-building-a-container">
<h5>Demonstration: Building a container<a class="headerlink" href="#demonstration-building-a-container" title="Link to this heading"></a></h5>
<div class="admonition-demo-build-a-container-and-run-it-on-a-cluster exercise important admonition" id="exercise-1">
<p class="admonition-title">Demo: Build a container and run it on a cluster</p>
<p>Here we will try to build a container from
<a class="reference external" href="https://github.com/workshop-material/planets/blob/main/container.def">the definition file</a>
of our example project.</p>
<p>Requirements:</p>
<ol class="arabic simple">
<li><p>Linux (it is possible to build them on a macOS or Windows computer but it is
more complicated).</p></li>
<li><p>An installation of <a class="reference external" href="https://apptainer.org/">Apptainer</a> (e.g. following the
<a class="reference external" href="https://apptainer.org/docs/user/latest/quick_start.html#quick-installation">quick installation</a>).
Alternatively, <a class="reference external" href="https://sylabs.io/singularity/">SingularityCE</a> should also
work.</p></li>
</ol>
<p>Now you can build the container image from the container definition file.
Depending on the configuration you might need to run the command with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>
or with <code class="docutils literal notranslate"><span class="pre">--fakeroot</span></code>.</p>
<p>Hopefully one of these four will work:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>apptainer<span class="w"> </span>build<span class="w"> </span>container.sif<span class="w"> </span>container.def
<span class="gp">$ </span>apptainer<span class="w"> </span>build<span class="w"> </span>--fakeroot<span class="w"> </span>container.sif<span class="w"> </span>container.def

<span class="gp">$ </span>sudo<span class="w"> </span>singularity<span class="w"> </span>build<span class="w"> </span>container.sif<span class="w"> </span>container.def
<span class="gp">$ </span>singularity<span class="w"> </span>build<span class="w"> </span>--fakeroot<span class="w"> </span>container.sif<span class="w"> </span>container.def
</pre></div>
</div>
<p>Once you have the <code class="docutils literal notranslate"><span class="pre">container.sif</span></code>, copy it to a cluster and try to run it
there.</p>
<p>Here are two job script examples:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-RGFyZGVsIChTd2VkZW4p" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-RGFyZGVsIChTd2VkZW4p" name="RGFyZGVsIChTd2VkZW4p" role="tab" tabindex="0">Dardel (Sweden)</button><button aria-controls="panel-1-U2FnYSAoTm9yd2F5KQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-U2FnYSAoTm9yd2F5KQ==" name="U2FnYSAoTm9yd2F5KQ==" role="tab" tabindex="-1">Saga (Norway)</button></div><div aria-labelledby="tab-1-RGFyZGVsIChTd2VkZW4p" class="sphinx-tabs-panel group-tab" id="panel-1-RGFyZGVsIChTd2VkZW4p" name="RGFyZGVsIChTd2VkZW4p" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># the SBATCH directives and the module load below are only relevant for the</span>
<span class="c1"># Dardel cluster and the PDC Summer School; adapt them for your cluster</span>

<span class="c1">#SBATCH --account=edu24.summer</span>
<span class="c1">#SBATCH --job-name=&#39;container&#39;</span>
<span class="c1">#SBATCH --time=0-00:05:00</span>

<span class="c1">#SBATCH --partition=shared</span>

<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --tasks-per-node=1</span>
<span class="c1">#SBATCH --cpus-per-task=16</span>


module<span class="w"> </span>load<span class="w"> </span>PDC<span class="w"> </span>singularity


<span class="c1"># catch common shell script errors</span>
<span class="nb">set</span><span class="w"> </span>-euf<span class="w"> </span>-o<span class="w"> </span>pipefail


<span class="nb">echo</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;what is the operating system on the host?&quot;</span>
cat<span class="w"> </span>/etc/os-release


<span class="nb">echo</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;what is the operating system in the container?&quot;</span>
singularity<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>container.sif<span class="w"> </span>cat<span class="w"> </span>/etc/os-release


<span class="c1"># 1000 planets, 20 steps</span>
<span class="nb">time</span><span class="w"> </span>./container.sif<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="si">${</span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="si">}</span><span class="w"> </span>results
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U2FnYSAoTm9yd2F5KQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-U2FnYSAoTm9yd2F5KQ==" name="U2FnYSAoTm9yd2F5KQ==" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="c1">#SBATCH --account=nn9997k</span>
<span class="c1">#SBATCH --job-name=&#39;container&#39;</span>
<span class="c1">#SBATCH --time=0-00:05:00</span>

<span class="c1">#SBATCH --mem-per-cpu=1G</span>

<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --tasks-per-node=1</span>
<span class="c1">#SBATCH --cpus-per-task=16</span>


<span class="c1"># catch common shell script errors</span>
<span class="nb">set</span><span class="w"> </span>-euf<span class="w"> </span>-o<span class="w"> </span>pipefail


<span class="nb">echo</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;what is the operating system on the host?&quot;</span>
cat<span class="w"> </span>/etc/os-release


<span class="nb">echo</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;what is the operating system in the container?&quot;</span>
singularity<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>container.sif<span class="w"> </span>cat<span class="w"> </span>/etc/os-release


<span class="c1"># 1000 planets, 20 steps</span>
<span class="nb">time</span><span class="w"> </span>./container.sif<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="si">${</span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="si">}</span><span class="w"> </span>results
</pre></div>
</div>
</div></div>
</div>
</section>
<section id="where-to-explore-more">
<h5>Where to explore more<a class="headerlink" href="#where-to-explore-more" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p><a class="reference external" href="https://coderefinery.github.io/reproducible-research/">Reproducible research</a></p></li>
<li><p><a class="reference external" href="https://the-turing-way.netlify.app/reproducible-research/reproducible-research.html">The Turing Way: Guide for Reproducible Research</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1371/journal.pcbi.1008316">Ten simple rules for writing Dockerfiles for reproducible data science</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.5281/zenodo.8089471">Computing environment reproducibility</a></p></li>
<li><p><a class="reference external" href="https://carpentries-incubator.github.io/docker-introduction/">Carpentries incubator lesson on Docker</a></p></li>
<li><p><a class="reference external" href="https://carpentries-incubator.github.io/singularity-introduction/">Carpentries incubator lesson on Singularity/Apptainer</a></p></li>
</ul>
</section>
</section>
<span id="document-refactoring-concepts"></span><section id="concepts-in-refactoring-and-modular-code-design">
<span id="refactoring-concepts"></span><h4>Concepts in refactoring and modular code design<a class="headerlink" href="#concepts-in-refactoring-and-modular-code-design" title="Link to this heading"></a></h4>
<section id="starting-questions-for-the-collaborative-document">
<h5>Starting questions for the collaborative document<a class="headerlink" href="#starting-questions-for-the-collaborative-document" title="Link to this heading"></a></h5>
<ol class="arabic simple">
<li><p>What does “modular code development” mean for you?</p></li>
<li><p>What best practices can you recommend to arrive at well structured,
modular code in your favourite programming language?</p></li>
<li><p>What do you know now about programming that you wish somebody told you
earlier?</p></li>
<li><p>Do you design a new code project on paper before coding? Discuss pros and
cons.</p></li>
<li><p>Do you build your code top-down (starting from the big picture) or
bottom-up (starting from components)? Discuss pros and cons.</p></li>
<li><p>Would you prefer your code to be 2x slower if it was easier to read and
understand?</p></li>
</ol>
</section>
<section id="pure-functions">
<h5>Pure functions<a class="headerlink" href="#pure-functions" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Pure functions have no notion of state: They take input values and return
values</p></li>
<li><p><strong>Given the same input, a pure function always returns the same value</strong></p></li>
<li><p>Function calls can be optimized away</p></li>
<li><p>Pure function == data</p></li>
</ul>
<p>a) pure: no side effects</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fahrenheit_to_celsius</span><span class="p">(</span><span class="n">temp_f</span><span class="p">):</span>
    <span class="n">temp_c</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_f</span> <span class="o">-</span> <span class="mf">32.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">9.0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">temp_c</span>

<span class="n">temp_c</span> <span class="o">=</span> <span class="n">fahrenheit_to_celsius</span><span class="p">(</span><span class="n">temp_f</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">temp_c</span><span class="p">)</span>
</pre></div>
</div>
<p>b) stateful: side effects</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f_to_c_offset</span> <span class="o">=</span> <span class="mf">32.0</span>
<span class="n">f_to_c_factor</span> <span class="o">=</span> <span class="mf">0.555555555</span>
<span class="n">temp_c</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="k">def</span> <span class="nf">fahrenheit_to_celsius_bad</span><span class="p">(</span><span class="n">temp_f</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">temp_c</span>
    <span class="n">temp_c</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_f</span> <span class="o">-</span> <span class="n">f_to_c_offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">f_to_c_factor</span>

<span class="n">fahrenheit_to_celsius_bad</span><span class="p">(</span><span class="n">temp_f</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">temp_c</span><span class="p">)</span>
</pre></div>
</div>
<p>Pure functions are easier to:</p>
<ul class="simple">
<li><p>Test</p></li>
<li><p>Understand</p></li>
<li><p>Reuse</p></li>
<li><p>Parallelize</p></li>
<li><p>Simplify</p></li>
<li><p>Optimize</p></li>
<li><p>Compose</p></li>
</ul>
<p>Mathematical functions are pure:</p>
<div class="math notranslate nohighlight">
\[f(x, y) = x - x^2 + x^3 + y^2 + xy\]</div>
<div class="math notranslate nohighlight">
\[(f \circ g)(x) = f(g(x))\]</div>
<p>Unix shell commands are stateless:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cat<span class="w"> </span>somefile<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>somestring<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span><span class="p">|</span><span class="w"> </span>...
</pre></div>
</div>
</section>
<section id="but-i-o-and-network-and-disk-and-databases-are-not-pure">
<h5>But I/O and network and disk and databases are not pure!<a class="headerlink" href="#but-i-o-and-network-and-disk-and-databases-are-not-pure" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>I/O is impure</p></li>
<li><p>Keep I/O on the “outside” of your code</p></li>
<li><p>Keep the “inside” of your code pure/stateless</p></li>
</ul>
<figure class="align-default">
<img alt="Image comparing code that is mostly impure to code where the impure parts are on the outside" src="_images/good-vs-bad.svg" />
</figure>
</section>
<section id="from-classes-to-functions">
<h5>From classes to functions<a class="headerlink" href="#from-classes-to-functions" title="Link to this heading"></a></h5>
<p>Object-oriented programming and functional programming <strong>both have their place
and value</strong>.</p>
<p>Here is an example of expressing the same thing in Python in 4 different ways.
Which one do you prefer?</p>
<ol class="arabic">
<li><p>As a <strong>class</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>


<span class="k">class</span> <span class="nc">Moon</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">contains_water</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>  <span class="c1"># in kilometers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contains_water</span> <span class="o">=</span> <span class="n">contains_water</span>

    <span class="k">def</span> <span class="nf">surface_area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the surface area of the moon assuming a spherical shape.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Moon(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2">, radius=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="si">}</span><span class="s2">, contains_water=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">contains_water</span><span class="si">}</span><span class="s2">)&quot;</span>


<span class="n">europa</span> <span class="o">=</span> <span class="n">Moon</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Europa&quot;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1560.8</span><span class="p">,</span> <span class="n">contains_water</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">europa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Surface area (km^2) of </span><span class="si">{</span><span class="n">europa</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">europa</span><span class="o">.</span><span class="n">surface_area</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>As a <strong>dataclass</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">import</span> <span class="nn">math</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Moon</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># in kilometers</span>
    <span class="n">contains_water</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">surface_area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the surface area of the moon assuming a spherical shape.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">**</span><span class="mi">2</span>


<span class="n">europa</span> <span class="o">=</span> <span class="n">Moon</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Europa&quot;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1560.8</span><span class="p">,</span> <span class="n">contains_water</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">europa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Surface area (km^2) of </span><span class="si">{</span><span class="n">europa</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">europa</span><span class="o">.</span><span class="n">surface_area</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>As a <strong>named tuple</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>


<span class="k">def</span> <span class="nf">surface_area</span><span class="p">(</span><span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span>


<span class="n">Moon</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;Moon&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;radius&quot;</span><span class="p">,</span> <span class="s2">&quot;contains_water&quot;</span><span class="p">])</span>


<span class="n">europa</span> <span class="o">=</span> <span class="n">Moon</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Europa&quot;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1560.8</span><span class="p">,</span> <span class="n">contains_water</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">europa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Surface area (km^2) of </span><span class="si">{</span><span class="n">europa</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">surface_area</span><span class="p">(</span><span class="n">europa</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>As a <strong>dict</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>


<span class="k">def</span> <span class="nf">surface_area</span><span class="p">(</span><span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span>


<span class="n">europa</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Europa&quot;</span><span class="p">,</span> <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="mf">1560.8</span><span class="p">,</span> <span class="s2">&quot;contains_water&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>


<span class="nb">print</span><span class="p">(</span><span class="n">europa</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Surface area (km^2) of </span><span class="si">{</span><span class="n">europa</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">surface_area</span><span class="p">(</span><span class="n">europa</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="how-to-design-your-code-before-writing-it">
<h5>How to design your code before writing it<a class="headerlink" href="#how-to-design-your-code-before-writing-it" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Document-driven development can be a nice approach:</p>
<ul>
<li><p>Write the documentation/tutorial first</p></li>
<li><p>Write the code to make the documentation true</p></li>
<li><p>Refactor the code to make it clean and maintainable</p></li>
</ul>
</li>
<li><p>But also it’s almost impossible to design everything correctly from the
start -&gt; make it easy to change -&gt; keep it simple</p></li>
</ul>
</section>
</section>
<span id="document-refactoring-demo"></span><section id="demo-from-a-script-towards-a-workflow">
<span id="refactoring-demo"></span><h4>Demo: From a script towards a workflow<a class="headerlink" href="#demo-from-a-script-towards-a-workflow" title="Link to this heading"></a></h4>
<p>In this episode we will explore code quality and good practices in Python using
a hands-on approach. We will together build up a small project and improve it
step by step.</p>
<p>We will start from a relatively simple image processing script which can read a
telescope image of stars and our goal is to <strong>count the number of stars</strong> in
the image. Later we will want to be able to process many such images.</p>
<p>The (fictional) telescope images look like the one below here (<a class="reference external" href="https://github.com/workshop-material/random-star-images">in this
repository</a> we can find more):</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/stars.png"><img alt="Generated image representing a telescope image of stars" src="_images/stars.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-text">Generated image representing a telescope image of stars.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-rough-plan-for-this-demo admonition">
<p class="admonition-title">Rough plan for this demo</p>
<ul class="simple">
<li><p>(15 min) Discuss how we would solve the problem, run example code, and make it work (as part of a Jupyter notebook)?</p></li>
<li><p>(15 min) Refactor the positioning code into a function and a module</p></li>
<li><p>(15 min) Now we wish to process many images - discuss how we would approach this</p></li>
<li><p>(15 min) Introduce CLI and discuss the benefits</p></li>
<li><p>(30 min) From a script to a workflow (using Snakemake)</p></li>
</ul>
</div>
<div class="admonition-starting-point-spoiler-alert solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Starting point (spoiler alert)</p>
<p>We can imagine that we pieced together the following code
based on some examples we found online:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">io</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">color</span>
<span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">label</span><span class="p">,</span> <span class="n">regionprops</span>


<span class="n">image</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;stars.png&quot;</span><span class="p">)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1"># if there is a fourth channel (alpha channel), ignore it</span>
<span class="n">rgb_image</span> <span class="o">=</span> <span class="n">image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">gray_image</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">rgb_image</span><span class="p">)</span>

<span class="c1"># apply a gaussian filter to reduce noise</span>
<span class="n">image_smooth</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">gray_image</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

<span class="c1"># threshold the image to create a binary image (bright stars will be white, background black)</span>
<span class="n">thresh</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">threshold_otsu</span><span class="p">(</span><span class="n">image_smooth</span><span class="p">)</span>
<span class="n">binary_image</span> <span class="o">=</span> <span class="n">image_smooth</span> <span class="o">&gt;</span> <span class="n">thresh</span>

<span class="c1"># label connected regions (stars) in the binary image</span>
<span class="n">labeled_image</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">binary_image</span><span class="p">)</span>

<span class="c1"># get properties of labeled regions</span>
<span class="n">regions</span> <span class="o">=</span> <span class="n">regionprops</span><span class="p">(</span><span class="n">labeled_image</span><span class="p">)</span>

<span class="c1"># extract star positions (centroids)</span>
<span class="n">star_positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">region</span><span class="o">.</span><span class="n">centroid</span> <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">]</span>

<span class="c1"># plot the original image</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

<span class="c1"># overlay star positions with crosses</span>
<span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">star_positions</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">star</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">star</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;rx&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;detected-stars.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of stars detected: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">star_positions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="plan">
<h5>Plan<a class="headerlink" href="#plan" title="Link to this heading"></a></h5>
<p>Topics we wish to show and discuss:</p>
<ul class="simple">
<li><p>Naming (and other) conventions, project organization, modularity</p></li>
<li><p>The value of pure functions and immutability</p></li>
<li><p>Refactoring (explained through examples)</p></li>
<li><p>Auto-formatting and linting with tools like black, vulture, ruff</p></li>
<li><p>Moving a project under Git</p></li>
<li><p>How to document dependencies</p></li>
<li><p>Structuring larger software projects in a modular way</p></li>
<li><p>Command-line interfaces</p></li>
<li><p>Workflows with Snakemake</p></li>
</ul>
<p>We will work together on the code on the big screen, and participants will be
encouraged to give suggestions and ask questions.  We will <strong>end up with a Git
repository</strong> which will be shared with workshop participants.</p>
</section>
<section id="possible-solutions">
<h5>Possible solutions<a class="headerlink" href="#possible-solutions" title="Link to this heading"></a></h5>
<div class="admonition-script-after-some-work-with-command-line-interface-spoiler-alert solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Script after some work, with command-line interface (spoiler alert)</p>
<p>This is one possible solution (<code class="docutils literal notranslate"><span class="pre">countstars.py</span></code>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">click</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">io</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">color</span>
<span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">label</span><span class="p">,</span> <span class="n">regionprops</span>


<span class="k">def</span> <span class="nf">convert_to_gray</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="c1"># if there is a fourth channel (alpha channel), ignore it</span>
    <span class="n">rgb_image</span> <span class="o">=</span> <span class="n">image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">color</span><span class="o">.</span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">rgb_image</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">locate_positions</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">gray_image</span> <span class="o">=</span> <span class="n">convert_to_gray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="c1"># apply a gaussian filter to reduce noise</span>
    <span class="n">image_smooth</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">gray_image</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># threshold the image to create a binary image (bright objects will be white, background black)</span>
    <span class="n">thresh</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">threshold_otsu</span><span class="p">(</span><span class="n">image_smooth</span><span class="p">)</span>
    <span class="n">binary_image</span> <span class="o">=</span> <span class="n">image_smooth</span> <span class="o">&gt;</span> <span class="n">thresh</span>

    <span class="c1"># label connected regions in the binary image</span>
    <span class="n">labeled_image</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">binary_image</span><span class="p">)</span>

    <span class="c1"># get properties of labeled regions</span>
    <span class="n">regions</span> <span class="o">=</span> <span class="n">regionprops</span><span class="p">(</span><span class="n">labeled_image</span><span class="p">)</span>

    <span class="c1"># extract positions (centroids)</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">region</span><span class="o">.</span><span class="n">centroid</span> <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">positions</span>


<span class="k">def</span> <span class="nf">plot_positions</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
    <span class="c1"># plot the original image</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

    <span class="c1"># overlay positions with crosses</span>
    <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;rx&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
    <span class="s2">&quot;--image-file&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">click</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">exists</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to the input image&quot;</span>
<span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;--output-file&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">click</span><span class="o">.</span><span class="n">Path</span><span class="p">(),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to the output file&quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;--generate-plot&quot;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">image_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">generate_plot</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_file</span><span class="p">)</span>

    <span class="n">star_positions</span> <span class="o">=</span> <span class="n">locate_positions</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">generate_plot</span><span class="p">:</span>
        <span class="n">plot_positions</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">star_positions</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;detected-</span><span class="si">{</span><span class="n">image_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of stars detected: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">star_positions</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="admonition-snakemake-rules-which-define-a-workflow-spoiler-alert solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Snakemake rules which define a workflow (spoiler alert)</p>
<p>This is one possible solution (<code class="docutils literal notranslate"><span class="pre">snakefile</span></code>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># the comma is there because glob_wildcards returns a named tuple</span>
<span class="n">numbers</span><span class="p">,</span> <span class="o">=</span> <span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;input-images/stars-</span><span class="si">{number}</span><span class="s2">.png&quot;</span><span class="p">)</span>


<span class="c1"># rule that collects the target files</span>
<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;results/</span><span class="si">{number}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="n">numbers</span><span class="p">)</span>


<span class="n">rule</span> <span class="n">process_data</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s2">&quot;input-images/stars-</span><span class="si">{number}</span><span class="s2">.png&quot;</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="s2">&quot;results/</span><span class="si">{number}</span><span class="s2">.txt&quot;</span>
    <span class="n">log</span><span class="p">:</span>
        <span class="s2">&quot;logs/</span><span class="si">{number}</span><span class="s2">.txt&quot;</span>
    <span class="n">shell</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        python countstars.py --image-file {input} --output-file {output}</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>We can process as many images as we like by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">4</span><span class="w">  </span><span class="c1"># adjust to the number of available cores</span>
</pre></div>
</div>
</div>
</section>
</section>
<span id="document-software-licensing"></span><section id="choosing-a-software-license">
<span id="software-licensing"></span><h4>Choosing a software license<a class="headerlink" href="#choosing-a-software-license" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Knowing about what derivative work is and whether we can share it.</p></li>
<li><p>Get familiar with terminology around licensing.</p></li>
<li><p>We will add a license to our example project.</p></li>
</ul>
</div>
<section id="copyright-and-derivative-work-sampling-remixing">
<h5>Copyright and derivative work: Sampling/remixing<a class="headerlink" href="#copyright-and-derivative-work-sampling-remixing" title="Link to this heading"></a></h5>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/record-player.png"><img alt="Generated image of a monk operating a record player" src="_images/record-player.png" style="width: 50%;" /></a>
</figure>
<p>[Midjourney, CC-BY-NC 4.0]</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/turntable.png"><img alt="Generated image of a monk operating two record players" src="_images/turntable.png" style="width: 50%;" /></a>
</figure>
<p>[Midjourney, CC-BY-NC 4.0]</p>
<ul class="simple">
<li><p>Copyright controls whether and how we can distribute
the original work or the <strong>derivative work</strong>.</p></li>
<li><p>In the <strong>context of software</strong> it is more about
being able to change and <strong>distribute changes</strong>.</p></li>
<li><p>Changing and distributing software is similar to changing and distributing
music</p></li>
<li><p>You can do almost anything if you don’t distribute it</p></li>
</ul>
<p><strong>Often we don’t have the choice</strong>:</p>
<ul class="simple">
<li><p>We are expected to publish software</p></li>
<li><p>Sharing can be good insurance against being locked out</p></li>
</ul>
<p><strong>Can we distribute our changes</strong> with the research community or our future selves?</p>
</section>
<section id="why-software-licenses-matter">
<h5>Why software licenses matter<a class="headerlink" href="#why-software-licenses-matter" title="Link to this heading"></a></h5>
<p>You find some great code that you want to reuse for your own publication.</p>
<ul class="simple">
<li><p>This is good for the original author - you will cite them. Maybe other people who cite you will cite them.</p></li>
<li><p>You modify and remix the code.</p></li>
<li><p>Two years later … ⌛</p></li>
<li><p>Time to publish: You realize <strong>there is no license to the original work</strong> 😱</p></li>
</ul>
<p><strong>Now we have a problem</strong>:</p>
<ul class="simple">
<li><p>😬 “Best” case: You manage to publish the paper without the software/data.
Others cannot build on your software and data.</p></li>
<li><p>😱 Worst case: You cannot publish it at all.
Journal requires that papers should come with data and software so that they are reproducible.</p></li>
</ul>
</section>
<section id="taxonomy-of-software-licenses">
<h5>Taxonomy of software licenses<a class="headerlink" href="#taxonomy-of-software-licenses" title="Link to this heading"></a></h5>
<figure class="align-default" id="id1">
<img alt="European Union Public Licence (EUPL): guidelines July 2021" src="_images/license-models.png" />
<figcaption>
<p><span class="caption-text">European Commission, Directorate-General for Informatics, Schmitz, P., European Union Public Licence (EUPL): guidelines July 2021, Publications Office, 2021, <a class="reference external" href="https://data.europa.eu/doi/10.2799/77160">https://data.europa.eu/doi/10.2799/77160</a></span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Comments:</p>
<ul class="simple">
<li><p>Arrows represent compatibility (A -&gt; B: B can reuse A)</p></li>
<li><p>Proprietary/custom: Derivative work typically not possible (no arrow goes from proprietary to open)</p></li>
<li><p>Permissive: Derivative work does not have to be shared</p></li>
<li><p>Copyleft/reciprocal: Derivative work must be made available under the same license terms</p></li>
<li><p>NC (non-commercial) and ND (non-derivative) exist for data licenses but not really for software licenses</p></li>
</ul>
<p><strong>Great resource for comparing software licenses</strong>: <a class="reference external" href="https://joinup.ec.europa.eu/collection/eupl/solution/joinup-licensing-assistant/jla-find-and-compare-software-licenses">Joinup Licensing Assistant</a></p>
<ul class="simple">
<li><p>Provides comments on licenses</p></li>
<li><p>Easy to compare licenses (<a class="reference external" href="https://joinup.ec.europa.eu/licence/compare/BSD-3-Clause;Apache-2.0">example</a>)</p></li>
<li><p><a class="reference external" href="https://joinup.ec.europa.eu/collection/eupl/solution/joinup-licensing-assistant/jla-compatibility-checker">Joinup Licensing Assistant - Compatibility Checker</a></p></li>
<li><p>Not biased by some company agenda</p></li>
</ul>
</section>
<section id="exercise-demo">
<h5>Exercise/demo<a class="headerlink" href="#exercise-demo" title="Link to this heading"></a></h5>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<ul class="simple">
<li><p>Let us choose a license for our example project.</p></li>
<li><p>We will add a LICENSE to the repository.</p></li>
</ul>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>What if my code uses libraries like <code class="docutils literal notranslate"><span class="pre">scikit-image</span></code>, <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy</span></code>,
<code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, etc. Do we need to look at their licenses? In other words,
<strong>is our project derivative work</strong> of something else?</p></li>
</ul>
</div>
</section>
<section id="more-resources">
<h5>More resources<a class="headerlink" href="#more-resources" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Presentation slides “Practical software licensing” (R. Bast): <a class="reference external" href="https://doi.org/10.5281/zenodo.11554001">https://doi.org/10.5281/zenodo.11554001</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/social-coding/">Social coding lesson material</a></p></li>
<li><p><a class="reference external" href="https://research-software.uit.no/blog/2023-software-licensing-guide/">UiT research software licensing guide (draft)</a></p></li>
<li><p><a class="reference external" href="https://www.researchsoft.org/software-policies/">Research institution policies to support research software (compiled by the Research Software Alliance)</a></p></li>
<li><p>More <a class="reference external" href="https://coderefinery.github.io/social-coding/software-licensing/#great-resources">reading material</a></p></li>
</ul>
</section>
<section id="more-exercises">
<h5>More exercises<a class="headerlink" href="#more-exercises" title="Link to this heading"></a></h5>
<div class="admonition-exercise-what-constitutes-derivative-work exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise: What constitutes derivative work?</p>
<p>Which of these are derivative works?  Also reflect/discuss how this affects the
choice of license.</p>
<ul class="simple">
<li><p>A. Download some code from a website and add on to it</p></li>
<li><p>B. Download some code and use one of the functions in your code</p></li>
<li><p>C. Changing code you got from somewhere</p></li>
<li><p>D. Extending code you got from somewhere</p></li>
<li><p>E. Completely rewriting code you got from somewhere</p></li>
<li><p>F. Rewriting code to a different programming language</p></li>
<li><p>G. Linking to libraries (static or dynamic), plug-ins, and drivers</p></li>
<li><p>H. Clean room design (somebody explains you the code but you have never seen it)</p></li>
<li><p>I. You read a paper, understand algorithm, write own code</p></li>
</ul>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ul class="simple">
<li><p>Derivative work: A-F</p></li>
<li><p>Not derivative work: G-I</p></li>
<li><p>E and F: This depends on how you do it, see “clean room design”.</p></li>
</ul>
</div>
</div>
<div class="admonition-exercise-licensing-situations exercise important admonition" id="exercise-2">
<p class="admonition-title">Exercise: Licensing situations</p>
<p>Consider some common licensing situations. If you are part of an exercise
group, discuss these with others:</p>
<ol class="arabic simple">
<li><p>What is the StackOverflow license for code you copy and paste?</p></li>
<li><p>A journal requests that you release your software during publication. You have
copied a portion of the code from another package, which you have forgotten.
Can you satisfy the journal’s request?</p></li>
<li><p>You want to fix a bug in a project someone else has released, but there is no license. What risks are there?</p></li>
<li><p>How would you ask someone to add a license?</p></li>
<li><p>You incorporate MIT, GPL, and BSD3 licensed code into your project. What possible licenses can you pick for your project?</p></li>
<li><p>You do the same as above but add in another license that looks strong copyleft. What possible licenses can you use now?</p></li>
<li><p>Do licenses apply if you don’t distribute your code? Why or why not?</p></li>
<li><p>Which licenses are most/least attractive for companies with proprietary software?</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<ol class="arabic simple">
<li><p>As indicated <a class="reference external" href="https://stackoverflow.com/help/licensing">here</a>, all publicly accessible user contributions are licensed under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> license. See Stackoverflow <a class="reference external" href="https://stackoverflow.com/legal/terms-of-service/public#licensing">Terms of service</a> for more detailed information.</p></li>
<li><p>“Standard” licensing rules apply. So in this case, you would need to remove the portion of code you have copied from another package before being able to release your software.</p></li>
<li><p>By default you are no authorized to use the content of a repository when there is no license. And derivative work is also not possible by default. Other risks: it may not be clear whether you can use and distribute (publish) the bugfixed code. For the repo owners it may not be clear whether they can use and distributed the bugfixed code. However, the authors may have forgotten to add a license so we suggest you to contact the authors (e.g. make an issue) and ask whether they are willing to add a license.</p></li>
<li><p>As mentionned in 3., the easiest is to fill an issue and explain the reasons why you would like to use this software (or update it).</p></li>
<li><p>Combining software with different licenses can be tricky and it is important to understand compatibilities (or lack of compatibilities) of the various licenses. GPL license is the most protective (BSD and MIT are quite permissive) so for the resulting combined software you could use a GPL license. However, re-licensing may not be necessary.</p></li>
<li><p>Derivative work would need to be shared under this strong copyleft license (e.g. AGPL or GPL), unless the components are only plugins or libraries.</p></li>
<li><p>If you keep your code for yourself, you may think you do not need a license. However, remember that in most companies/universities, your employer is “owning” your work and when you leave you may not be allowed to “distribute your code to your future self”. So the best is always to add a license!</p></li>
<li><p>The least attractive licenses for companies with proprietary software are licenses where you would need to keep an open license when creating derivative work. For instance GPL and and AGPL. The most attractive licenses are permissive licenses where they can reuse, modify and relicense with no conditions. For instance MIT, BSD and Apache License.</p></li>
</ol>
</div>
</div>
</section>
</section>
<span id="document-publishing"></span><section id="how-to-publish-your-code">
<span id="publishing"></span><h4>How to publish your code<a class="headerlink" href="#how-to-publish-your-code" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Make our code citable and persistent.</p></li>
<li><p>Make our Notebook reusable and persistent.</p></li>
</ul>
</div>
<section id="is-putting-software-on-github-gitlab-publishing">
<h5>Is putting software on GitHub/GitLab/… publishing?<a class="headerlink" href="#is-putting-software-on-github-gitlab-publishing" title="Link to this heading"></a></h5>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/8-fair-principles.jpg"><img alt="FAIR principles" src="_images/8-fair-principles.jpg" style="width: 70%;" /></a>
<figcaption>
<p><span class="caption-text">FAIR principles. (c) <a class="reference external" href="http://www.scriberia.co.uk">Scriberia</a> for <a class="reference external" href="https://the-turing-way.netlify.com">The Turing Way</a>, CC-BY.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Is it enough to make the code public for the code to remain <strong>findable and accessible</strong>?</p>
<ul class="simple">
<li><p>No. Because nothing prevents me from deleting my GitHub repository or
rewriting the Git history and we have no guarantee that GitHub will still be around in 10 years.</p></li>
<li><p><strong>Make your code citable and persistent</strong>:
Get a persistent identifier (PID) such as DOI in addition to sharing the
code publicly, by using services like <a class="reference external" href="https://zenodo.org">Zenodo</a> or
similar services.</p></li>
</ul>
</section>
<section id="how-to-make-your-software-citable">
<h5>How to make your software citable<a class="headerlink" href="#how-to-make-your-software-citable" title="Link to this heading"></a></h5>
<div class="admonition-discussion-citation-1-explain-how-you-currently-cite-software discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion (Citation-1): Explain how you currently cite software</p>
<ul class="simple">
<li><p>Do you cite software that you use? How?</p></li>
<li><p>If I wanted to cite your code/scripts, what would I need to do?</p></li>
</ul>
</div>
<p><strong>Checklist for making a release of your software citable</strong>:</p>
<ul class="simple">
<li><p>Assigned an appropriate license</p></li>
<li><p>Described the software using an appropriate metadata format</p></li>
<li><p>Clear version number</p></li>
<li><p>Authors credited</p></li>
<li><p>Procured a persistent identifier</p></li>
<li><p>Added a recommended citation to the software documentation</p></li>
</ul>
<p>This checklist is adapted from: N. P. Chue Hong, A. Allen, A. Gonzalez-Beltran,
et al., Software Citation Checklist for Developers (Version 0.9.0). Zenodo.
2019b. (<a class="reference external" href="https://doi.org/10.5281/zenodo.3482769">DOI</a>)</p>
<p><strong>Our practical recommendations</strong>:</p>
<ul class="simple">
<li><p>Add a file called <a class="reference external" href="https://citation-file-format.github.io/">CITATION.cff</a> (<a class="reference external" href="https://github.com/bast/runtest/blob/main/CITATION.cff">example</a>).</p></li>
<li><p>Get a <a class="reference external" href="https://en.wikipedia.org/wiki/Digital_object_identifier">digital object identifier
(DOI)</a> for your code
on <a class="reference external" href="https://zenodo.org/">Zenodo</a> (<a class="reference external" href="https://zenodo.org/record/8003695">example</a>).</p></li>
<li><p>Make it as easy as possible: clearly say what you want cited.</p></li>
</ul>
<p>This is an example of a simple <code class="docutils literal notranslate"><span class="pre">CITATION.cff</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cff-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.2.0</span>
<span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;If</span><span class="nv"> </span><span class="s">you</span><span class="nv"> </span><span class="s">use</span><span class="nv"> </span><span class="s">this</span><span class="nv"> </span><span class="s">software,</span><span class="nv"> </span><span class="s">please</span><span class="nv"> </span><span class="s">cite</span><span class="nv"> </span><span class="s">it</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">below.&quot;</span>
<span class="nt">authors</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">family-names</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Doe</span>
<span class="w">    </span><span class="nt">given-names</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Jane</span>
<span class="w">    </span><span class="nt">orcid</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://orcid.org/1234-5678-9101-1121</span>
<span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;My</span><span class="nv"> </span><span class="s">Research</span><span class="nv"> </span><span class="s">Software&quot;</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.0.4</span>
<span class="nt">doi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.5281/zenodo.1234</span>
<span class="nt">date-released</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2021-08-11</span>
</pre></div>
</div>
<p>More about <code class="docutils literal notranslate"><span class="pre">CITATION.cff</span></code> files:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/about-citation-files">GitHub now supports CITATION.cff files</a></p></li>
<li><p><a class="reference external" href="https://citation-file-format.github.io/cff-initializer-javascript/">Web form to create, edit, and validate CITATION.cff files</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=zcgLIT5Qd4M">Video: “How to create a CITATION.cff using cffinit”</a></p></li>
</ul>
</section>
<section id="papers-with-focus-on-scientific-software">
<h5>Papers with focus on scientific software<a class="headerlink" href="#papers-with-focus-on-scientific-software" title="Link to this heading"></a></h5>
<p>Where can I publish papers which are primarily focused on my scientific
software?  Great list/summary is provided in this blog post: <a class="reference external" href="https://www.software.ac.uk/top-tip/which-journals-should-i-publish-my-software">“In which
journals should I publish my software?” (Neil P. Chue
Hong)</a></p>
</section>
<section id="how-to-cite-software">
<h5>How to cite software<a class="headerlink" href="#how-to-cite-software" title="Link to this heading"></a></h5>
<div class="admonition-great-resources admonition">
<p class="admonition-title">Great resources</p>
<ul class="simple">
<li><p>A. M. Smith, D. S. Katz, K. E. Niemeyer, and FORCE11 Software Citation
Working Group, “Software citation principles,” PeerJ Comput. Sci., vol. 2,
no. e86, 2016 (<a class="reference external" href="https://doi.org/10.7717/peerj-cs.86">DOI</a>)</p></li>
<li><p>D. S. Katz, N. P. Chue Hong, T. Clark, et al., Recognizing the value of
software: a software citation guide [version 2; peer review: 2 approved].
F1000Research 2021, 9:1257 (<a class="reference external" href="https://doi.org/10.12688/f1000research.26932.2">DOI</a>)</p></li>
<li><p>N. P. Chue Hong, A. Allen, A. Gonzalez-Beltran, et al., Software Citation
Checklist for Authors (Version 0.9.0). Zenodo. 2019a. (<a class="reference external" href="https://doi.org/10.5281/zenodo.3479199">DOI</a>)</p></li>
<li><p>N. P. Chue Hong, A. Allen, A. Gonzalez-Beltran, et al., Software Citation
Checklist for Developers (Version 0.9.0). Zenodo. 2019b. (<a class="reference external" href="https://doi.org/10.5281/zenodo.3482769">DOI</a>)</p></li>
</ul>
</div>
<p>Recommended format for software citation is to ensure the following information
is provided as part of the reference (from <a class="reference external" href="https://doi.org/10.12688/f1000research.26932.2">Katz, Chue Hong, Clark,
2021</a> which also contains
software citation examples):</p>
<ul class="simple">
<li><p>Creator</p></li>
<li><p>Title</p></li>
<li><p>Publication venue</p></li>
<li><p>Date</p></li>
<li><p>Identifier</p></li>
<li><p>Version</p></li>
<li><p>Type</p></li>
</ul>
</section>
<section id="exercise-demo">
<h5>Exercise/demo<a class="headerlink" href="#exercise-demo" title="Link to this heading"></a></h5>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<ul class="simple">
<li><p>We will add a <code class="docutils literal notranslate"><span class="pre">CITATION.cff</span></code> file to our example repository.</p></li>
<li><p>We will get a DOI using the <a class="reference external" href="https://sandbox.zenodo.org">Zenodo sandbox</a>:</p>
<ul>
<li><p>We will log into the <a class="reference external" href="https://sandbox.zenodo.org">Zenodo sandbox</a> using
GitHub.</p></li>
<li><p>We will follow <a class="reference external" href="https://docs.github.com/en/repositories/archiving-a-github-repository/referencing-and-citing-content">these steps</a>
and finally create a GitHub release and get a DOI.</p></li>
</ul>
</li>
<li><p>We will use the <a class="reference external" href="https://github.com/coderefinery/imgfilters">Binder badge on our example repository</a> to run the Notebook
in the cloud and discuss how we could make it persistent and citable.</p></li>
</ul>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Why did we use the Zenodo sandbox and not the “real” Zenodo for our exercise?</p></li>
</ul>
</div>
</section>
<section id="more-resources">
<h5>More resources<a class="headerlink" href="#more-resources" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p><a class="reference external" href="https://coderefinery.github.io/social-coding/software-citation/">Social coding lesson material</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/jupyter/sharing/">Sharing Jupiter Notebooks</a></p></li>
</ul>
</section>
</section>
<span id="document-packaging"></span><section id="creating-a-python-package-and-deploying-it-to-pypi">
<span id="packaging"></span><h4>Creating a Python package and deploying it to PyPI<a class="headerlink" href="#creating-a-python-package-and-deploying-it-to-pypi" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<p>In this episode we will create a pip-installable Python package and learn how
to deploy it to PyPI. As example, we will use the star counting script which
we created in the previous episode.</p>
</div>
<section id="creating-a-python-package-with-the-help-of-flit">
<h5>Creating a Python package with the help of flit<a class="headerlink" href="#creating-a-python-package-with-the-help-of-flit" title="Link to this heading"></a></h5>
<p>There are unfortunately many ways to package a Python project:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">setuptools</span></code> is the most common way to package a Python project. It is very
powerful and flexible, but also can get complex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flit</span></code> is a simpler alternative to <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>. It is less powerful, but
also easier to use.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">poetry</span></code> is a modern packaging tool which is more powerful than <code class="docutils literal notranslate"><span class="pre">flit</span></code> and
also easier to use than <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">twine</span></code> is another tool to upload packages to PyPI.</p></li>
<li><p>…</p></li>
</ul>
<div class="admonition-this-will-be-a-demo admonition">
<p class="admonition-title">This will be a demo</p>
<ul>
<li><p>We will try to package the code together on the big screen.</p></li>
<li><p>We will share the result on GitHub so that you can retrace the steps.</p></li>
<li><p>In this demo, we will use Flit to package the code. From <a class="reference external" href="https://flit.pypa.io/en/latest/rationale.html">Why use Flit?</a>:</p>
<blockquote>
<div><p>Make the easy things easy and the hard things possible is an old motto from
the Perl community. Flit is entirely focused on the easy things part of that,
and leaves the hard things up to other tools.</p>
</div></blockquote>
</li>
</ul>
</div>
</section>
<section id="step-1-initialize-the-package-metadata-and-try-a-local-install">
<h5>Step 1: Initialize the package metadata and try a local install<a class="headerlink" href="#step-1-initialize-the-package-metadata-and-try-a-local-install" title="Link to this heading"></a></h5>
<ol class="arabic">
<li><p>Our starting point is that we have a Python script called <code class="docutils literal notranslate"><span class="pre">countstars.py</span></code>
which we want to package.</p></li>
<li><p>Now we follow the <a class="reference external" href="https://flit.pypa.io/en/stable/#usage">flit quick-start usage</a> and add a docstring to the script and a <code class="docutils literal notranslate"><span class="pre">__version__</span></code>.</p></li>
<li><p>We then run <code class="docutils literal notranslate"><span class="pre">flit</span> <span class="pre">init</span></code> to create a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file and answer few questions. I obtained:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[build-system]</span>
<span class="n">requires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;flit_core &gt;=3.2,&lt;4&quot;</span><span class="p">]</span>
<span class="n">build-backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;flit_core.buildapi&quot;</span>

<span class="k">[project]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;countstars&quot;</span>
<span class="n">authors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[{</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;Radovan Bast&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;radovan.bast@uit.no&quot;</span><span class="p">}]</span>
<span class="n">license</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">file</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;LICENSE&quot;</span><span class="p">}</span>
<span class="n">classifiers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;License :: OSI Approved :: MIT License&quot;</span><span class="p">]</span>
<span class="n">dynamic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;description&quot;</span><span class="p">]</span>

<span class="k">[project.urls]</span>
<span class="n">Home</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://github.com/workshop-material/countstars&quot;</span>
</pre></div>
</div>
</li>
<li><p>We now add dependencies and also an entry point for the script:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[build-system]</span>
<span class="n">requires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;flit_core &gt;=3.2,&lt;4&quot;</span><span class="p">]</span>
<span class="n">build-backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;flit_core.buildapi&quot;</span>

<span class="k">[project]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;countstars&quot;</span>
<span class="n">authors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[{</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;Radovan Bast&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;radovan.bast@uit.no&quot;</span><span class="p">}]</span>
<span class="n">license</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">file</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;LICENSE&quot;</span><span class="p">}</span>
<span class="n">classifiers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;License :: OSI Approved :: MIT License&quot;</span><span class="p">]</span>
<span class="n">dynamic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;description&quot;</span><span class="p">]</span>
<span class="hll"><span class="n">dependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span class="hll"><span class="w">    </span><span class="s2">&quot;click&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">    </span><span class="s2">&quot;matplotlib&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">    </span><span class="s2">&quot;scikit-image&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="p">]</span>
</span>
<span class="k">[project.urls]</span>
<span class="n">Home</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://github.com/workshop-material/countstars&quot;</span>

<span class="hll"><span class="k">[project.scripts]</span>
</span><span class="hll"><span class="n">count-stars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;countstars:main&quot;</span>
</span></pre></div>
</div>
</li>
<li><p>Before moving on, try a local install:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>flit<span class="w"> </span>install<span class="w"> </span>--symlink
</pre></div>
</div>
</li>
</ol>
<div class="admonition-what-if-you-have-more-than-just-one-script discussion important admonition" id="discussion-0">
<p class="admonition-title">What if you have more than just one script?</p>
<ul class="simple">
<li><p>Create a directory with the name of the package.</p></li>
<li><p>Put the scripts in the directory.</p></li>
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file to the directory which contains the module
docstring and the version and re-exports the functions from the scripts.</p></li>
</ul>
</div>
</section>
<section id="step-2-testing-an-install-from-github">
<h5>Step 2: Testing an install from GitHub<a class="headerlink" href="#step-2-testing-an-install-from-github" title="Link to this heading"></a></h5>
<p>If a local install worked, push the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> to GitHub and try to install the package from GitHub.</p>
<p>In a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file, you can specify the GitHub repository and the branch:</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>git+https://github.com/workshop-material/countstars.git@main
</pre></div>
</div>
<p>A corresponding <code class="docutils literal notranslate"><span class="pre">envionment.yml</span></code> file for conda would look like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">countstars</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python=3.12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pip</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">git+https://github.com/workshop-material/countstars.git@main</span>
</pre></div>
</div>
<p>Does it install and run? If yes, move on to the next step (test-PyPI and later
PyPI).</p>
</section>
<section id="step-3-deploy-the-package-to-test-pypi-using-github-actions">
<h5>Step 3: Deploy the package to test-PyPI using GitHub Actions<a class="headerlink" href="#step-3-deploy-the-package-to-test-pypi-using-github-actions" title="Link to this heading"></a></h5>
<p>Our final step is to create a GitHub Actions workflow which will run when we
create a new release.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>I recommend to first practice this on the test-PyPI before deploying to the
real PyPI.</p>
</div>
<p>Here is the workflow (<code class="docutils literal notranslate"><span class="pre">.github/workflows/package.yml</span></code>):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Package</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">release</span><span class="p">:</span>
<span class="w">    </span><span class="nt">types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">created</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write-all</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch branch</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v5</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.12&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Flit</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">pip install flit</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Flit publish</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">flit publish</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">FLIT_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">__token__</span>
<span class="w">        </span><span class="nt">FLIT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.PYPI_TOKEN }}</span>
<span class="w">        </span><span class="c1"># uncomment the following line if you are using test.pypi.org:</span>
<span class="c1">#       FLIT_INDEX_URL: https://test.pypi.org/legacy/</span>
<span class="w">        </span><span class="c1"># this is how you can test the installation from test.pypi.org:</span>
<span class="c1">#       pip install --index-url https://test.pypi.org/simple/ package_name</span>
</pre></div>
</div>
<p>About the <code class="docutils literal notranslate"><span class="pre">FLIT_PASSWORD:</span> <span class="pre">${{</span> <span class="pre">secrets.PYPI_TOKEN</span> <span class="pre">}}</span></code>:</p>
<ul class="simple">
<li><p>You obtain the token from PyPI by going to your account settings and
creating a new token.</p></li>
<li><p>You add the token to your GitHub repository as a secret (here with the name
<code class="docutils literal notranslate"><span class="pre">PYPI_TOKEN</span></code>).</p></li>
</ul>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-credit"></span><section id="credit">
<h4>Credit<a class="headerlink" href="#credit" title="Link to this heading"></a></h4>
<p>The following material (all CC-BY) was reused to create this workshop material:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://coderefinery.github.io/research-software-engineering/">https://coderefinery.github.io/research-software-engineering/</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/mini-workshop/">https://coderefinery.github.io/mini-workshop/</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/git-collaborative/">https://coderefinery.github.io/git-collaborative/</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/git-intro/">https://coderefinery.github.io/git-intro/</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/documentation/">https://coderefinery.github.io/documentation/</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/reproducible-research/">https://coderefinery.github.io/reproducible-research/</a></p></li>
</ul>
<p>(I will also summarize what changes have been made to the original material)</p>
</section>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright CodeRefinery team (CC-BY license).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>